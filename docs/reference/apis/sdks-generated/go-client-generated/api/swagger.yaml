openapi: 3.0.3
info:
  title: TMI (Threat Modeling Improved) API
  description: |
    A RESTful API for collaborative threat modeling with full X6 graph library compatibility. This API provides schemas that align with AntV X6 cell object models for seamless integration with modern diagramming libraries. Supports OAuth 2.0 authentication with client callback integration for seamless single-page application authentication flows.

    ## API Design v1.0.0

    ### Authorization Model
    TMI uses hierarchical authorization: access control is defined at the ThreatModel level via the authorization field (readers, writers, owners). All child resources (Assets, Diagrams, Documents, Notes, Repositories, Threats) inherit permissions from their parent ThreatModel. This simplifies permission management and ensures consistent access control.

    ### Bulk Operations
    Notes and Diagrams do not support bulk operations due to their unique creation workflows and lack of valid bulk use cases. All other resources (Threats, Assets, Documents, Repositories) support full bulk operations: POST (create), PUT (upsert), PATCH (partial update), DELETE (batch delete).

    All resources support bulk metadata operations regardless of resource-level bulk support.

    ### List Response Strategy
    - ThreatModels return summary information (TMListItem) because they contain many child objects that can be large.
    - Diagrams return summary information (DiagramListItem) because diagram data (cells, images) can be large.
    - Notes return summary information (NoteListItem) because the content field can be large.
    - Threats, Assets, Documents, Repositories return full schemas as they are relatively small and static.

    ### PATCH Support
    All resources support PATCH for partial updates using JSON Patch (RFC 6902). This is particularly useful for:
    - Assets: Array field updates (affected_assets, trust_boundaries) ensuring no duplicates
    - Notes: Updating name/description without changing content field
    - All resources: Efficient updates without full object replacement
  version: 1.0.0
externalDocs:
  description: Find more information here
  url: https://github.com/ericfitz/tmi/wiki
servers:
- url: http://localhost:8080
  description: Local development server
paths:
  /:
    get:
      tags:
      - General
      summary: Get API information
      description: "Returns service, API, and operator information without authentication"
      operationId: getApiInfo
      responses:
        "200":
          description: Service and API information
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiInfo"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
  /.well-known/openid-configuration:
    get:
      tags:
      - OIDC Discovery
      summary: OpenID Connect Discovery Configuration
      description: Returns OpenID Connect provider configuration metadata as per RFC
        8414
      operationId: getOpenIDConfiguration
      responses:
        "200":
          description: OpenID Connect configuration metadata
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security: []
  /.well-known/oauth-authorization-server:
    get:
      tags:
      - OIDC Discovery
      summary: OAuth 2.0 Authorization Server Metadata
      description: Returns OAuth 2.0 authorization server metadata as per RFC 8414
      operationId: getOAuthAuthorizationServerMetadata
      responses:
        "200":
          description: OAuth 2.0 authorization server metadata
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_1"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security: []
  /.well-known/jwks.json:
    get:
      tags:
      - OIDC Discovery
      summary: JSON Web Key Set
      description: Returns the JSON Web Key Set (JWKS) for JWT signature verification
      operationId: getJWKS
      responses:
        "200":
          description: JSON Web Key Set
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_2"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security: []
  /.well-known/oauth-protected-resource:
    get:
      tags:
      - OAuth Discovery
      summary: OAuth 2.0 Protected Resource Metadata
      description: Returns OAuth 2.0 protected resource metadata as per RFC 9728
      operationId: getOAuthProtectedResourceMetadata
      responses:
        "200":
          description: OAuth 2.0 protected resource metadata
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OAuthProtectedResourceMetadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security: []
  /oauth2/introspect:
    post:
      tags:
      - Authentication
      summary: Token Introspection
      description: Introspects a JWT token to determine its validity and metadata
        as per RFC 7662
      operationId: introspectToken
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/oauth2_introspect_body"
        required: true
      responses:
        "200":
          description: Token introspection result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_3"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /oauth2/providers:
    get:
      tags:
      - Authentication
      summary: List available OAuth providers
      description: Returns a list of configured OAuth providers available for authentication
      operationId: getAuthProviders
      responses:
        "200":
          description: List of available OAuth providers
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_4"
              example:
                providers:
                - id: google
                  name: Google
                  icon: fa-brands fa-google
                  auth_url: http://localhost:8080/oauth2/authorize?idp=google
                  token_url: http://localhost:8080/oauth2/token?idp=google
                  redirect_uri: http://localhost:8080/oauth2/callback
                  client_id: 675196260523-e8ppeu62pv222jhnpebe929b2tgl2jm0.apps.googleusercontent.com
                - id: github
                  name: GitHub
                  icon: fa-brands fa-github
                  auth_url: http://localhost:8080/oauth2/authorize?idp=github
                  token_url: http://localhost:8080/oauth2/token?idp=github
                  redirect_uri: http://localhost:8080/oauth2/callback
                  client_id: your-github-client-id
                - id: microsoft
                  name: Microsoft
                  icon: fa-brands fa-microsoft
                  auth_url: http://localhost:8080/oauth2/authorize?idp=microsoft
                  token_url: http://localhost:8080/oauth2/token?idp=microsoft
                  redirect_uri: http://localhost:8080/oauth2/callback
                  client_id: your-microsoft-client-id
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
  /oauth2/providers/{idp}/groups:
    get:
      tags:
      - Authentication
      summary: Get groups for identity provider
      description: Returns groups available from a specific identity provider for
        autocomplete and discovery
      operationId: getProviderGroups
      parameters:
      - name: idp
        in: path
        description: "Identity provider ID (e.g., saml_okta, saml_azure)"
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: List of groups from the identity provider
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_5"
              example:
                idp: saml_okta
                groups:
                - name: security-team
                  display_name: Security Team
                  used_in_authorizations: true
                - name: developers
                  display_name: Development Team
                  used_in_authorizations: false
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /oauth2/authorize:
    get:
      tags:
      - Authentication
      summary: Initiate OAuth authorization flow
      description: Redirects user to OAuth provider's authorization page. Supports
        client callback URL for seamless client integration. Generates state parameter
        for CSRF protection.
      operationId: authorizeOAuthProvider
      parameters:
      - name: idp
        in: query
        description: OAuth provider identifier. Defaults to 'test' provider in non-production
          builds if not specified.
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: client_callback
        in: query
        description: "Client callback URL where TMI should redirect after successful\
          \ OAuth completion with tokens as query parameters. If not provided, tokens\
          \ are returned as JSON response."
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: uri
          example: http://localhost:4200/oauth2/callback
      - name: state
        in: query
        description: CSRF protection state parameter. Recommended for security. Will
          be included in the callback response.
        required: false
        style: form
        explode: true
        schema:
          type: string
          example: random_state_abc123
      - name: login_hint
        in: query
        description: "User identity hint for test OAuth provider. Allows specifying\
          \ a desired user identity for testing and automation. Only supported by\
          \ the test provider (ignored by production providers like Google, GitHub,\
          \ etc.). Must be 3-20 characters, alphanumeric and hyphens only."
        required: false
        style: form
        explode: true
        schema:
          pattern: "^[a-zA-Z0-9-]{3,20}$"
          type: string
          example: alice
      - name: scope
        in: query
        description: "OAuth 2.0 scope parameter. For OpenID Connect, must include\
          \ \"openid\". Supports \"profile\" and \"email\" scopes. Other scopes are\
          \ silently ignored. Space-separated values."
        required: true
        style: form
        explode: true
        schema:
          type: string
          example: openid profile email
      responses:
        "302":
          description: Redirect to OAuth provider authorization page
          headers:
            Location:
              description: "OAuth provider authorization URL with client_id, redirect_uri,\
                \ response_type, scope, and state parameters"
              style: simple
              explode: false
              schema:
                type: string
                format: uri
        "400":
          description: Invalid provider or provider not configured
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error generating authorization URL
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /oauth2/token:
    post:
      tags:
      - Authentication
      summary: Exchange OAuth authorization code for JWT tokens
      description: "Provider-neutral endpoint to exchange OAuth authorization codes\
        \ for TMI JWT tokens. Supports Google, GitHub, and Microsoft OAuth providers."
      operationId: exchangeOAuthCode
      parameters:
      - name: idp
        in: query
        description: OAuth provider identifier. Defaults to 'test' provider in non-production
          builds if not specified.
        required: false
        style: form
        explode: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/oauth2_token_body"
        required: true
      responses:
        "200":
          description: "OAuth exchange successful, TMI JWT tokens issued"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokenResponse"
              example:
                access_token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyQGV4YW1wbGUuY29tIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDI2MjJ9.example_jwt_signature
                refresh_token: 8xLOxBtZp8_example_refresh_token
                token_type: Bearer
                expires_in: 3600
        "400":
          description: "Bad request - invalid provider, missing parameters, or invalid\
            \ state"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                invalid_provider:
                  summary: Invalid provider
                  value:
                    error: "Invalid provider: invalid_provider"
                    error_description: Provider 'invalid_provider' is not configured
                      or supported
                missing_code:
                  summary: Missing authorization code
                  value:
                    error: "Invalid request: missing required fields"
                    error_description: The 'code' parameter is required
                invalid_state:
                  summary: Invalid state parameter
                  value:
                    error: Invalid state parameter
                    error_description: State parameter validation failed - possible
                      CSRF attack
        "500":
          description: Internal server error - OAuth provider communication failed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                provider_error:
                  summary: OAuth provider communication failed
                  value:
                    error: "Failed to exchange authorization code: oauth2: cannot\
                      \ fetch token: 400 Bad Request"
                    error_description: Unable to communicate with OAuth provider or
                      invalid authorization code
                user_info_error:
                  summary: Failed to get user information
                  value:
                    error: "Failed to get user info: 401 Unauthorized"
                    error_description: OAuth provider denied access to user information
  /oauth2/refresh:
    post:
      tags:
      - Authentication
      summary: Refresh JWT token
      description: Exchanges a refresh token for a new JWT access token
      operationId: refreshToken
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/oauth2_refresh_body"
      responses:
        "200":
          description: New JWT issued successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokenResponse"
              example:
                access_token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyQGV4YW1wbGUuY29tIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDI2MjJ9.new_jwt_signature
                refresh_token: 9yMPyCtZq9_new_refresh_token
                token_type: Bearer
                expires_in: 3600
        "400":
          description: Bad request - missing or invalid refresh token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                missing_token:
                  summary: Missing refresh token
                  value:
                    error: "Invalid request: missing required fields"
                    error_description: The 'refresh_token' parameter is required
                invalid_format:
                  summary: Invalid token format
                  value:
                    error: Invalid refresh token format
                    error_description: Refresh token must be a valid UUID string
        "401":
          description: Unauthorized - invalid or expired refresh token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                expired_token:
                  summary: Expired refresh token
                  value:
                    error: Invalid refresh token
                    error_description: The refresh token has expired or has been revoked
                invalid_token:
                  summary: Invalid refresh token
                  value:
                    error: Invalid refresh token
                    error_description: The provided refresh token is not valid
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /oauth2/userinfo:
    get:
      tags:
      - Authentication
      summary: Get current user information
      description: Returns information about the currently authenticated user
      operationId: getCurrentUser
      responses:
        "200":
          description: Current user information
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_6"
              example:
                sub: user@example.com
                id: 550e8400-e29b-41d4-a716-446655440000
                email: user@example.com
                name: John Doe
                idp: saml_okta
                groups:
                - security-team
                - developers
                providers:
                - provider: saml_okta
                  is_primary: true
                - provider: google
                  is_primary: false
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /oauth2/callback:
    get:
      tags:
      - Authentication
      summary: Handle OAuth callback
      description: "Exchanges OAuth authorization code for JWT tokens. If client_callback\
        \ was provided during authorization, redirects to client with tokens. Otherwise\
        \ returns tokens as JSON response."
      operationId: handleOAuthCallback
      parameters:
      - name: code
        in: query
        description: Authorization code from the OAuth provider
        required: true
        style: form
        explode: true
        schema:
          type: string
      - name: state
        in: query
        description: Optional state parameter for CSRF protection
        required: false
        style: form
        explode: true
        schema:
          type: string
      responses:
        "200":
          description: JWT tokens issued successfully (legacy mode when no client_callback
            provided)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokenResponse"
        "302":
          description: Redirect to client callback URL with tokens (when client_callback
            was provided)
          headers:
            Location:
              description: "Client callback URL with access_token, refresh_token,\
                \ expires_in, token_type, and state as query parameters"
              style: simple
              explode: false
              schema:
                type: string
                format: uri
                example: http://localhost:4200/oauth2/callback?access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&expires_in=3600&token_type=Bearer&state=random_state_abc123
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
  /oauth2/revoke:
    post:
      tags:
      - Authentication
      summary: Logout user
      description: "Invalidates the user's JWT token by adding it to a blacklist,\
        \ effectively ending the session. Once logged out, the token cannot be used\
        \ for further authenticated requests until it naturally expires. The token\
        \ blacklist is maintained in Redis with automatic cleanup based on token expiration\
        \ times."
      operationId: logoutUser
      requestBody:
        description: Empty request body - token is provided via Authorization header
        content:
          application/json:
            schema:
              type: object
              properties: {}
              example: {}
        required: false
      responses:
        "204":
          description: User logged out successfully. The JWT token has been invalidated
            and added to the blacklist.
          headers:
            X-Request-ID:
              description: Unique request identifier for tracking
              style: simple
              explode: false
              schema:
                type: string
                example: req_abc123def456
        "401":
          description: "Authentication failed - invalid, missing, or malformed token"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                missing_token:
                  summary: Missing Authorization header
                  value:
                    error: unauthorized
                    error_description: Missing Authorization header
                invalid_format:
                  summary: Invalid Authorization header format
                  value:
                    error: unauthorized
                    error_description: Invalid Authorization header format
                malformed_token:
                  summary: Malformed JWT token
                  value:
                    error: unauthorized
                    error_description: Invalid token format
                blacklisted_token:
                  summary: Token already blacklisted
                  value:
                    error: unauthorized
                    error_description: Token has been revoked
        "500":
          description: Internal server error - token blacklisting failed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
  /collaboration/sessions:
    get:
      tags:
      - Collaboration
      summary: List active collaboration sessions
      description: Returns all currently active collaboration sessions for diagrams.
        Clients can use this endpoint to discover existing sessions before connecting
        via WebSocket.
      operationId: getCollaborationSessions
      responses:
        "200":
          description: List of active collaboration sessions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CollaborationSession"
                x-content-type: application/json
              examples:
                active_sessions:
                  summary: Multiple active sessions
                  value:
                  - session_id: 550e8400-e29b-41d4-a716-446655440000
                    host: alice@example.com
                    presenter: alice@example.com
                    threat_model_id: 987f6543-e89b-12d3-a456-426614174000
                    threat_model_name: E-commerce Platform
                    diagram_id: 123e4567-e89b-12d3-a456-426614174000
                    diagram_name: Data Flow Diagram
                    participants:
                    - user:
                        user_id: oauth2|google|118354289635789012345
                        email: alice@example.com
                        name: Alice Smith
                      last_activity: 2024-01-20T14:30:00Z
                      permissions: writer
                    - user:
                        user_id: oauth2|github|67890
                        email: bob@example.com
                        name: Bob Johnson
                      last_activity: 2024-01-20T14:35:00Z
                      permissions: reader
                no_sessions:
                  summary: No active sessions
                  value: []
        "401":
          description: "Authentication failed - invalid, missing, or malformed token"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "500":
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
  /threat_models:
    get:
      tags:
      - Threat Models
      summary: List threat models
      description: Returns a list of threat models accessible to the authenticated
        user with enhanced metadata and entity counts
      operationId: listThreatModels
      parameters:
      - name: limit
        in: query
        description: Number of threat models to return
        required: false
        style: form
        explode: true
        schema:
          type: integer
          default: 20
      - name: offset
        in: query
        description: Pagination offset
        required: false
        style: form
        explode: true
        schema:
          type: integer
          default: 0
      - name: owner
        in: query
        description: Filter by owner name or email
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: name
        in: query
        description: Filter by threat model name (partial match)
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: description
        in: query
        description: Filter by threat model description (partial match)
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: issue_uri
        in: query
        description: Filter by issue URI (partial match)
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: created_after
        in: query
        description: Filter threat models created after this date (RFC3339 format)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: created_before
        in: query
        description: Filter threat models created before this date (RFC3339 format)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: modified_after
        in: query
        description: Filter threat models modified after this date (RFC3339 format)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: modified_before
        in: query
        description: Filter threat models modified before this date (RFC3339 format)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: status
        in: query
        description: "Filter by status value (exact match). To filter by multiple\
          \ statuses, use multiple status parameters or comma-separated values."
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: status_updated_after
        in: query
        description: Filter threat models where status was updated after this timestamp
          (RFC3339)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: status_updated_before
        in: query
        description: Filter threat models where status was updated before this timestamp
          (RFC3339)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      responses:
        "200":
          description: Paginated list of threat models with enhanced metadata and
            entity counts
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/TMListItem"
                x-content-type: application/json
              example:
                data:
                - id: 550e8400-e29b-41d4-a716-446655440000
                  name: System Threat Model
                  description: Comprehensive threat model for our web application
                    system
                  created_at: 2025-04-06T12:00:00Z
                  modified_at: 2025-04-06T14:30:00Z
                  owner: user@example.com
                  created_by: admin@example.com
                  threat_model_framework: STRIDE
                  document_count: 3
                  source_count: 2
                  diagram_count: 1
                  threat_count: 15
                  issue_uri: https://github.com/example/issues/123
                pagination:
                  total: 1
                  limit: 20
                  offset: 0
                  has_more: false
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Models
      summary: Create a threat model
      description: Creates a new threat model with the authenticated user as owner
      operationId: createThreatModel
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ThreatModelInput"
        required: true
      responses:
        "201":
          description: Threat model created successfully
          headers:
            Location:
              description: URL of the new threat model
              style: simple
              explode: false
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ThreatModel"
              example:
                id: 550e8400-e29b-41d4-a716-446655440000
                name: System Threat Model
                description: Threats for system X
                created_at: 2025-04-06T12:00:00Z
                modified_at: 2025-04-06T12:00:00Z
                owner: user@example.com
                created_by: user@example.com
                threat_model_framework: STRIDE
                authorization:
                - subject: user@example.com
                  subject_type: user
                  role: owner
                metadata: []
                documents: []
                repositories: []
                diagrams: []
                threats: []
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}:
    get:
      tags:
      - Threat Models
      summary: Retrieve a threat model
      description: Retrieves the full details of a specific threat model if the user
        has access
      operationId: getThreatModel
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model to retrieve (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Full threat model details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ThreatModel"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Models
      summary: Update a threat model
      description: Fully updates a threat model; restricted to writer/owner roles
      operationId: updateThreatModel
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model to update (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ThreatModelInput"
        required: true
      responses:
        "200":
          description: Threat model updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ThreatModel"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Models
      summary: Delete a threat model
      description: Deletes a threat model; restricted to owner role
      operationId: deleteThreatModel
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model to delete (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "204":
          description: Threat model deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    patch:
      tags:
      - Threat Models
      summary: Partially update a threat model
      description: Applies JSON Patch operations to a threat model; restricted to
        writer/owner roles
      operationId: patchThreatModel
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model to update (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/threat_models_threat_model_id_body"
      responses:
        "200":
          description: Threat model updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ThreatModel"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/threats:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List threats in a threat model
      description: Returns a paginated list of threats within the specified threat
        model
      operationId: getThreatModelThreats
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of threats to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of threats to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      - name: sort
        in: query
        description: "Sort order (e.g., created_at:desc, name:asc, severity:desc,\
          \ score:desc)"
        required: false
        style: form
        explode: true
        schema:
          type: string
          default: created_at:desc
      - name: name
        in: query
        description: Filter by threat name (partial match)
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: description
        in: query
        description: Filter by threat description (partial match)
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: threat_type
        in: query
        description: Filter by threat type (exact match)
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: severity
        in: query
        description: Filter by severity level (exact match)
        required: false
        style: form
        explode: true
        schema:
          type: string
          enum:
          - Unknown
          - None
          - Low
          - Medium
          - High
          - Critical
      - name: priority
        in: query
        description: Filter by priority (exact match)
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: status
        in: query
        description: Filter by status (exact match)
        required: false
        style: form
        explode: true
        schema:
          type: string
      - name: diagram_id
        in: query
        description: Filter by diagram ID (exact match)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: uuid
      - name: cell_id
        in: query
        description: Filter by cell ID (exact match)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: uuid
      - name: score_gt
        in: query
        description: Filter threats with score greater than this value
        required: false
        style: form
        explode: true
        schema:
          maximum: 10
          minimum: 0
          type: number
      - name: score_lt
        in: query
        description: Filter threats with score less than this value
        required: false
        style: form
        explode: true
        schema:
          maximum: 10
          minimum: 0
          type: number
      - name: score_eq
        in: query
        description: Filter threats with score equal to this value
        required: false
        style: form
        explode: true
        schema:
          maximum: 10
          minimum: 0
          type: number
      - name: score_ge
        in: query
        description: Filter threats with score greater than or equal to this value
        required: false
        style: form
        explode: true
        schema:
          maximum: 10
          minimum: 0
          type: number
      - name: score_le
        in: query
        description: Filter threats with score less than or equal to this value
        required: false
        style: form
        explode: true
        schema:
          maximum: 10
          minimum: 0
          type: number
      - name: created_after
        in: query
        description: Filter threats created after this date (RFC3339 format)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: created_before
        in: query
        description: Filter threats created before this date (RFC3339 format)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: modified_after
        in: query
        description: Filter threats modified after this date (RFC3339 format)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      - name: modified_before
        in: query
        description: Filter threats modified before this date (RFC3339 format)
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: date-time
      responses:
        "200":
          description: List of threats
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Threat"
                x-content-type: application/json
              examples:
                threatList:
                  summary: List of threats with metadata
                  value:
                    threats:
                    - id: 550e8400-e29b-41d4-a716-446655440003
                      name: SQL Injection Vulnerability
                      description: Database injection through malicious SQL queries
                      severity: High
                      priority: urgent
                      status: active
                      mitigated: false
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      created_at: 2025-01-15T10:30:00Z
                      modified_at: 2025-01-15T14:45:00Z
                      metadata:
                      - key: category
                        value: data_validation
                      - key: owasp_top_10
                        value: A03
                      - key: assigned_to
                        value: security-team
                    - id: 550e8400-e29b-41d4-a716-446655440004
                      name: Cross-Site Scripting (XSS)
                      description: Client-side script injection vulnerability
                      severity: Medium
                      priority: medium
                      status: identified
                      mitigated: false
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      created_at: 2025-01-15T11:00:00Z
                      modified_at: 2025-01-15T11:00:00Z
                      metadata:
                      - key: category
                        value: input_validation
                      - key: owasp_top_10
                        value: A07
                    total_count: 12
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new threat
      description: Creates a new threat within the specified threat model
      operationId: createThreatModelThreat
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ThreatInput"
        required: true
      responses:
        "201":
          description: Threat created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Threat"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/threats/{threat_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific threat
      description: Returns details of a specific threat within the threat model
      operationId: getThreatModelThreat
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Threat details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Threat"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update a threat
      description: Updates a specific threat within the threat model
      operationId: updateThreatModelThreat
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ThreatInput"
        required: true
      responses:
        "200":
          description: Threat updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Threat"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete a threat
      description: Deletes a specific threat from the threat model
      operationId: deleteThreatModelThreat
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "204":
          description: Threat deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    patch:
      tags:
      - Threat Model Sub-Resources
      summary: Partially update a threat
      description: Applies JSON patch operations to a specific threat within the threat
        model
      operationId: patchThreatModelThreat
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/threats_threat_id_body"
            examples:
              updateThreatDetails:
                summary: Update threat name and severity
                value:
                - op: replace
                  path: /name
                  value: Updated SQL Injection Threat
                - op: replace
                  path: /severity
                  value: Critical
                - op: replace
                  path: /description
                  value: Updated description with more details
              addMetadata:
                summary: Add metadata to a threat
                value:
                - op: add
                  path: /metadata/-
                  value:
                    key: priority
                    value: urgent
                - op: add
                  path: /metadata/-
                  value:
                    key: assigned_to
                    value: security-team
              updateStatus:
                summary: Update threat status and mitigation
                value:
                - op: replace
                  path: /status
                  value: mitigated
                - op: replace
                  path: /mitigated
                  value: true
                - op: replace
                  path: /mitigation
                  value: Implemented input validation and parameterized queries
        required: true
      responses:
        "200":
          description: Threat patched successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Threat"
              examples:
                patchedThreat:
                  summary: Successfully patched threat with updated fields
                  value:
                    id: 550e8400-e29b-41d4-a716-446655440003
                    name: Updated SQL Injection Threat
                    description: Updated description with more details
                    severity: Critical
                    priority: urgent
                    status: active
                    mitigated: false
                    threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                    created_at: 2025-01-15T10:30:00Z
                    modified_at: 2025-01-15T14:45:00Z
                    metadata:
                    - key: priority
                      value: urgent
                    - key: assigned_to
                      value: security-team
                    - key: cve_reference
                      value: CVE-2024-1234
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/threats/{threat_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get threat metadata
      description: Returns all metadata key-value pairs for the specified threat
      operationId: getThreatMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Threat metadata list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create threat metadata
      description: Creates new metadata entry for the specified threat
      operationId: createThreatMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/threats/{threat_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get threat metadata by key
      description: Returns a specific metadata entry by key for the specified threat
      operationId: getThreatMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to retrieve
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update threat metadata by key
      description: Updates a specific metadata entry by key for the specified threat
      operationId: updateThreatMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to update
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete threat metadata by key
      description: Deletes a specific metadata entry by key for the specified threat
      operationId: deleteThreatMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to delete
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/threats/{threat_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert threat metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        threat
      operationId: bulkUpsertThreatMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create threat metadata
      description: Creates multiple metadata entries in a single operation for the
        specified threat
      operationId: bulkCreateThreatMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_id
        in: path
        description: Unique identifier of the threat (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entries created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/threats/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk update threats
      description: Updates multiple threats in a single operation for the specified
        threat model
      operationId: bulkUpdateThreatModelThreats
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of threats to update (must include id field)
              items:
                $ref: "#/components/schemas/Threat"
            examples:
              bulkUpdateThreats:
                summary: Update multiple threats at once
                value:
                - id: 750e8400-e29b-41d4-a716-446655440001
                  name: Updated SQL Injection Attack
                  description: Updated description for SQL injection vulnerability
                  impact: High
                  likelihood: Low
                  risk_rating: Medium
                  metadata:
                  - key: category
                    value: injection
                  - key: mitigation
                    value: parameterized-queries
        required: true
      responses:
        "200":
          description: Threats updated successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Threat"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create threats
      description: Creates multiple threats in a single operation for the specified
        threat model
      operationId: bulkCreateThreatModelThreats
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of threats to create
              items:
                $ref: "#/components/schemas/Threat"
            examples:
              bulkCreateThreats:
                summary: Create multiple threats at once
                value:
                - name: SQL Injection Attack
                  description: Attacker injects malicious SQL code through user input
                  impact: High
                  likelihood: Medium
                  risk_rating: High
                  metadata:
                  - key: category
                    value: injection
                  - key: stride
                    value: tampering
                - name: Cross-Site Scripting (XSS)
                  description: Malicious scripts executed in user's browser
                  impact: Medium
                  likelihood: High
                  risk_rating: High
                  metadata:
                  - key: category
                    value: xss
                  - key: stride
                    value: tampering
        required: true
      responses:
        "201":
          description: Threats created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Threat"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threats
      summary: Bulk DELETE threats
      description: Delete multiple threats in a single request
      operationId: bulkDeleteThreatModelThreats
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: threat_ids
        in: query
        description: Comma-separated list of threat IDs to delete (UUID format)
        required: true
        style: form
        explode: false
        schema:
          maxItems: 20
          minItems: 1
          type: array
          items:
            type: string
            format: uuid
      responses:
        "200":
          description: Successfully deleted threats
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_7"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    patch:
      tags:
      - Threats
      summary: Bulk PATCH threats
      description: Apply JSON Patch operations to multiple threats in a single request
      operationId: bulkPatchThreatModelThreats
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              $ref: "#/components/schemas/threats_bulk_body"
        required: true
      responses:
        "200":
          description: Successfully patched threats
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Threat"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/documents:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List documents in a threat model
      description: Returns a paginated list of documents within the specified threat
        model
      operationId: getThreatModelDocuments
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of documents to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of documents to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of documents
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Document"
                x-content-type: application/json
              examples:
                documentList:
                  summary: List of documents with pagination
                  value:
                    documents:
                    - id: 550e8400-e29b-41d4-a716-446655440001
                      name: Security Requirements Document
                      description: Detailed security requirements and compliance standards
                      metadata:
                      - key: classification
                        value: internal
                      - key: version
                        value: "1.2"
                      uri: https://docs.company.com/security-requirements.pdf
                    - id: 550e8400-e29b-41d4-a716-446655440002
                      name: Architecture Design Document
                      description: System architecture and design specifications
                      metadata:
                      - key: classification
                        value: internal
                      - key: version
                        value: "2.0"
                      uri: https://docs.company.com/architecture-design.pdf
                    total_count: 5
                emptyList:
                  summary: Empty document list
                  value:
                    documents: []
                    total_count: 0
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new document
      description: Creates a new document within the specified threat model
      operationId: createThreatModelDocument
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DocumentInput"
            examples:
              createDocument:
                summary: Create a new security document
                value:
                  name: Security Requirements Document
                  description: Detailed security requirements and compliance standards
                  metadata:
                  - key: classification
                    value: internal
                  - key: version
                    value: "1.0"
                  - key: owner
                    value: security-team
                  uri: https://docs.company.com/security-requirements.pdf
        required: true
      responses:
        "201":
          description: Document created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Document"
              examples:
                createdDocument:
                  summary: Successfully created document with generated ID
                  value:
                    id: 550e8400-e29b-41d4-a716-446655440001
                    name: Security Requirements Document
                    description: Detailed security requirements and compliance standards
                    metadata:
                    - key: classification
                      value: internal
                    - key: version
                      value: "1.0"
                    - key: owner
                      value: security-team
                    uri: https://docs.company.com/security-requirements.pdf
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/documents/{document_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific document
      description: Returns details of a specific document within the threat model
      operationId: getThreatModelDocument
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Unique identifier of the document (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Document details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Document"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update a document
      description: Updates a specific document within the threat model
      operationId: updateThreatModelDocument
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Unique identifier of the document (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DocumentInput"
        required: true
      responses:
        "200":
          description: Document updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Document"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete a document
      description: Deletes a specific document from the threat model
      operationId: deleteThreatModelDocument
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Unique identifier of the document (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "204":
          description: Document deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    patch:
      tags:
      - Documents
      summary: Partially update document
      description: Apply JSON Patch operations to partially update a document
      operationId: patchThreatModelDocument
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Document ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/threats_threat_id_body"
        required: true
      responses:
        "200":
          description: Successfully patched document
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Document"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/documents/{document_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get document metadata
      description: Returns all metadata key-value pairs for the specified document
      operationId: getDocumentMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Unique identifier of the document (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Document metadata list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create document metadata
      description: Creates new metadata entry for the specified document
      operationId: createDocumentMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Unique identifier of the document (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/documents/{document_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get document metadata by key
      description: Returns a specific metadata entry by key for the specified document
      operationId: getDocumentMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Unique identifier of the document (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to retrieve
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update document metadata by key
      description: Updates a specific metadata entry by key for the specified document
      operationId: updateDocumentMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Unique identifier of the document (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to update
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body_1"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete document metadata by key
      description: Deletes a specific metadata entry by key for the specified document
      operationId: deleteDocumentMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Unique identifier of the document (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to delete
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/documents/{document_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert document metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        document
      operationId: bulkUpsertDocumentMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Unique identifier of the document (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create document metadata
      description: Creates multiple metadata entries in a single operation for the
        specified document
      operationId: bulkCreateDocumentMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: document_id
        in: path
        description: Unique identifier of the document (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entries created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/documents/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert documents
      description: Create or update multiple documents in a single request
      operationId: bulkUpsertThreatModelDocuments
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of documents to create
              items:
                $ref: "#/components/schemas/Document"
            examples:
              bulkCreateDocuments:
                summary: Create multiple documents at once
                value:
                - name: Architecture Document
                  description: System architecture documentation
                  metadata:
                  - key: type
                    value: architecture
                  - key: version
                    value: "2.1"
                  uri: https://docs.company.com/architecture.pdf
                - name: Security Requirements
                  description: Security requirements and compliance standards
                  metadata:
                  - key: classification
                    value: internal
                  - key: department
                    value: security
                  uri: https://docs.company.com/security.pdf
        required: true
      responses:
        "201":
          description: Documents created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Document"
                x-content-type: application/json
              examples:
                bulkCreatedDocuments:
                  summary: Successfully created documents with generated IDs
                  value:
                  - id: 550e8400-e29b-41d4-a716-446655440001
                    name: Architecture Document
                    description: System architecture documentation
                    metadata:
                    - key: type
                      value: architecture
                    - key: version
                      value: "2.1"
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://docs.company.com/architecture.pdf
                  - id: 550e8400-e29b-41d4-a716-446655440002
                    name: Security Requirements
                    description: Security requirements and compliance standards
                    metadata:
                    - key: classification
                      value: internal
                    - key: department
                      value: security
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://docs.company.com/security.pdf
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create documents
      description: Creates multiple documents in a single operation for the specified
        threat model
      operationId: bulkCreateThreatModelDocuments
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of documents to create
              items:
                $ref: "#/components/schemas/Document"
            examples:
              bulkCreateDocuments:
                summary: Create multiple documents at once
                value:
                - name: Architecture Document
                  description: System architecture documentation
                  metadata:
                  - key: type
                    value: architecture
                  - key: version
                    value: "2.1"
                  uri: https://docs.company.com/architecture.pdf
                - name: Security Requirements
                  description: Security requirements and compliance standards
                  metadata:
                  - key: classification
                    value: internal
                  - key: department
                    value: security
                  uri: https://docs.company.com/security.pdf
        required: true
      responses:
        "201":
          description: Documents created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Document"
                x-content-type: application/json
              examples:
                bulkCreatedDocuments:
                  summary: Successfully created documents with generated IDs
                  value:
                  - id: 550e8400-e29b-41d4-a716-446655440001
                    name: Architecture Document
                    description: System architecture documentation
                    metadata:
                    - key: type
                      value: architecture
                    - key: version
                      value: "2.1"
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://docs.company.com/architecture.pdf
                  - id: 550e8400-e29b-41d4-a716-446655440002
                    name: Security Requirements
                    description: Security requirements and compliance standards
                    metadata:
                    - key: classification
                      value: internal
                    - key: department
                      value: security
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://docs.company.com/security.pdf
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/repositories:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List sources in a threat model
      description: Returns a paginated list of source code references within the specified
        threat model
      operationId: getThreatModelRepositories
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of sources to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of sources to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of source code references
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Repository"
                x-content-type: application/json
              examples:
                sourceList:
                  summary: List of source code references
                  value:
                    sources:
                    - id: 550e8400-e29b-41d4-a716-446655440010
                      name: Authentication Service
                      type: git
                      description: Core authentication and authorization service
                      parameters:
                        refType: branch
                        refValue: main
                      metadata:
                      - key: language
                        value: go
                      - key: coverage
                        value: 85%
                      - key: security_scan
                        value: passed
                      uri: https://github.com/company/auth-service
                    - id: 550e8400-e29b-41d4-a716-446655440011
                      name: Database Layer
                      type: git
                      description: Database access layer and ORM implementation
                      parameters:
                        refType: tag
                        refValue: v1.2.3
                      metadata:
                      - key: language
                        value: go
                      - key: database
                        value: postgresql
                      uri: https://github.com/company/db-layer
                    total_count: 3
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new source reference
      description: Creates a new source code reference within the specified threat
        model
      operationId: createThreatModelRepository
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RepositoryInput"
        required: true
      responses:
        "201":
          description: Source reference created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Repository"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/repositories/{repository_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific source reference
      description: Returns details of a specific source code reference within the
        threat model
      operationId: getThreatModelRepository
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Unique identifier of the source reference (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Source reference details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Repository"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update a source reference
      description: Updates a specific source code reference within the threat model
      operationId: updateThreatModelRepository
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Unique identifier of the source reference (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RepositoryInput"
        required: true
      responses:
        "200":
          description: Source reference updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Repository"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete a source reference
      description: Deletes a specific source code reference from the threat model
      operationId: deleteThreatModelRepository
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Unique identifier of the source reference (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "204":
          description: Source reference deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    patch:
      tags:
      - Repositories
      summary: Partially update repository
      description: Apply JSON Patch operations to partially update a repository
      operationId: patchThreatModelRepository
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Repository ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/threats_threat_id_body"
        required: true
      responses:
        "200":
          description: Successfully patched repository
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Repository"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/repositories/{repository_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get source metadata
      description: Returns all metadata key-value pairs for the specified source reference
      operationId: getRepositoryMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Unique identifier of the source reference (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Source metadata list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create source metadata
      description: Creates new metadata entry for the specified source reference
      operationId: createRepositoryMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Unique identifier of the source reference (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/repositories/{repository_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get source metadata by key
      description: Returns a specific metadata entry by key for the specified source
        reference
      operationId: getRepositoryMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Unique identifier of the source reference (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to retrieve
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update source metadata by key
      description: Updates a specific metadata entry by key for the specified source
        reference
      operationId: updateRepositoryMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Unique identifier of the source reference (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to update
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body_2"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete source metadata by key
      description: Deletes a specific metadata entry by key for the specified source
        reference
      operationId: deleteRepositoryMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Unique identifier of the source reference (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to delete
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/repositories/{repository_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert repository metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        repository
      operationId: bulkUpsertRepositoryMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Unique identifier of the source reference (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create source metadata
      description: Creates multiple metadata entries in a single operation for the
        specified source reference
      operationId: bulkCreateRepositoryMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: repository_id
        in: path
        description: Unique identifier of the source reference (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entries created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/repositories/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert repositories
      description: Create or update multiple repositories in a single request
      operationId: bulkUpsertThreatModelRepositories
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of source references to create
              items:
                $ref: "#/components/schemas/Repository"
            examples:
              bulkCreateSources:
                summary: Create multiple source references at once
                value:
                - name: User Authentication Module
                  description: Core user authentication logic
                  metadata:
                  - key: language
                    value: go
                  - key: maintainer
                    value: security-team
                  uri: https://github.com/company/repo/blob/main/oauth2/user.go
                - name: Database Connection Pool
                  description: Database connection management
                  metadata:
                  - key: type
                    value: infrastructure
                  - key: criticality
                    value: high
                  uri: https://github.com/company/repo/blob/main/db/pool.go
        required: true
      responses:
        "201":
          description: Sources created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Repository"
                x-content-type: application/json
              examples:
                bulkCreatedSources:
                  summary: Successfully created sources with generated IDs
                  value:
                  - id: 650e8400-e29b-41d4-a716-446655440001
                    name: User Authentication Module
                    description: Core user authentication logic
                    metadata:
                    - key: language
                      value: go
                    - key: maintainer
                      value: security-team
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://github.com/company/repo/blob/main/oauth2/user.go
                  - id: 650e8400-e29b-41d4-a716-446655440002
                    name: Database Connection Pool
                    description: Database connection management
                    metadata:
                    - key: type
                      value: infrastructure
                    - key: criticality
                      value: high
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://github.com/company/repo/blob/main/db/pool.go
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create sources
      description: Creates multiple source references in a single operation for the
        specified threat model
      operationId: bulkCreateThreatModelRepositories
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              description: Array of source references to create
              items:
                $ref: "#/components/schemas/Repository"
            examples:
              bulkCreateSources:
                summary: Create multiple source references at once
                value:
                - name: User Authentication Module
                  description: Core user authentication logic
                  metadata:
                  - key: language
                    value: go
                  - key: maintainer
                    value: security-team
                  uri: https://github.com/company/repo/blob/main/oauth2/user.go
                - name: Database Connection Pool
                  description: Database connection management
                  metadata:
                  - key: type
                    value: infrastructure
                  - key: criticality
                    value: high
                  uri: https://github.com/company/repo/blob/main/db/pool.go
        required: true
      responses:
        "201":
          description: Sources created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Repository"
                x-content-type: application/json
              examples:
                bulkCreatedSources:
                  summary: Successfully created sources with generated IDs
                  value:
                  - id: 650e8400-e29b-41d4-a716-446655440001
                    name: User Authentication Module
                    description: Core user authentication logic
                    metadata:
                    - key: language
                      value: go
                    - key: maintainer
                      value: security-team
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://github.com/company/repo/blob/main/oauth2/user.go
                  - id: 650e8400-e29b-41d4-a716-446655440002
                    name: Database Connection Pool
                    description: Database connection management
                    metadata:
                    - key: type
                      value: infrastructure
                    - key: criticality
                      value: high
                    created_at: 2025-04-06T12:00:00Z
                    modified_at: 2025-04-06T12:00:00Z
                    uri: https://github.com/company/repo/blob/main/db/pool.go
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get threat model metadata
      description: Returns all metadata key-value pairs for the specified threat model
      operationId: getThreatModelMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Threat model metadata list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create threat model metadata
      description: Creates new metadata entry for the specified threat model
      operationId: createThreatModelMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get threat model metadata by key
      description: Returns a specific metadata entry by key for the specified threat
        model
      operationId: getThreatModelMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to retrieve
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update threat model metadata by key
      description: Updates a specific metadata entry by key for the specified threat
        model
      operationId: updateThreatModelMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to update
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body_3"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete threat model metadata by key
      description: Deletes a specific metadata entry by key for the specified threat
        model
      operationId: deleteThreatModelMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to delete
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert threat model metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        threat model
      operationId: bulkUpsertThreatModelMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create threat model metadata
      description: Creates multiple metadata entries in a single operation for the
        specified threat model
      operationId: bulkCreateThreatModelMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entries created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/diagrams:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List threat model diagrams
      description: Returns all diagrams associated with a specific threat model
      operationId: getThreatModelDiagrams
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of items to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of items to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of diagrams
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/DiagramListItem"
                x-content-type: application/json
              example:
              - id: 123e4567-e89b-12d3-a456-426614174000
                name: System Architecture Diagram
                type: DFD-1.0.0
              - id: 456e7890-e89b-12d3-a456-426614174001
                name: Data Flow Diagram
                type: DFD-1.0.0
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new diagram
      description: Creates a new diagram within the specified threat model
      operationId: createThreatModelDiagram
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateDiagramRequest"
        required: true
      responses:
        "201":
          description: Diagram created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Diagram"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/diagrams/{diagram_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific diagram
      description: Retrieves a specific diagram from the threat model
      operationId: getThreatModelDiagram
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Diagram details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Diagram"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update a diagram
      description: Completely replaces a diagram with new data
      operationId: updateThreatModelDiagram
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Diagram"
        required: true
      responses:
        "200":
          description: Diagram updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Diagram"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete a diagram
      description: Permanently removes a diagram from the threat model
      operationId: deleteThreatModelDiagram
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "204":
          description: Diagram deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    patch:
      tags:
      - Threat Model Sub-Resources
      summary: Partially update a diagram
      description: Apply JSON Patch operations to update specific parts of a diagram
      operationId: patchThreatModelDiagram
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/threats_threat_id_body"
            examples:
              updateName:
                summary: Update diagram name
                value:
                - op: replace
                  path: /name
                  value: Updated Diagram Name
              addCell:
                summary: Add a new cell to the diagram
                value:
                - op: add
                  path: /cells/-
                  value:
                    id: new-cell-id
                    shape: process
                    x: 100
                    "y": 100
                    width: 120
                    height: 60
                    label: New Process
              addMetadata:
                summary: Add metadata to diagram
                value:
                - op: add
                  path: /metadata/-
                  value:
                    key: version
                    value: "2.0"
        required: true
      responses:
        "200":
          description: Diagram updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Diagram"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "422":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/diagrams/{diagram_id}/collaborate:
    get:
      tags:
      - Collaboration
      summary: Get diagram collaboration session
      description: "Retrieves the current collaboration session details for a diagram.\
        \ The session payload indicates who has been authorized to the session, not\
        \ who is currently active in the WebSocket session. The 200 status indicates\
        \ successful retrieval - clients must NOT evaluate the payload to determine\
        \ session status."
      operationId: getDiagramCollaborationSession
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Collaboration session details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CollaborationSession"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Collaboration
      summary: Create diagram collaboration session
      description: "Creates a new collaboration session for real-time diagram editing.\
        \ Only one collaboration session can exist per diagram at a time. If a session\
        \ already exists, returns 409 with a link to join the existing session."
      operationId: createDiagramCollaborationSession
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "201":
          description: Collaboration session created successfully. The 201 status
            indicates successful creation - clients must NOT evaluate the payload
            to determine success.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CollaborationSession"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "409":
          description: Collaboration session already exists for this diagram
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_409"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Collaboration
      summary: End diagram collaboration session
      description: Terminates the active collaboration session for a diagram
      operationId: endDiagramCollaborationSession
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "204":
          description: Collaboration session ended successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get diagram metadata
      description: Retrieves all metadata entries for the specified diagram
      operationId: getDiagramMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: List of metadata entries
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create diagram metadata
      description: Creates a new metadata entry for the specified diagram
      operationId: createDiagramMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get diagram metadata by key
      description: Retrieves a specific metadata entry for the diagram by key
      operationId: getDiagramMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to retrieve
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 256
          type: string
      responses:
        "200":
          description: Metadata entry
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update diagram metadata by key
      description: Updates or creates a metadata entry for the diagram with the specified
        key
      operationId: updateDiagramMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to update
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 256
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body_4"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete diagram metadata by key
      description: Removes a specific metadata entry for the diagram by key
      operationId: deleteDiagramMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to delete
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 256
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert diagram metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        diagram
      operationId: bulkUpsertDiagramMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create diagram metadata
      description: Creates multiple metadata entries in a single operation for the
        specified diagram
      operationId: bulkCreateDiagramMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: diagram_id
        in: path
        description: Unique identifier of the diagram (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 20
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entries created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /users/me:
    get:
      tags:
      - Authentication
      summary: Get current user profile
      description: Returns detailed information about the currently authenticated
        user including groups and identity provider
      operationId: getCurrentUserProfile
      responses:
        "200":
          description: Current user profile
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
              example:
                user_id: provider-user-123
                email: alice@example.com
                name: Alice Smith
                picture: https://example.com/avatar.jpg
                idp: saml_okta
                groups:
                - security-team
                - developers
                last_login: 2024-01-15T10:30:00Z
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Users
      summary: Delete authenticated user account and all data
      description: |-
        Two-step deletion process:
        1. First call (no challenge parameter) - Returns challenge string
        2. Second call (with challenge parameter) - Confirms deletion

        Ownership behavior:
        - Shared threat models: Transfers ownership to another owner from authorization list
        - Unshared threat models: Deletes completely along with all child resources
      operationId: deleteUserAccount
      parameters:
      - name: challenge
        in: query
        description: Challenge string from first request (step 2 only). Must match
          exactly.
        required: false
        style: form
        explode: true
        schema:
          type: string
      responses:
        "200":
          description: Challenge issued (step 1)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeletionChallenge"
        "204":
          description: User deleted successfully (step 2)
        "400":
          description: "Invalid or expired challenge, or challenge provided on first\
            \ request"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized - valid JWT token required
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/notes:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List notes in a threat model
      description: Returns a paginated list of notes within the specified threat model
      operationId: getThreatModelNotes
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of notes to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of notes to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of notes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/NoteListItem"
                x-content-type: application/json
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new note
      description: Creates a new note within the specified threat model
      operationId: createThreatModelNote
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NoteInput"
        required: true
      responses:
        "201":
          description: Note created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Note"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/notes/{note_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific note
      description: Returns details of a specific note within the threat model
      operationId: getThreatModelNote
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Unique identifier of the note (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Note details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Note"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update a note
      description: Updates a specific note within the threat model
      operationId: updateThreatModelNote
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Unique identifier of the note (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NoteInput"
        required: true
      responses:
        "200":
          description: Note updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Note"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete a note
      description: Deletes a specific note from the threat model
      operationId: deleteThreatModelNote
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Unique identifier of the note (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "204":
          description: Note deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    patch:
      tags:
      - Notes
      summary: Partially update note
      description: Apply JSON Patch operations to partially update a note
      operationId: patchThreatModelNote
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Note ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/threats_threat_id_body"
        required: true
      responses:
        "200":
          description: Successfully patched note
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Note"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/notes/{note_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get note metadata
      description: Returns all metadata key-value pairs for the specified note
      operationId: getNoteMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Unique identifier of the note (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Note metadata list
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create note metadata
      description: Creates new metadata entry for the specified note
      operationId: createNoteMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Unique identifier of the note (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata entry created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/notes/{note_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get note metadata by key
      description: Returns a specific metadata entry by key for the specified note
      operationId: getNoteMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Unique identifier of the note (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to retrieve
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "200":
          description: Metadata entry
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update note metadata by key
      description: Updates a specific metadata entry by key for the specified note
      operationId: updateNoteMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Unique identifier of the note (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to update
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/metadata_key_body_5"
        required: true
      responses:
        "200":
          description: Metadata entry updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete note metadata by key
      description: Deletes a specific metadata entry by key for the specified note
      operationId: deleteNoteMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Unique identifier of the note (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key to delete
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 255
          type: string
      responses:
        "204":
          description: Metadata entry deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/notes/{note_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk update note metadata
      description: Updates multiple metadata entries for the specified note in a single
        operation
      operationId: bulkUpdateNoteMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Unique identifier of the note (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata entries updated successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create note metadata
      description: Creates multiple metadata key-value pairs for the specified note
      operationId: bulkCreateNoteMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: note_id
        in: path
        description: Unique identifier of the note (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/assets:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: List assets in a threat model
      description: Returns a paginated list of assets within the specified threat
        model
      operationId: getThreatModelAssets
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: limit
        in: query
        description: Maximum number of assets to return
        required: false
        style: form
        explode: true
        schema:
          maximum: 100
          minimum: 1
          type: integer
          default: 20
      - name: offset
        in: query
        description: Number of assets to skip
        required: false
        style: form
        explode: true
        schema:
          minimum: 0
          type: integer
          default: 0
      responses:
        "200":
          description: List of assets
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Asset"
                x-content-type: application/json
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Create a new asset
      description: Creates a new asset within the specified threat model
      operationId: createThreatModelAsset
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AssetInput"
        required: true
      responses:
        "201":
          description: Asset created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Asset"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/assets/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert assets
      description: Create or update multiple assets in a single request
      operationId: bulkUpsertThreatModelAssets
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 50
              type: array
              items:
                $ref: "#/components/schemas/Asset"
        required: true
      responses:
        "201":
          description: Assets created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Asset"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create assets
      description: Creates multiple assets within the specified threat model (maximum
        50 per request)
      operationId: bulkCreateThreatModelAssets
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              maxItems: 50
              type: array
              items:
                $ref: "#/components/schemas/Asset"
        required: true
      responses:
        "201":
          description: Assets created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Asset"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/assets/{asset_id}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get a specific asset
      description: Returns a single asset by its ID
      operationId: getThreatModelAsset
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Unique identifier of the asset (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Asset details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Asset"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update an asset
      description: Updates an existing asset within the specified threat model
      operationId: updateThreatModelAsset
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Unique identifier of the asset (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AssetInput"
        required: true
      responses:
        "200":
          description: Asset updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Asset"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete an asset
      description: Deletes an asset from the specified threat model
      operationId: deleteThreatModelAsset
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Unique identifier of the asset (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "204":
          description: Asset deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    patch:
      tags:
      - Assets
      summary: Partially update asset
      description: Apply JSON Patch operations to partially update a asset
      operationId: patchThreatModelAsset
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Asset ID
        required: true
        style: simple
        explode: false
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json-patch+json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/threats_threat_id_body"
        required: true
      responses:
        "200":
          description: Successfully patched asset
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Asset"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/assets/{asset_id}/metadata:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get all metadata for an asset
      description: Returns all metadata key-value pairs for the specified asset
      operationId: getThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Unique identifier of the asset (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      responses:
        "200":
          description: Asset metadata
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Add metadata to an asset
      description: Adds a new metadata key-value pair to the specified asset
      operationId: createThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Unique identifier of the asset (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/assets/{asset_id}/metadata/{key}:
    get:
      tags:
      - Threat Model Sub-Resources
      summary: Get specific metadata for an asset
      description: Returns a single metadata value by its key
      operationId: getThreatModelAssetMetadataByKey
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Unique identifier of the asset (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 128
          type: string
      responses:
        "200":
          description: Metadata value
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Update asset metadata
      description: Updates an existing metadata value by its key
      operationId: updateThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Unique identifier of the asset (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 128
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Metadata"
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    delete:
      tags:
      - Threat Model Sub-Resources
      summary: Delete asset metadata
      description: Deletes a metadata key-value pair from the specified asset
      operationId: deleteThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Unique identifier of the asset (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: key
        in: path
        description: Metadata key
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 128
          type: string
      responses:
        "204":
          description: Metadata deleted successfully
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /threat_models/{threat_model_id}/assets/{asset_id}/metadata/bulk:
    put:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk upsert asset metadata
      description: Creates or updates multiple metadata key-value pairs for the specified
        asset
      operationId: bulkUpsertThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Unique identifier of the asset (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "200":
          description: Metadata upserted successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
    post:
      tags:
      - Threat Model Sub-Resources
      summary: Bulk create asset metadata
      description: Creates multiple metadata key-value pairs for the specified asset
      operationId: bulkCreateThreatModelAssetMetadata
      parameters:
      - name: threat_model_id
        in: path
        description: Unique identifier of the threat model (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      - name: asset_id
        in: path
        description: Unique identifier of the asset (UUID)
        required: true
        style: simple
        explode: false
        schema:
          maxLength: 36
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
        required: true
      responses:
        "201":
          description: Metadata created successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Metadata"
                x-content-type: application/json
        "400":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "401":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "403":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "404":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
        "500":
          description: Error response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                authorizationError:
                  summary: Insufficient permissions for sub-resource access
                  value:
                    error: access_denied
                    error_description: User does not have sufficient permissions to
                      access this sub-resource
                    details:
                      required_role: writer
                      user_role: reader
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                      resource_type: threat
                notFoundError:
                  summary: Sub-resource not found
                  value:
                    error: not_found
                    error_description: The requested sub-resource does not exist or
                      does not belong to the specified threat model
                    details:
                      resource_id: 550e8400-e29b-41d4-a716-446655440999
                      resource_type: document
                      threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                validationError:
                  summary: Invalid input data
                  value:
                    error: invalid_input
                    error_description: The provided data does not meet validation
                      requirements
                    details:
                      field_errors:
                      - field: name
                        message: Name is required and cannot be empty
                      - field: uri
                        message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS\
                          \ URL"
      security:
      - bearerAuth: []
  /saml/metadata:
    get:
      tags:
      - Authentication
      summary: Get SAML service provider metadata
      description: Returns the SP metadata XML for SAML configuration
      operationId: getSAMLMetadata
      responses:
        "200":
          description: SAML metadata XML
          content:
            application/samlmetadata+xml:
              schema:
                type: string
                format: xml
                x-content-type: application/samlmetadata+xml
        "500":
          description: Failed to generate metadata
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /saml/login:
    get:
      tags:
      - Authentication
      summary: Initiate SAML authentication
      description: Starts SAML authentication flow by redirecting to IdP
      operationId: initiateSAMLLogin
      parameters:
      - name: client_callback
        in: query
        description: Client callback URL to redirect after authentication
        required: false
        style: form
        explode: true
        schema:
          type: string
          format: uri
      responses:
        "302":
          description: Redirect to SAML IdP for authentication
        "500":
          description: Failed to initiate SAML authentication
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /saml/acs:
    post:
      tags:
      - Authentication
      summary: SAML Assertion Consumer Service
      description: Processes SAML responses from IdP after authentication
      operationId: processSAMLResponse
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/saml_acs_body"
      responses:
        "200":
          description: Authentication successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthTokenResponse"
        "302":
          description: Redirect to client callback with token
        "400":
          description: Invalid SAML response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Authentication failed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /saml/slo:
    get:
      tags:
      - Authentication
      summary: SAML Single Logout
      description: Handles SAML logout requests from IdP
      operationId: processSAMLLogout
      parameters:
      - name: SAMLRequest
        in: query
        description: Base64-encoded SAML logout request
        required: true
        style: form
        explode: true
        schema:
          type: string
      responses:
        "200":
          description: Logout successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_8"
        "400":
          description: Invalid SAML logout request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    post:
      tags:
      - Authentication
      summary: SAML Single Logout (POST)
      description: Handles SAML logout requests from IdP via POST
      operationId: processSAMLLogoutPost
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: "#/components/schemas/saml_slo_body"
      responses:
        "200":
          description: Logout successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/inline_response_200_8"
        "400":
          description: Invalid SAML logout request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
components:
  schemas:
    ApiInfo:
      required:
      - api
      - operator
      - service
      - status
      type: object
      properties:
        status:
          $ref: "#/components/schemas/ApiInfo_status"
        service:
          $ref: "#/components/schemas/ApiInfo_service"
        api:
          $ref: "#/components/schemas/ApiInfo_api"
        operator:
          $ref: "#/components/schemas/ApiInfo_operator"
      description: API information response for the root endpoint
      example:
        status:
          code: OK
          time: 2025-04-09T12:00:00Z
        service:
          name: TMI
          build: 1.0.0-386eea0
        api:
          version: "1.0"
          specification: https://github.com/ericfitz/tmi/blob/main/docs/reference/apis/tmi-openapi.json
        operator:
          name: Example Organization
          contact: api-support@example.com
    OAuthProtectedResourceMetadata:
      required:
      - resource
      type: object
      properties:
        resource:
          type: string
          description: The protected resource's resource identifier URL
          format: uri
          example: http://localhost:8080
        scopes_supported:
          type: array
          description: JSON array of OAuth scope values supported by this protected
            resource
          example:
          - openid
          - email
          - profile
          items:
            type: string
        authorization_servers:
          type: array
          description: List of authorization server issuer identifiers that can issue
            tokens for this resource
          example:
          - http://localhost:8080
          items:
            type: string
            format: uri
        jwks_url:
          type: string
          description: URL of the protected resource's JSON Web Key Set
          format: uri
          example: http://localhost:8080/.well-known/jwks.json
        bearer_methods_supported:
          type: array
          description: Supported token presentation methods for bearer tokens
          example:
          - header
          - body
          - query
          items:
            type: string
        resource_name:
          type: string
          description: Human-readable name of the protected resource
          example: TMI (Threat Modeling Improved) API
        resource_documentation:
          type: string
          description: URL with information for developers on how to use this protected
            resource
          format: uri
          example: https://github.com/ericfitz/tmi
        tls_client_certificate_bound_access_tokens:
          type: boolean
          description: Whether the protected resource supports TLS client certificate
            bound access tokens
          example: false
      description: OAuth 2.0 protected resource metadata as defined in RFC 9728
      example:
        resource: http://localhost:8080
        scopes_supported:
        - openid
        - email
        - profile
        authorization_servers:
        - http://localhost:8080
        jwks_url: http://localhost:8080/.well-known/jwks.json
        bearer_methods_supported:
        - header
        resource_name: TMI (Threat Modeling Improved) API
        resource_documentation: https://github.com/ericfitz/tmi
        tls_client_certificate_bound_access_tokens: false
    Document:
      description: Complete Document schema with server-generated fields
      allOf:
      - $ref: "#/components/schemas/DocumentBase"
      - required:
        - id
        type: object
        properties:
          id:
            type: string
            description: Unique identifier for the document
            format: uuid
            readOnly: true
          metadata:
            type: array
            description: Optional metadata key-value pairs
            readOnly: true
            items:
              $ref: "#/components/schemas/Metadata"
          created_at:
            maxLength: 24
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
    BaseDiagram:
      required:
      - created_at
      - id
      - modified_at
      - name
      - type
      type: object
      properties:
        id:
          maxLength: 36
          type: string
          description: Unique identifier for the diagram (UUID)
          format: uuid
          readOnly: true
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name of the diagram
        type:
          maxLength: 64
          type: string
          description: Type of diagram with version
          enum:
          - DFD-1.0.0
        created_at:
          maxLength: 36
          type: string
          description: Creation timestamp (ISO3339)
          format: date-time
        modified_at:
          maxLength: 36
          type: string
          description: Last modification timestamp (ISO3339)
          format: date-time
        metadata:
          type: array
          description: Key-value pairs for additional diagram metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        update_vector:
          minimum: 0
          type: integer
          description: "Server-managed monotonic version counter, incremented on each\
            \ diagram update"
          format: int64
          readOnly: true
        image:
          $ref: "#/components/schemas/BaseDiagram_image"
        description:
          maxLength: 1024
          type: string
          description: Optional description of the diagram
          nullable: true
      description: Base diagram object with common properties
      discriminator:
        propertyName: type
        mapping:
          DFD-1.0.0: "#/components/schemas/DfdDiagram"
    DfdDiagram:
      allOf:
      - $ref: "#/components/schemas/BaseDiagram"
      - required:
        - cells
        type: object
        properties:
          type:
            type: string
            description: DFD diagram type with version
            enum:
            - DFD-1.0.0
          cells:
            type: array
            description: List of diagram cells (nodes and edges) following X6 structure
            items:
              oneOf:
              - $ref: "#/components/schemas/Node"
              - $ref: "#/components/schemas/Edge"
        description: Data Flow Diagram (DFD) with cells
    CreateDiagramRequest:
      required:
      - name
      - type
      type: object
      properties:
        name:
          maxLength: 256
          type: string
          description: Name of the diagram
        type:
          maxLength: 64
          type: string
          description: Type of diagram with version
          enum:
          - DFD-1.0.0
      additionalProperties: false
      description: Request body for creating a new diagram - only includes client-provided
        fields
    Diagram:
      example:
        id: 359314D9-B6A3-460B-805F-B82190D7290F
        type: DFD-1.0.0
        name: Workflow Diagram
        description: A process workflow
        created_at: 2025-04-06T12:00:00Z
        modified_at: 2025-04-06T12:30:00Z
        metadata: []
        cells:
        - id: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
          shape: process
          x: 100
          "y": 100
          width: 120
          height: 60
          zIndex: 10
          visible: true
          attrs:
            body:
              fill: "#ffffff"
              stroke: "#000000"
              strokeWidth: 2
            text:
              text: Process Data
              fontSize: 14
              fill: "#000000"
          ports:
            groups:
              in:
                position: left
              out:
                position: right
            items:
            - id: port_in_1
              group: in
            - id: port_out_1
              group: out
          data: []
        - id: 456789AB-CD12-34EF-56GH-789012345678
          shape: edge
          source:
            cell: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
            port: port_out_1
          target:
            cell: 789ABC12-3456-78DE-F012-3456789ABCDE
          zIndex: 1
          visible: true
          attrs:
            line:
              stroke: "#808080"
              strokeWidth: 1
              targetMarker:
                name: classic
                size: 8
          labels:
          - attrs:
              text:
                text: Data Flow
                fontSize: 12
                fill: "#333333"
            position: 0.5
          vertices: []
          data: []
      discriminator:
        propertyName: type
        mapping:
          DFD-1.0.0: "#/components/schemas/DfdDiagram"
      oneOf:
      - $ref: "#/components/schemas/DfdDiagram"
    Cell:
      required:
      - id
      - shape
      type: object
      properties:
        id:
          maxLength: 36
          type: string
          description: Unique identifier of the cell (UUID)
          format: uuid
          example: 37eaedfa-bf37-4996-8665-242fec34bbff
        shape:
          type: string
          description: Shape type identifier that determines cell structure and behavior
          example: process
        zIndex:
          minimum: 0
          type: number
          description: Z-order layer for rendering (higher values render on top)
          default: 1
        visible:
          type: boolean
          description: Whether the cell is visible in the diagram
          default: true
        data:
          $ref: "#/components/schemas/Cell_data"
        markup:
          type: array
          description: SVG/HTML markup definition for custom shape rendering in X6
          items:
            $ref: "#/components/schemas/MarkupElement"
        tools:
          type: array
          description: Interactive tools attached to the cell for user interaction
          items:
            $ref: "#/components/schemas/CellTool"
      description: "Base schema for all diagram cells (nodes and edges) in AntV X6\
        \ native format. This schema matches X6's toJSON() output exactly, enabling\
        \ zero-transformation persistence. X6-specific properties like markup, tools,\
        \ router, and connector are fully supported."
      discriminator:
        propertyName: shape
    Node:
      allOf:
      - $ref: "#/components/schemas/Cell"
      - required:
        - position
        - size
        type: object
        properties:
          shape:
            type: string
            description: Node type determining its visual representation and behavior
            enum:
            - actor
            - process
            - store
            - security-boundary
            - text-box
          position:
            $ref: "#/components/schemas/Node_position"
          size:
            $ref: "#/components/schemas/Node_size"
          angle:
            type: number
            description: Rotation angle in degrees
            default: 0
          attrs:
            description: Visual styling attributes for the node
            allOf:
            - $ref: "#/components/schemas/NodeAttrs"
          ports:
            description: Port configuration for connections
            allOf:
            - $ref: "#/components/schemas/PortConfiguration"
          parent:
            maxLength: 36
            type: string
            description: ID of the parent cell for nested/grouped nodes (UUID)
            format: uuid
            nullable: true
        description: "A diagram node representing an entity, process, store, or boundary.\
          \ Fully compatible with X6 Node objects using X6's native toJSON/fromJSON\
          \ format with position and size objects."
        example:
          id: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
          shape: process
          position:
            x: 100
            "y": 100
          size:
            width: 120
            height: 60
          zIndex: 10
          visible: true
          attrs:
            body:
              fill: "#ffffff"
              stroke: "#000000"
              strokeWidth: 2
            text:
              text: Process Data
              fontSize: 14
              fill: "#000000"
          ports:
            groups:
              in:
                position: left
              out:
                position: right
            items:
            - id: port_in_1
              group: in
            - id: port_out_1
              group: out
          data:
            _metadata:
            - key: category
              value: business-process
            - key: owner
              value: engineering-team
            customValidation:
              rules:
              - required-input
              - sanitize-output
              level: strict
          markup:
          - tagName: rect
            selector: body
            attrs:
              rx: 5
              ry: 5
          - tagName: text
            selector: label
          tools:
          - name: boundary
            args:
              padding: 5
    Edge:
      allOf:
      - $ref: "#/components/schemas/Cell"
      - required:
        - source
        - target
        type: object
        properties:
          shape:
            type: string
            description: Edge type identifier
            enum:
            - edge
          source:
            description: Source connection point
            allOf:
            - $ref: "#/components/schemas/EdgeTerminal"
          target:
            description: Target connection point
            allOf:
            - $ref: "#/components/schemas/EdgeTerminal"
          attrs:
            description: Visual styling attributes for the edge
            allOf:
            - $ref: "#/components/schemas/EdgeAttrs"
          labels:
            type: array
            description: Text labels positioned along the edge
            items:
              $ref: "#/components/schemas/EdgeLabel"
          vertices:
            type: array
            description: Intermediate waypoints for edge routing
            items:
              $ref: "#/components/schemas/Point"
          router:
            description: Edge routing algorithm configuration for path calculation
            allOf:
            - $ref: "#/components/schemas/EdgeRouter"
          connector:
            description: Edge connector style configuration for visual appearance
            allOf:
            - $ref: "#/components/schemas/EdgeConnector"
          defaultLabel:
            description: Default label configuration applied to edges without explicit
              labels
            allOf:
            - $ref: "#/components/schemas/EdgeLabel"
        description: "A diagram edge representing a connection or data flow between\
          \ nodes. Fully compatible with X6 Edge objects and supports X6 routing algorithms\
          \ (manhattan, orth, oneSide, metro, er), connector styles (normal, rounded,\
          \ smooth, jumpover), custom markup, tools, and convenience properties (label,\
          \ style) for easier integration."
        example:
          id: 456789AB-CD12-34EF-56GH-789012345678
          shape: edge
          source:
            cell: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
            port: port_out_1
          target:
            cell: 789ABC12-3456-78DE-F012-3456789ABCDE
          zIndex: 1
          visible: true
          attrs:
            line:
              stroke: "#808080"
              strokeWidth: 1
              targetMarker:
                name: classic
                size: 8
          labels:
          - attrs:
              text:
                text: Data Flow
                fontSize: 12
                fill: "#333333"
            position: 0.5
          vertices: []
          data:
            _metadata:
            - key: flow-type
              value: data
            - key: sensitivity
              value: public
            routingHints:
              preferredPath: shortest
              avoidOverlap: true
          router:
            name: manhattan
            args:
              step: 10
              padding: 20
          connector:
            name: rounded
            args:
              radius: 5
    ThreatModel:
      example:
        id: F898D276-DE86-4837-9B5E-C46E1A08EAB6
        name: System Threat Model
        description: Threats for system X
        created_at: 2025-04-06T12:00:00Z
        modified_at: 2025-04-06T12:00:00Z
        owner: user@example.com
        created_by: user@example.com
        threat_model_framework: STRIDE
        authorization:
        - subject: user@example.com
          subject_type: user
          role: owner
        - subject: security-team
          subject_type: group
          idp: saml_okta
          role: writer
        metadata: []
        documents:
        - id: 3ba7b810-9dad-11d1-beef-00c04fd430c8
          name: System Architecture Document
          description: Technical architecture documentation for the system
          metadata:
          - key: document_type
            value: architecture
          - key: version
            value: "2.1"
          uri: https://docs.example.com/system-architecture.pdf
        repositories:
        - id: 6ba7b810-1dad-11d1-8080-00c04fd430c8
          name: GitHub Repo
          description: Source code for the tmi-ux application
          type: git
          parameters:
            refType: branch
            refValue: main
          metadata:
          - key: environment
            value: production
          - key: team
            value: security
          uri: https://github.com/ericfitz/tmi-ux.git
        diagrams:
        - id: 22DB9004-435D-4765-9E41-0291AA8FE15A
          type: DFD-1.0.0
          name: System Overview Diagram
          description: Main system data flow diagram
          created_at: 2025-04-06T12:00:00Z
          modified_at: 2025-04-06T12:30:00Z
          metadata: []
          cells: []
        threats:
        - id: EC464A19-D1CA-4B72-AD8D-055AD2073C2B
          threat_model_id: B7946A3A-5581-42C6-91BF-F41A1E1DD535
          name: Data Breach
          description: Unauthorized data access
          mitigation: "Recommendation: implement least privilege authorization policy"
          created_at: 2025-04-06T12:01:00Z
          modified_at: 2025-04-06T12:01:00Z
          diagram_id: ""
          cell_id: ""
          severity: High
          score: 7.5
          priority: High
          mitigated: false
          status: Open
          threat_type: Information Disclosure
          metadata: []
          issue_uri: https://issues.example.com/browse/SEC-456
        issue_uri: https://issues.example.com/browse/TM-123
        notes:
        - id: 6ba7b810-9dad-11d1-beef-00c04fd430c8
          name: Security Considerations
          content: |-
            # Security Notes

            - Consider authentication requirements
            - Review encryption needs
          description: Important security considerations for the threat model
          metadata:
          - key: priority
            value: high
        assets:
        - id: 7ba7b810-9dad-11d1-beef-00c04fd430c9
          name: Customer Database
          description: Primary database containing customer information
          type: data
          criticality: high
          classification:
          - confidential
          - regulated
          sensitivity:
          - pii
          - financial
          threat_model_id: F898D276-DE86-4837-9B5E-C46E1A08EAB6
          created_at: 2025-04-06T12:00:00Z
          modified_at: 2025-04-06T12:00:00Z
          metadata:
          - key: data_retention
            value: 7_years
        status:
        - In progress
        - Review
        status_updated: 2025-04-08T14:30:00Z
      allOf:
      - $ref: "#/components/schemas/ThreatModelBase"
      - type: object
        properties:
          id:
            maxLength: 36
            type: string
            description: Unique identifier for the threat model (UUID)
            format: uuid
            readOnly: true
          created_at:
            maxLength: 24
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
          created_by:
            maxLength: 256
            pattern: "^[^<>\"'&]*$"
            type: string
            description: "User name, email or identifier of the creator of the threat\
              \ model"
            readOnly: true
          documents:
            type: array
            description: List of documents related to the threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/Document"
          repositories:
            type: array
            description: List of source code repositories related to the threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/Repository"
          diagrams:
            type: array
            description: List of diagram objects associated with this threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/Diagram"
          threats:
            type: array
            description: List of threats within the threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/Threat"
          notes:
            type: array
            description: List of notes associated with the threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/Note"
          assets:
            type: array
            description: List of assets associated with the threat model
            readOnly: true
            items:
              $ref: "#/components/schemas/ExtendedAsset"
          status_updated:
            maxLength: 24
            type: string
            description: Timestamp when the status field was last modified (RFC3339).
              Automatically updated by the server when status changes.
            format: date-time
            nullable: true
            readOnly: true
        description: Complete ThreatModel with server-generated fields
    Threat:
      allOf:
      - $ref: "#/components/schemas/ThreatBase"
      - type: object
        properties:
          id:
            maxLength: 36
            type: string
            description: Unique identifier for the threat (UUID)
            format: uuid
            readOnly: true
          threat_model_id:
            maxLength: 36
            type: string
            description: Unique identifier of the parent threat model (UUID)
            format: uuid
            readOnly: true
          created_at:
            maxLength: 24
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
        description: Complete Threat with server-generated fields
    Authorization:
      required:
      - role
      - subject
      - subject_type
      type: object
      properties:
        subject:
          maxLength: 500
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: "Email address or user id for users, group name for groups"
          x-oapi-codegen-extra-tags:
            binding: required
        subject_type:
          type: string
          description: "Type of authorization subject: user (individual) or group"
          enum:
          - user
          - group
          x-oapi-codegen-extra-tags:
            binding: required
        idp:
          maxLength: 100
          type: string
          description: "Identity provider (required for groups, optional for users)"
        role:
          maxLength: 6
          type: string
          description: "Role: reader (view), writer (edit), owner (full control)"
          enum:
          - reader
          - writer
          - owner
          x-oapi-codegen-extra-tags:
            binding: required
      description: Authorization entry defining access permissions for users or groups
    Metadata:
      required:
      - key
      - value
      type: object
      properties:
        key:
          maxLength: 256
          minLength: 1
          pattern: "^[a-zA-Z0-9_./:-]+$"
          type: string
          description: Metadata key
          x-oapi-codegen-extra-tags:
            binding: required
        value:
          maxLength: 1024
          minLength: 1
          pattern: "^[^<>]*$"
          type: string
          description: Metadata value
          x-oapi-codegen-extra-tags:
            binding: required
      description: A key-value pair for extensible metadata
      example:
        value: value
        key: key
    Error:
      required:
      - error
      - error_description
      type: object
      properties:
        error:
          type: string
          description: Error code
        error_description:
          type: string
          description: Human-readable error description
        error_uri:
          type: string
          description: URI to documentation about the error
          format: uri
        details:
          $ref: "#/components/schemas/Error_details"
      description: Standard error response format
      example:
        error: invalid_request
        error_description: The request is missing a required parameter
        error_uri: https://docs.example.com/oauth2/errors/invalid_request
    AuthTokenResponse:
      required:
      - access_token
      - expires_in
      - refresh_token
      - token_type
      type: object
      properties:
        access_token:
          type: string
          description: JWT access token
        refresh_token:
          type: string
          description: Refresh token for obtaining new access tokens
        token_type:
          type: string
          description: Token type
          enum:
          - Bearer
        expires_in:
          type: integer
          description: Access token expiration time in seconds
      description: JWT token response for authentication endpoints
      example:
        access_token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        refresh_token: def456...
        token_type: Bearer
        expires_in: 3600
    CollaborationSession:
      required:
      - diagram_id
      - diagram_name
      - host
      - participants
      - session_id
      - threat_model_id
      - threat_model_name
      - websocket_url
      type: object
      properties:
        session_id:
          maxLength: 36
          type: string
          description: Unique identifier for the session (UUID)
          format: uuid
          readOnly: true
        host:
          maxLength: 256
          type: string
          description: Email address of the session host
          readOnly: true
        presenter:
          maxLength: 256
          type: string
          description: Email address of the current presenter
          readOnly: true
        threat_model_id:
          maxLength: 36
          type: string
          description: Unique identifier of the associated threat model (UUID)
          format: uuid
        threat_model_name:
          maxLength: 256
          type: string
          description: Name of the associated threat model
        diagram_id:
          maxLength: 36
          type: string
          description: Unique identifier of the associated diagram (UUID)
          format: uuid
        diagram_name:
          maxLength: 256
          type: string
          description: Name of the associated diagram
        participants:
          type: array
          description: List of active participants
          items:
            $ref: "#/components/schemas/Participant"
        websocket_url:
          maxLength: 1024
          type: string
          description: WebSocket URL for real-time updates
      description: Details of an active collaboration session for a diagram
      example:
        session_id: D7744D3A-ED22-40AF-862B-29786CAD0007
        host: admin@example.com
        threat_model_id: 5311D207-AFD5-4A1A-BA83-14C1445DC257
        threat_model_name: E-commerce Platform Security Analysis
        diagram_id: DFF7F4A9-CBCE-4001-9198-2706C86F7EF3
        diagram_name: User Authentication Flow
        participants:
        - user:
            user_id: oauth2|test|user123
            email: admin@example.com
            name: Admin User
          last_activity: 2025-04-06T12:02:00Z
          permissions: writer
        websocket_url: wss://api.example.com/threat_models/5311D207-AFD5-4A1A-BA83-14C1445DC257/diagrams/DFF7F4A9-CBCE-4001-9198-2706C86F7EF3/ws
    DiagramListItem:
      required:
      - id
      - name
      - type
      type: object
      properties:
        id:
          maxLength: 36
          type: string
          description: Unique identifier of the diagram (UUID)
          format: uuid
          readOnly: true
        name:
          maxLength: 256
          type: string
          description: Name of the diagram
        type:
          type: string
          description: Type of the diagram
          enum:
          - DFD-1.0.0
      description: "A simplified diagram item for list endpoints, containing id, name,\
        \ and type"
      example:
        name: name
        id: 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        type: DFD-1.0.0
    TMListItem:
      required:
      - asset_count
      - created_at
      - created_by
      - diagram_count
      - document_count
      - id
      - modified_at
      - name
      - note_count
      - owner
      - repo_count
      - threat_count
      - threat_model_framework
      type: object
      properties:
        id:
          maxLength: 36
          type: string
          description: Unique identifier of the threat model (UUID)
          format: uuid
          readOnly: true
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name of the threat model
        description:
          maxLength: 1024
          type: string
          description: Description of the threat model
        created_at:
          maxLength: 24
          type: string
          description: Creation timestamp (RFC3339)
          format: date-time
        modified_at:
          maxLength: 24
          type: string
          description: Last modification timestamp (RFC3339)
          format: date-time
        owner:
          type: string
          description: Email address of the current owner
        created_by:
          maxLength: 256
          type: string
          description: "Email address, name or identifier of the creator"
        threat_model_framework:
          type: string
          description: The framework used for this threat model
        document_count:
          minimum: 0
          type: integer
          description: Number of documents associated with this threat model
        repo_count:
          minimum: 0
          type: integer
          description: Number of source code repository entries associated with this
            threat model
        diagram_count:
          minimum: 0
          type: integer
          description: Number of diagrams associated with this threat model
        threat_count:
          minimum: 0
          type: integer
          description: Number of threats defined in this threat model
        issue_uri:
          maxLength: 1024
          type: string
          description: URL to an issue in an issue tracking system
          format: uri
        asset_count:
          minimum: 0
          type: integer
          description: Number of assets associated with this threat model
        note_count:
          minimum: 0
          type: integer
          description: Number of notes associated with this threat model
      description: Enhanced item for threat model list endpoints with key metadata
        and counts
      example:
        owner: owner
        document_count: 0
        description: description
        created_at: 2000-01-23T04:56:07.000+00:00
        created_by: created_by
        repo_count: 0
        threat_count: 0
        issue_uri: http://example.com/aeiou
        threat_model_framework: threat_model_framework
        asset_count: 0
        diagram_count: 0
        name: name
        id: 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        modified_at: 2000-01-23T04:56:07.000+00:00
        note_count: 0
    Point:
      required:
      - x
      - "y"
      type: object
      properties:
        x:
          type: number
          description: X coordinate
        "y":
          type: number
          description: Y coordinate
      description: A 2D point with x and y coordinates
      example:
        x: 100
        "y": 200
    EdgeTerminal:
      required:
      - cell
      type: object
      properties:
        cell:
          maxLength: 36
          type: string
          description: ID of the connected node (UUID)
          format: uuid
        port:
          maxLength: 64
          type: string
          description: ID of the specific port on the node (optional)
          nullable: true
      description: Connection point for an edge (source or target)
      example:
        cell: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
        port: port_out_1
    NodeAttrs:
      type: object
      properties:
        body:
          $ref: "#/components/schemas/NodeAttrs_body"
        text:
          $ref: "#/components/schemas/NodeAttrs_text"
      description: Visual attributes for a node
    EdgeAttrs:
      type: object
      properties:
        line:
          $ref: "#/components/schemas/EdgeAttrs_line"
      description: Visual attributes for an edge
    EdgeLabel:
      type: object
      properties:
        attrs:
          $ref: "#/components/schemas/EdgeLabel_attrs"
        position:
          maximum: 1
          minimum: 0
          type: number
          description: "Position along the edge (0 = start, 1 = end)"
      description: Label positioned along an edge
      example:
        attrs:
          text:
            text: Data Flow
            fontSize: 12
            fill: "#333333"
        position: 0.5
    PortConfiguration:
      type: object
      properties:
        groups:
          type: object
          additionalProperties:
            $ref: "#/components/schemas/PortConfiguration_groups"
          description: Port group definitions
        items:
          type: array
          description: Individual port instances
          items:
            $ref: "#/components/schemas/PortConfiguration_items"
      description: Port configuration for node connections
    MarkupElement:
      required:
      - tagName
      type: object
      properties:
        tagName:
          type: string
          description: "SVG or HTML tag name (e.g., 'rect', 'circle', 'path', 'text')"
          example: rect
        selector:
          type: string
          description: CSS selector for targeting this element in styling
          example: body
        attrs:
          type: object
          additionalProperties: true
          description: Element attributes and styling properties
          example:
            fill: "#ffffff"
            stroke: "#000000"
            stroke-width: 2
        children:
          type: array
          description: Nested child elements
          items:
            $ref: "#/components/schemas/MarkupElement"
      description: SVG/HTML markup element for custom shape definitions in X6
    CellTool:
      required:
      - name
      type: object
      properties:
        name:
          type: string
          description: "Tool identifier (e.g., 'boundary', 'button', 'remove')"
          example: button
        args:
          type: object
          additionalProperties: true
          description: Tool-specific configuration arguments
          example:
            x: 10
            "y": 10
            markup: <circle r='5' fill='red'/>
      description: Interactive tool configuration for X6 cells
    EdgeRouter:
      description: Edge routing algorithm configuration for pathfinding
      example:
        name: manhattan
        args:
          step: 10
          padding: 20
      oneOf:
      - type: string
        description: Built-in router name
        enum:
        - normal
        - orth
        - oneSide
        - manhattan
        - metro
        - er
      - required:
        - name
        type: object
        properties:
          name:
            type: string
            description: Router algorithm name
            enum:
            - normal
            - orth
            - oneSide
            - manhattan
            - metro
            - er
          args:
            $ref: "#/components/schemas/EdgeRouter_args"
        description: Router with custom configuration
    EdgeConnector:
      description: Edge connector style configuration for visual appearance
      example:
        name: rounded
        args:
          radius: 10
      oneOf:
      - type: string
        description: Built-in connector name
        enum:
        - normal
        - rounded
        - smooth
        - jumpover
      - required:
        - name
        type: object
        properties:
          name:
            type: string
            description: Connector style name
            enum:
            - normal
            - rounded
            - smooth
            - jumpover
          args:
            $ref: "#/components/schemas/EdgeConnector_args"
        description: Connector with custom configuration
    ThreatModelBase:
      required:
      - authorization
      - name
      - owner
      - threat_model_framework
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name of the threat model
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          maxLength: 1024
          pattern: "^[^<>]*$"
          type: string
          description: Description of the threat model
        owner:
          maxLength: 256
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Email address of the current owner
        threat_model_framework:
          type: string
          description: The framework used for this threat model
        authorization:
          type: array
          description: List of users and their roles for this threat model
          items:
            $ref: "#/components/schemas/Authorization"
        metadata:
          type: array
          description: Key-value pairs for additional threat model metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        issue_uri:
          maxLength: 1024
          type: string
          description: URL to an issue in an issue tracking system for this threat
            model
          format: uri
        status:
          maxItems: 50
          type: array
          description: "Status of the threat model in the organization's threat modeling\
            \ or SDLC process. Examples: \"Not started\", \"In progress\", \"Review\"\
            , \"Approved\", \"Closed\""
          nullable: true
          items:
            maxLength: 128
            type: string
      description: Base schema for ThreatModel with client-writable fields
    ThreatModelInput:
      required:
      - name
      type: object
      properties:
        name:
          maxLength: 256
          type: string
          description: Name of the threat model
        description:
          maxLength: 1024
          type: string
          description: Description of the threat model and its purpose
          nullable: true
        threat_model_framework:
          type: string
          description: The framework used for this threat model
        authorization:
          type: array
          description: List of users and their roles for this threat model
          items:
            $ref: "#/components/schemas/Authorization"
        metadata:
          type: array
          description: Key-value pairs for additional threat model metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        issue_uri:
          maxLength: 1024
          type: string
          description: URL to an issue in an issue tracking system for this threat
            model
          format: uri
          nullable: true
      description: Input schema for creating/updating ThreatModel
    ThreatBase:
      required:
      - mitigated
      - name
      - priority
      - severity
      - status
      - threat_type
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name of the threat
        description:
          maxLength: 1024
          type: string
          description: Description of the threat and risk to the organization
        mitigation:
          maxLength: 1024
          type: string
          description: Recommended or planned mitigation(s) for the threat
        diagram_id:
          maxLength: 36
          type: string
          description: Unique identifier of the associated diagram (if applicable)
            (UUID)
          format: uuid
          nullable: true
        cell_id:
          maxLength: 36
          type: string
          description: Unique identifier of the associated cell (if applicable) (UUID)
          format: uuid
          nullable: true
        severity:
          type: string
          description: Severity level of the threat
          enum:
          - Unknown
          - None
          - Low
          - Medium
          - High
          - Critical
        score:
          maximum: 10
          minimum: 0
          type: number
          description: Numeric score representing the risk or impact of the threat
        priority:
          maxLength: 16
          type: string
          description: Priority level for addressing the threat
        mitigated:
          type: boolean
          description: Whether the threat has been mitigated
        status:
          maxLength: 256
          type: string
          description: Current status of the threat
        threat_type:
          maxLength: 256
          type: string
          description: Type or category of the threat
        metadata:
          type: array
          description: Key-value pairs for additional threat metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        issue_uri:
          maxLength: 1024
          type: string
          description: URL to an issue in an issue tracking system for this threat
          format: uri
        asset_id:
          maxLength: 36
          type: string
          description: Unique identifier of the associated asset (if applicable) (UUID)
          format: uuid
          nullable: true
      description: Base schema for Threat with client-writable fields
    ThreatInput:
      description: Input schema for creating/updating Threat
      allOf:
      - $ref: "#/components/schemas/ThreatBase"
    User:
      required:
      - email
      - name
      - user_id
      type: object
      properties:
        user_id:
          maxLength: 256
          type: string
          description: OAuth provider's unique identifier for the user (from primary
            provider)
        email:
          maxLength: 256
          type: string
          description: User's email address
        name:
          maxLength: 256
          type: string
          description: User's display name
        picture:
          maxLength: 1024
          type: string
          description: URL to user's profile picture
        idp:
          maxLength: 100
          type: string
          description: Identity provider used for current session
        groups:
          type: array
          description: Groups the user belongs to (from identity provider)
          items:
            type: string
        last_login:
          type: string
          description: Timestamp of user's last login
          format: date-time
      description: Represents a user in the system
      example:
        idp: idp
        user_id: user_id
        last_login: 2000-01-23T04:56:07.000+00:00
        name: name
        groups:
        - groups
        - groups
        email: email
        picture: picture
    Participant:
      required:
      - last_activity
      - permissions
      - user
      type: object
      properties:
        user:
          $ref: "#/components/schemas/User"
        last_activity:
          maxLength: 36
          type: string
          description: Last activity timestamp
          format: date-time
        permissions:
          type: string
          description: Access permissions in the collaboration session
          enum:
          - reader
          - writer
      description: A participant in a collaboration session
    DeletionChallenge:
      required:
      - challenge_text
      - expires_at
      type: object
      properties:
        challenge_text:
          type: string
          description: The exact challenge string that must be provided to confirm
            deletion
        expires_at:
          type: string
          description: When the challenge expires (3 minutes from issuance)
          format: date-time
      description: Challenge response for user account deletion
      example:
        expires_at: 2000-01-23T04:56:07.000+00:00
        challenge_text: challenge_text
    Repository:
      description: Complete Repository schema with server-generated fields
      allOf:
      - $ref: "#/components/schemas/RepositoryBase"
      - required:
        - id
        type: object
        properties:
          id:
            type: string
            description: Unique identifier for the repository
            format: uuid
            readOnly: true
          metadata:
            type: array
            description: Optional metadata key-value pairs
            readOnly: true
            items:
              $ref: "#/components/schemas/Metadata"
          created_at:
            maxLength: 24
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
    Note:
      description: Complete Note schema with server-generated fields
      allOf:
      - $ref: "#/components/schemas/NoteBase"
      - required:
        - id
        type: object
        properties:
          id:
            type: string
            description: Unique identifier for the note
            format: uuid
            readOnly: true
          metadata:
            type: array
            description: Optional metadata key-value pairs
            readOnly: true
            items:
              $ref: "#/components/schemas/Metadata"
          created_at:
            maxLength: 24
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
    Asset:
      description: Complete Asset schema with server-generated fields
      allOf:
      - $ref: "#/components/schemas/AssetBase"
      - required:
        - id
        type: object
        properties:
          id:
            type: string
            description: Unique identifier for the asset
            format: uuid
            readOnly: true
          metadata:
            type: array
            description: Optional metadata key-value pairs
            readOnly: true
            items:
              $ref: "#/components/schemas/Metadata"
          created_at:
            maxLength: 24
            type: string
            description: Creation timestamp (RFC3339)
            format: date-time
            readOnly: true
          modified_at:
            maxLength: 24
            type: string
            description: Last modification timestamp (RFC3339)
            format: date-time
            readOnly: true
    ExtendedAsset:
      example:
        id: 6ba7b810-9dad-11d1-beef-00c04fd430c8
        name: Customer Database
        description: Primary database containing customer information
        type: data
        criticality: high
        classification:
        - confidential
        - regulated
        sensitivity:
        - pii
        - financial
        threat_model_id: 6ba7b810-9dad-11d1-beef-00c04fd430c7
        created_at: 2024-01-15T10:30:00Z
        modified_at: 2024-01-15T10:30:00Z
      allOf:
      - $ref: "#/components/schemas/Asset"
      - required:
        - created_at
        - modified_at
        - threat_model_id
        type: object
        properties:
          threat_model_id:
            maxLength: 36
            type: string
            description: ID of the threat model this asset belongs to
            format: uuid
          created_at:
            maxLength: 36
            type: string
            description: Creation timestamp (ISO3339)
            format: date-time
          modified_at:
            maxLength: 36
            type: string
            description: Last modification timestamp (ISO3339)
            format: date-time
    AssetBase:
      required:
      - name
      - type
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Asset name
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          maxLength: 1024
          type: string
          description: Description of the asset
          nullable: true
        type:
          maxLength: 64
          type: string
          description: Type of asset
          enum:
          - data
          - hardware
          - software
          - infrastructure
          - service
          - personnel
          x-oapi-codegen-extra-tags:
            binding: required
        criticality:
          maxLength: 128
          type: string
          description: Criticality level of the asset
          nullable: true
        classification:
          maxItems: 50
          type: array
          description: Classification tags for the asset
          nullable: true
          items:
            maxLength: 128
            type: string
        sensitivity:
          maxItems: 50
          type: array
          description: Sensitivity labels for the asset
          nullable: true
          items:
            maxLength: 128
            type: string
      description: Base fields for Asset (user-writable only)
    AssetInput:
      description: Input schema for creating or updating Asset
      allOf:
      - $ref: "#/components/schemas/AssetBase"
    DocumentBase:
      required:
      - name
      - uri
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Document name
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          maxLength: 1024
          type: string
          description: Description of document purpose or content
          nullable: true
        uri:
          maxLength: 1024
          type: string
          description: URL location of the document
          format: uri
          x-oapi-codegen-extra-tags:
            binding: "required,url"
      description: Base fields for Document (user-writable only)
    DocumentInput:
      description: Input schema for creating or updating Document
      allOf:
      - $ref: "#/components/schemas/DocumentBase"
    NoteBase:
      required:
      - content
      - name
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Note name
          x-oapi-codegen-extra-tags:
            binding: required
        content:
          maxLength: 65536
          minLength: 1
          type: string
          description: Note content in markdown format
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          maxLength: 1024
          type: string
          description: Description of note purpose or context
          nullable: true
      description: Base fields for Note (user-writable only)
    NoteInput:
      description: Input schema for creating or updating Note
      allOf:
      - $ref: "#/components/schemas/NoteBase"
    NoteListItem:
      required:
      - id
      - name
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Note name
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          maxLength: 1024
          type: string
          description: Description of note purpose or context
          nullable: true
        metadata:
          type: array
          description: Key-value pairs for additional note metadata
          nullable: true
          items:
            $ref: "#/components/schemas/Metadata"
        id:
          type: string
          description: Unique identifier for the note
          format: uuid
          readOnly: true
        created_at:
          maxLength: 24
          type: string
          description: Creation timestamp (RFC3339)
          format: date-time
          readOnly: true
        modified_at:
          maxLength: 24
          type: string
          description: Last modification timestamp (RFC3339)
          format: date-time
          readOnly: true
      description: Summary information for Note in list responses
      example:
        metadata:
        - value: value
          key: key
        - value: value
          key: key
        name: name
        description: description
        created_at: 2000-01-23T04:56:07.000+00:00
        id: 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        modified_at: 2000-01-23T04:56:07.000+00:00
    RepositoryBase:
      required:
      - uri
      type: object
      properties:
        name:
          maxLength: 256
          minLength: 1
          pattern: "^[^<>\"'&]*$"
          type: string
          description: Name for the source code reference
        description:
          maxLength: 1024
          type: string
          description: Description of the referenced source code
          nullable: true
        type:
          maxLength: 16
          type: string
          description: Source code repository type
          enum:
          - git
          - svn
          - mercurial
          - other
        parameters:
          $ref: "#/components/schemas/RepositoryBase_parameters"
        uri:
          maxLength: 1024
          type: string
          description: URL to retrieve the referenced source code
          format: uri
      description: Base fields for Repository (user-writable only)
    RepositoryInput:
      description: Input schema for creating or updating Repository
      allOf:
      - $ref: "#/components/schemas/RepositoryBase"
    inline_response_200:
      required:
      - authorization_endpoint
      - id_token_signing_alg_values_supported
      - issuer
      - jwks_uri
      - response_types_supported
      - subject_types_supported
      - token_endpoint
      type: object
      properties:
        issuer:
          type: string
          format: uri
          example: http://localhost:8080
        authorization_endpoint:
          type: string
          format: uri
          example: http://localhost:8080/oauth2/authorize
        token_endpoint:
          type: string
          format: uri
          example: http://localhost:8080/oauth2/token
        userinfo_endpoint:
          type: string
          format: uri
          example: http://localhost:8080/oauth2/userinfo
        jwks_uri:
          type: string
          format: uri
          example: http://localhost:8080/.well-known/jwks.json
        response_types_supported:
          type: array
          example:
          - code
          - token
          - id_token
          - code token
          - code id_token
          - token id_token
          - code token id_token
          items:
            type: string
        subject_types_supported:
          type: array
          example:
          - public
          items:
            type: string
        id_token_signing_alg_values_supported:
          type: array
          example:
          - HS256
          items:
            type: string
        scopes_supported:
          type: array
          example:
          - openid
          - email
          - profile
          items:
            type: string
        claims_supported:
          type: array
          example:
          - sub
          - email
          - email_verified
          - name
          - given_name
          - family_name
          - picture
          - locale
          items:
            type: string
        introspection_endpoint:
          type: string
          format: uri
          example: http://localhost:8080/oauth2/introspect
      example:
        response_types_supported:
        - code
        - token
        - id_token
        - code token
        - code id_token
        - token id_token
        - code token id_token
        claims_supported:
        - sub
        - email
        - email_verified
        - name
        - given_name
        - family_name
        - picture
        - locale
        introspection_endpoint: http://localhost:8080/oauth2/introspect
        jwks_uri: http://localhost:8080/.well-known/jwks.json
        subject_types_supported:
        - public
        id_token_signing_alg_values_supported:
        - HS256
        scopes_supported:
        - openid
        - email
        - profile
        issuer: http://localhost:8080
        authorization_endpoint: http://localhost:8080/oauth2/authorize
        token_endpoint: http://localhost:8080/oauth2/token
        userinfo_endpoint: http://localhost:8080/oauth2/userinfo
    inline_response_200_1:
      required:
      - authorization_endpoint
      - issuer
      - response_types_supported
      - token_endpoint
      type: object
      properties:
        issuer:
          type: string
          format: uri
          example: http://localhost:8080
        authorization_endpoint:
          type: string
          format: uri
          example: http://localhost:8080/oauth2/authorize
        token_endpoint:
          type: string
          format: uri
          example: http://localhost:8080/oauth2/token
        introspection_endpoint:
          type: string
          format: uri
          example: http://localhost:8080/oauth2/introspect
        response_types_supported:
          type: array
          example:
          - code
          - token
          - id_token
          items:
            type: string
        grant_types_supported:
          type: array
          example:
          - authorization_code
          - implicit
          - refresh_token
          items:
            type: string
        token_endpoint_auth_methods_supported:
          type: array
          example:
          - client_secret_post
          - none
          items:
            type: string
      example:
        response_types_supported:
        - code
        - token
        - id_token
        introspection_endpoint: http://localhost:8080/oauth2/introspect
        grant_types_supported:
        - authorization_code
        - implicit
        - refresh_token
        token_endpoint_auth_methods_supported:
        - client_secret_post
        - none
        issuer: http://localhost:8080
        authorization_endpoint: http://localhost:8080/oauth2/authorize
        token_endpoint: http://localhost:8080/oauth2/token
    inline_response_200_2:
      required:
      - keys
      type: object
      properties:
        keys:
          type: array
          items:
            $ref: "#/components/schemas/inline_response_200_2_keys"
      example:
        keys:
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
        - kty: oct
          use: sig
          kid: tmi-signing-key
          alg: HS256
    oauth2_introspect_body:
      required:
      - token
      type: object
      properties:
        token:
          type: string
          description: The JWT token to introspect
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        token_type_hint:
          type: string
          description: Optional hint about the type of token being introspected
          nullable: true
          example: access_token
    inline_response_200_3:
      required:
      - active
      type: object
      properties:
        active:
          type: boolean
          description: Whether the token is active/valid
          example: true
        sub:
          type: string
          description: Subject (user identifier)
          example: user@example.com
        email:
          type: string
          description: User email address
          example: user@example.com
        email_verified:
          type: boolean
          description: Whether the email is verified
          example: true
        name:
          type: string
          description: User's full name
          example: John Doe
        exp:
          type: integer
          description: Token expiration time (Unix timestamp)
          example: 1640995200
        iat:
          type: integer
          description: Token issued at time (Unix timestamp)
          example: 1640991600
        iss:
          type: string
          description: Token issuer
          example: http://localhost:8080
      example:
        sub: user@example.com
        email_verified: true
        name: John Doe
        iss: http://localhost:8080
        active: true
        exp: 1640995200
        iat: 1640991600
        email: user@example.com
    inline_response_200_4:
      required:
      - providers
      type: object
      properties:
        providers:
          type: array
          items:
            $ref: "#/components/schemas/inline_response_200_4_providers"
      example:
        providers:
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
        - name: name
          icon: icon
          id: id
          auth_url: http://example.com/aeiou
          redirect_uri: http://example.com/aeiou
          token_url: http://example.com/aeiou
          client_id: client_id
    inline_response_200_5:
      required:
      - groups
      - idp
      type: object
      properties:
        idp:
          type: string
          description: Identity provider ID
        groups:
          type: array
          items:
            $ref: "#/components/schemas/inline_response_200_5_groups"
      example:
        idp: idp
        groups:
        - used_in_authorizations: true
          name: name
          display_name: display_name
        - used_in_authorizations: true
          name: name
          display_name: display_name
    oauth2_token_body:
      required:
      - code
      - redirect_uri
      type: object
      properties:
        code:
          type: string
          description: Authorization code received from OAuth provider
          example: 4/0AX4XfWiXY2BZ_example_auth_code_from_google
        state:
          type: string
          description: State parameter for CSRF protection (optional but recommended)
          example: random_state_value_abc123
        redirect_uri:
          type: string
          description: Redirect URI used in the authorization request (must match
            exactly)
          format: uri
          example: https://your-web-app.com/oauth2/callback
    oauth2_refresh_body:
      required:
      - refresh_token
      type: object
      properties:
        refresh_token:
          type: string
          description: Valid refresh token
          example: 8xLOxBtZp8_example_refresh_token
    inline_response_200_6:
      required:
      - email
      - id
      - name
      type: object
      properties:
        sub:
          type: string
          description: Subject identifier (email or provider-assigned ID)
        id:
          maxLength: 36
          type: string
          description: Unique identifier for the user (UUID)
          format: uuid
        email:
          type: string
          description: User email address
          format: email
        name:
          type: string
          description: User display name
        idp:
          maxLength: 100
          type: string
          description: Current identity provider
        groups:
          type: array
          description: Groups the user belongs to
          items:
            type: string
        providers:
          type: array
          description: Linked OAuth providers
          items:
            $ref: "#/components/schemas/inline_response_200_6_providers"
      example:
        sub: sub
        idp: idp
        name: name
        groups:
        - groups
        - groups
        id: 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        email: ""
        providers:
        - is_primary: true
          provider: provider
        - is_primary: true
          provider: provider
    threat_models_threat_model_id_body:
      required:
      - op
      - path
      type: object
      properties:
        op:
          type: string
          description: Patch operation type
          enum:
          - add
          - replace
          - remove
          - move
          - copy
          - test
        path:
          type: string
          description: JSON path to target
        value:
          description: Value to apply
    threats_threat_id_body:
      required:
      - op
      - path
      type: object
      properties:
        op:
          type: string
          enum:
          - add
          - remove
          - replace
          - move
          - copy
          - test
        path:
          type: string
        value: {}
        from:
          type: string
    metadata_key_body:
      required:
      - value
      type: object
      properties:
        value:
          type: string
          description: New value for the metadata entry
    inline_response_200_7:
      type: object
      properties:
        deleted_count:
          type: integer
          description: Number of threats deleted
        deleted_ids:
          type: array
          description: IDs of deleted threats
          items:
            type: string
            format: uuid
      example:
        deleted_count: 0
        deleted_ids:
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
        - 046b6c7f-0b8a-43b9-b35d-6489e6daee91
    threat_modelsthreat_model_idthreatsbulk_patches:
      required:
      - id
      - operations
      type: object
      properties:
        id:
          type: string
          description: Threat ID to patch
          format: uuid
        operations:
          type: array
          description: JSON Patch operations to apply
          items:
            $ref: "#/components/schemas/threats_threat_id_body"
    threats_bulk_body:
      required:
      - patches
      type: object
      properties:
        patches:
          type: array
          items:
            $ref: "#/components/schemas/threat_modelsthreat_model_idthreatsbulk_patches"
    metadata_key_body_1:
      required:
      - value
      type: object
      properties:
        value:
          type: string
          description: New value for the metadata entry
    metadata_key_body_2:
      required:
      - value
      type: object
      properties:
        value:
          type: string
          description: New value for the metadata entry
    metadata_key_body_3:
      required:
      - value
      type: object
      properties:
        value:
          type: string
          description: New value for the metadata entry
    inline_response_409:
      required:
      - error
      - join_url
      type: object
      properties:
        error:
          type: string
          description: Error message indicating session already exists
        join_url:
          type: string
          description: URL to join the existing collaboration session
          example: "/threat_models/{threat_model_id}/diagrams/{diagram_id}/collaborate"
    metadata_key_body_4:
      required:
      - value
      type: object
      properties:
        value:
          maxLength: 1024
          type: string
          description: Metadata value
    metadata_key_body_5:
      required:
      - value
      type: object
      properties:
        value:
          type: string
          description: New value for the metadata entry
    saml_acs_body:
      required:
      - SAMLResponse
      type: object
      properties:
        SAMLResponse:
          type: string
          description: Base64-encoded SAML response
        RelayState:
          type: string
          description: State parameter for CSRF protection
    inline_response_200_8:
      type: object
      properties:
        message:
          type: string
      example:
        message: message
    saml_slo_body:
      required:
      - SAMLRequest
      type: object
      properties:
        SAMLRequest:
          type: string
          description: Base64-encoded SAML logout request
    ApiInfo_status:
      required:
      - code
      - time
      type: object
      properties:
        code:
          type: string
          description: Status code indicating if the API is functioning correctly
          enum:
          - OK
          - ERROR
        time:
          type: string
          description: "Current server time in UTC, formatted as RFC 3339"
          format: date-time
    ApiInfo_service:
      required:
      - build
      - name
      type: object
      properties:
        name:
          type: string
          description: Name of the service
        build:
          maxLength: 256
          type: string
          description: Current build number
    ApiInfo_api:
      required:
      - specification
      - version
      type: object
      properties:
        version:
          type: string
          description: API version
        specification:
          maxLength: 1024
          type: string
          description: URL to the API specification
          format: uri
    ApiInfo_operator:
      required:
      - contact
      - name
      type: object
      properties:
        name:
          maxLength: 256
          type: string
          description: Operator name from environment variables
        contact:
          maxLength: 1024
          type: string
          description: Operator contact information from environment variables
    BaseDiagram_image:
      type: object
      properties:
        svg:
          type: string
          description: "BASE64 encoded SVG representation of the diagram, used for\
            \ thumbnails and reports"
          format: byte
        update_vector:
          minimum: 0
          type: integer
          description: "Version of the diagram when this SVG was generated. If not\
            \ provided when svg is updated, will be auto-set to BaseDiagram.update_vector"
          format: int64
      description: Image data with version information
      nullable: true
    Cell_data:
      type: object
      properties:
        _metadata:
          type: array
          description: Reserved namespace for structured business metadata
          items:
            $ref: "#/components/schemas/Metadata"
      additionalProperties: true
      description: "Flexible data storage compatible with X6, with reserved metadata\
        \ namespace"
    Node_position:
      required:
      - x
      - "y"
      type: object
      properties:
        x:
          type: number
          description: X coordinate
        "y":
          type: number
          description: Y coordinate
      description: Node position in X6 format
    Node_size:
      required:
      - height
      - width
      type: object
      properties:
        width:
          minimum: 40
          type: number
          description: Width in pixels
        height:
          minimum: 30
          type: number
          description: Height in pixels
      description: Node size in X6 format
    Error_details:
      type: object
      properties:
        code:
          type: string
          description: Machine-readable error code for programmatic handling
          example: COLLABORATION_SESSION_NOT_FOUND
        context:
          type: object
          additionalProperties: true
          description: Contextual information about the error
          example:
            diagram_id: 550e8400-e29b-41d4-a716-446655440000
            requested_operation: end_session
        suggestion:
          type: string
          description: Human-readable suggestion for resolving the error
          example: "Start a collaboration session first using POST /diagrams/{id}/collaborate"
      additionalProperties: false
      description: Additional context-specific error information
      nullable: true
    NodeAttrs_body:
      type: object
      properties:
        fill:
          maxLength: 32
          type: string
          description: Fill color
        stroke:
          maxLength: 32
          type: string
          description: Stroke color
        strokeWidth:
          minimum: 0
          type: number
          description: Stroke width in pixels
        strokeDasharray:
          maxLength: 64
          type: string
          description: Dash pattern for strokes
          nullable: true
      description: Body/shape styling attributes
    NodeAttrs_text:
      type: object
      properties:
        text:
          maxLength: 256
          type: string
          description: Label text content
        fontSize:
          minimum: 1
          type: number
          description: Font size in pixels
        fill:
          maxLength: 32
          type: string
          description: Text color
        fontFamily:
          maxLength: 64
          type: string
          description: Font family
      description: Text/label styling attributes
    EdgeAttrs_line_targetMarker:
      type: object
      properties:
        name:
          maxLength: 32
          type: string
          description: Marker type
          enum:
          - classic
          - block
          - diamond
          - circle
        size:
          minimum: 1
          type: number
          description: Marker size in pixels
      description: Arrowhead marker configuration
    EdgeAttrs_line_sourceMarker:
      type: object
      properties:
        name:
          maxLength: 32
          type: string
          description: Marker type
          enum:
          - classic
          - block
          - diamond
          - circle
        size:
          minimum: 1
          type: number
          description: Marker size in pixels
      description: Source marker configuration
    EdgeAttrs_line:
      type: object
      properties:
        stroke:
          maxLength: 32
          type: string
          description: Line color
        strokeWidth:
          minimum: 0
          type: number
          description: Line width in pixels
        strokeDasharray:
          maxLength: 64
          type: string
          description: Dash pattern for the line
          nullable: true
        targetMarker:
          $ref: "#/components/schemas/EdgeAttrs_line_targetMarker"
        sourceMarker:
          $ref: "#/components/schemas/EdgeAttrs_line_sourceMarker"
      description: Line styling attributes
    EdgeLabel_attrs_text:
      type: object
      properties:
        text:
          maxLength: 256
          type: string
          description: Label text content
        fontSize:
          minimum: 1
          type: number
          description: Font size in pixels
        fill:
          maxLength: 32
          type: string
          description: Text color
        fontFamily:
          maxLength: 64
          type: string
          description: Font family
      description: Text styling
    EdgeLabel_attrs:
      type: object
      properties:
        text:
          $ref: "#/components/schemas/EdgeLabel_attrs_text"
      description: Label styling attributes
    PortConfiguration_groups:
      type: object
      properties:
        position:
          type: string
          description: Port position on the node
          enum:
          - top
          - right
          - bottom
          - left
    PortConfiguration_items:
      required:
      - group
      - id
      type: object
      properties:
        id:
          maxLength: 64
          type: string
          description: Unique port identifier
        group:
          maxLength: 32
          type: string
          description: Port group this port belongs to
    EdgeRouter_args:
      type: object
      properties:
        padding:
          type: number
          description: Padding around obstacles for routing
        step:
          type: number
          description: Grid step size for orthogonal routing
        directions:
          type: array
          description: Allowed routing directions
          items:
            type: string
            enum:
            - top
            - right
            - bottom
            - left
      additionalProperties: true
      description: Router-specific arguments
    EdgeConnector_args:
      type: object
      properties:
        radius:
          type: number
          description: Radius for rounded connectors
        precision:
          type: number
          description: Precision for smooth connectors
        size:
          type: number
          description: Jump size for jumpover connectors
        jump:
          type: string
          description: Jump style for jumpover connectors
          enum:
          - arc
          - gap
          - cubic
      additionalProperties: true
      description: Connector-specific arguments
    RepositoryBase_parameters:
      required:
      - refType
      - refValue
      type: object
      properties:
        refType:
          maxLength: 6
          type: string
          description: "Reference type (branch, tag, or commit)"
          enum:
          - branch
          - tag
          - commit
        refValue:
          maxLength: 256
          type: string
          description: "Reference value (branch name, tag value, or commit id)"
        subPath:
          maxLength: 256
          type: string
          description: Sub-path within the repository
      description: repo-specific parameters for retrieving the source
    inline_response_200_2_keys:
      required:
      - alg
      - kid
      - kty
      - use
      type: object
      properties:
        kty:
          type: string
          example: oct
        use:
          type: string
          example: sig
        alg:
          type: string
          example: HS256
        kid:
          type: string
          example: tmi-signing-key
      example:
        kty: oct
        use: sig
        kid: tmi-signing-key
        alg: HS256
    inline_response_200_4_providers:
      required:
      - auth_url
      - client_id
      - icon
      - id
      - name
      - redirect_uri
      - token_url
      type: object
      properties:
        id:
          type: string
          description: Provider identifier
        name:
          type: string
          description: Display name of the provider
        icon:
          type: string
          description: Icon identifier for the provider
        auth_url:
          type: string
          description: TMI authorization endpoint URL for this provider
          format: uri
        token_url:
          type: string
          description: TMI token exchange endpoint URL for this provider
          format: uri
        redirect_uri:
          type: string
          description: OAuth callback URI configured for this provider
          format: uri
        client_id:
          type: string
          description: OAuth client ID for this provider
      example:
        name: name
        icon: icon
        id: id
        auth_url: http://example.com/aeiou
        redirect_uri: http://example.com/aeiou
        token_url: http://example.com/aeiou
        client_id: client_id
    inline_response_200_5_groups:
      required:
      - name
      type: object
      properties:
        name:
          type: string
          description: Group name
        display_name:
          type: string
          description: Display name for the group
        used_in_authorizations:
          type: boolean
          description: Whether this group is used in any threat model authorizations
      example:
        used_in_authorizations: true
        name: name
        display_name: display_name
    inline_response_200_6_providers:
      type: object
      properties:
        provider:
          type: string
          description: OAuth provider name
        is_primary:
          type: boolean
          description: Whether this is the primary authentication method
      example:
        is_primary: true
        provider: provider
  responses:
    Error:
      description: Error response
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          examples:
            authorizationError:
              summary: Insufficient permissions for sub-resource access
              value:
                error: access_denied
                error_description: User does not have sufficient permissions to access
                  this sub-resource
                details:
                  required_role: writer
                  user_role: reader
                  threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                  resource_type: threat
            notFoundError:
              summary: Sub-resource not found
              value:
                error: not_found
                error_description: The requested sub-resource does not exist or does
                  not belong to the specified threat model
                details:
                  resource_id: 550e8400-e29b-41d4-a716-446655440999
                  resource_type: document
                  threat_model_id: 550e8400-e29b-41d4-a716-446655440000
            validationError:
              summary: Invalid input data
              value:
                error: invalid_input
                error_description: The provided data does not meet validation requirements
                details:
                  field_errors:
                  - field: name
                    message: Name is required and cannot be empty
                  - field: uri
                    message: "URI must be a valid RFC 3986 URI, e.g. an HTTPS URL"
  securitySchemes:
    bearerAuth:
      type: http
      description: JWT token for authenticated requests
      scheme: bearer
      bearerFormat: JWT
