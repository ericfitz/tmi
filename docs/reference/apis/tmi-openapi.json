{
  "openapi": "3.0.3",
  "info": {
    "title": "TMI (Threat Modeling Improved) API",
    "description": "A RESTful API for collaborative threat modeling with full X6 graph library compatibility. This API provides schemas that align with AntV X6 cell object models for seamless integration with modern diagramming libraries. Supports OAuth 2.0 authentication with client callback integration for seamless single-page application authentication flows.\n\n## API Design v1.0.0\n\n### Authorization Model\nTMI uses hierarchical authorization: access control is defined at the ThreatModel level via the authorization field (readers, writers, owners). All child resources (Assets, Diagrams, Documents, Notes, Repositories, Threats) inherit permissions from their parent ThreatModel. This simplifies permission management and ensures consistent access control.\n\n### Bulk Operations\nNotes and Diagrams do not support bulk operations due to their unique creation workflows and lack of valid bulk use cases. All other resources (Threats, Assets, Documents, Repositories) support full bulk operations: POST (create), PUT (upsert), PATCH (partial update), DELETE (batch delete).\n\nAll resources support bulk metadata operations regardless of resource-level bulk support.\n\n### List Response Strategy\n- ThreatModels return summary information (TMListItem) because they contain many child objects that can be large.\n- Diagrams return summary information (DiagramListItem) because diagram data (cells, images) can be large.\n- Notes return summary information (NoteListItem) because the content field can be large.\n- Threats, Assets, Documents, Repositories return full schemas as they are relatively small and static.\n\n### PATCH Support\nAll resources support PATCH for partial updates using JSON Patch (RFC 6902). This is particularly useful for:\n- Assets: Array field updates (affected_assets, trust_boundaries) ensuring no duplicates\n- Notes: Updating name/description without changing content field\n- All resources: Efficient updates without full object replacement\n",
    "version": "1.0.0"
  },
  "externalDocs": {
    "description": "Find more information here",
    "url": "https://github.com/ericfitz/tmi/wiki"
  },
  "servers": [
    {
      "description": "Local development server",
      "url": "http://localhost:8080"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "JWT token for authenticated requests"
      }
    },
    "schemas": {
      "ApiInfo": {
        "type": "object",
        "description": "API information response for the root endpoint",
        "properties": {
          "status": {
            "type": "object",
            "properties": {
              "code": {
                "type": "string",
                "enum": [
                  "OK",
                  "ERROR"
                ],
                "description": "Status code indicating if the API is functioning correctly",
                "pattern": "^[a-zA-Z0-9_-]*$",
                "maxLength": 512
              },
              "time": {
                "type": "string",
                "format": "date-time",
                "description": "Current server time in UTC, formatted as RFC 3339",
                "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
                "maxLength": 64
              }
            },
            "required": [
              "code",
              "time"
            ],
            "additionalProperties": false
          },
          "service": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Name of the service",
                "maxLength": 256,
                "pattern": "^[\\u0020-\\uFFFF]*$"
              },
              "build": {
                "type": "string",
                "description": "Current build number",
                "maxLength": 32,
                "pattern": "^[0-9]+\\\\.[0-9]+\\\\.[0-9]+(-[a-zA-Z0-9.]+)?(\\\\+[a-zA-Z0-9.]+)?$"
              }
            },
            "required": [
              "name",
              "build"
            ],
            "additionalProperties": false
          },
          "api": {
            "type": "object",
            "properties": {
              "version": {
                "type": "string",
                "description": "API version",
                "pattern": "^[0-9]+\\\\.[0-9]+\\\\.[0-9]+(-[a-zA-Z0-9.]+)?(\\\\+[a-zA-Z0-9.]+)?$",
                "maxLength": 32
              },
              "specification": {
                "type": "string",
                "format": "uri",
                "description": "URL to the API specification",
                "maxLength": 1000,
                "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
              }
            },
            "required": [
              "version",
              "specification"
            ],
            "additionalProperties": false
          },
          "operator": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Operator name from environment variables",
                "maxLength": 256,
                "pattern": "^[\\u0020-\\uFFFF]*$"
              },
              "contact": {
                "type": "string",
                "description": "Operator contact information from environment variables",
                "maxLength": 1024,
                "pattern": "^[\\u0020-\\uFFFF]*$"
              }
            },
            "required": [
              "name",
              "contact"
            ],
            "additionalProperties": false
          }
        },
        "required": [
          "status",
          "service",
          "api",
          "operator"
        ],
        "example": {
          "status": {
            "code": "OK",
            "time": "2025-04-09T12:00:00Z"
          },
          "service": {
            "name": "TMI",
            "build": "1.0.0-386eea0"
          },
          "api": {
            "version": "1.0",
            "specification": "https://github.com/ericfitz/tmi/blob/main/docs/reference/apis/tmi-openapi.json"
          },
          "operator": {
            "name": "Example Organization",
            "contact": "api-support@example.com"
          }
        },
        "additionalProperties": false
      },
      "OAuthProtectedResourceMetadata": {
        "type": "object",
        "description": "OAuth 2.0 protected resource metadata as defined in RFC 9728",
        "properties": {
          "resource": {
            "type": "string",
            "format": "uri",
            "description": "The protected resource's resource identifier URL",
            "example": "http://localhost:8080",
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
            "maxLength": 1000
          },
          "scopes_supported": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^[\\x21\\x23-\\x5B\\x5D-\\x7E]*$",
              "maxLength": 64,
              "description": "OAuth 2.0 scope token (RFC 6749 Section 3.3 - printable ASCII excluding whitespace and double-quote)"
            },
            "description": "JSON array of OAuth scope values supported by this protected resource",
            "example": [
              "openid",
              "email",
              "profile"
            ],
            "maxItems": 100
          },
          "authorization_servers": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uri",
              "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
              "maxLength": 1000
            },
            "description": "List of authorization server issuer identifiers that can issue tokens for this resource",
            "example": [
              "http://localhost:8080"
            ],
            "maxItems": 100
          },
          "jwks_url": {
            "type": "string",
            "format": "uri",
            "description": "URL of the protected resource's JSON Web Key Set",
            "example": "http://localhost:8080/.well-known/jwks.json",
            "pattern": "^(https?|wss?|file)://[^\\s]*$",
            "maxLength": 1024
          },
          "bearer_methods_supported": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "header",
                "body",
                "query"
              ],
              "description": "OAuth 2.0 bearer token transmission method (RFC 6750)",
              "maxLength": 1000
            },
            "description": "Supported token presentation methods for bearer tokens",
            "example": [
              "header",
              "body",
              "query"
            ],
            "maxItems": 100
          },
          "resource_name": {
            "type": "string",
            "description": "Human-readable name of the protected resource",
            "example": "TMI (Threat Modeling Improved) API",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "resource_documentation": {
            "type": "string",
            "format": "uri",
            "description": "URL with information for developers on how to use this protected resource",
            "example": "https://github.com/ericfitz/tmi",
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
            "maxLength": 1000
          },
          "tls_client_certificate_bound_access_tokens": {
            "type": "boolean",
            "description": "Whether the protected resource supports TLS client certificate bound access tokens",
            "example": false
          }
        },
        "required": [
          "resource"
        ],
        "example": {
          "resource": "http://localhost:8080",
          "scopes_supported": [
            "openid",
            "email",
            "profile"
          ],
          "authorization_servers": [
            "http://localhost:8080"
          ],
          "jwks_url": "http://localhost:8080/.well-known/jwks.json",
          "bearer_methods_supported": [
            "header"
          ],
          "resource_name": "TMI (Threat Modeling Improved) API",
          "resource_documentation": "https://github.com/ericfitz/tmi",
          "tls_client_certificate_bound_access_tokens": false
        },
        "additionalProperties": false
      },
      "Document": {
        "description": "Complete Document schema with server-generated fields",
        "allOf": [
          {
            "$ref": "#/components/schemas/DocumentBase"
          },
          {
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the document",
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                "maxLength": 36
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "readOnly": true,
                "maxItems": 100
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 24,
                "description": "Creation timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 24,
                "description": "Last modification timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            },
            "additionalProperties": false
          }
        ]
      },
      "BaseDiagram": {
        "type": "object",
        "description": "Base diagram object with common properties - used for API responses",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the diagram (UUID)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "name": {
            "type": "string",
            "description": "Name of the diagram",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "minLength": 1
          },
          "type": {
            "type": "string",
            "description": "Type of diagram with version",
            "enum": [
              "DFD-1.0.0"
            ],
            "maxLength": 64
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp (ISO3339)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp (ISO3339)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional diagram metadata",
            "nullable": true,
            "maxItems": 10000
          },
          "update_vector": {
            "type": "integer",
            "format": "int64",
            "description": "Server-managed monotonic version counter, incremented on each diagram update",
            "readOnly": true,
            "minimum": 0
          },
          "image": {
            "type": "object",
            "description": "Image data with version information",
            "properties": {
              "svg": {
                "type": "string",
                "format": "byte",
                "description": "BASE64 encoded SVG representation of the diagram, used for thumbnails and reports",
                "pattern": "^[A-Za-z0-9+/]*=*$",
                "maxLength": 102400
              },
              "update_vector": {
                "type": "integer",
                "format": "int64",
                "description": "Version of the diagram when this SVG was generated. If not provided when svg is updated, will be auto-set to BaseDiagram.update_vector",
                "minimum": 0
              }
            },
            "nullable": true,
            "additionalProperties": false
          },
          "description": {
            "type": "string",
            "maxLength": 1024,
            "nullable": true,
            "description": "Optional description of the diagram",
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          }
        },
        "required": [
          "id",
          "name",
          "type",
          "created_at",
          "modified_at"
        ],
        "discriminator": {
          "propertyName": "type",
          "mapping": {
            "DFD-1.0.0": "#/components/schemas/DfdDiagram"
          }
        },
        "additionalProperties": false
      },
      "BaseDiagramInput": {
        "type": "object",
        "description": "Base diagram input for PUT/PATCH requests - excludes readOnly server-managed fields",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the diagram",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "minLength": 1
          },
          "type": {
            "type": "string",
            "description": "Type of diagram with version",
            "enum": [
              "DFD-1.0.0"
            ],
            "maxLength": 64
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional diagram metadata",
            "nullable": true,
            "maxItems": 10000
          },
          "image": {
            "type": "object",
            "description": "Image data with version information",
            "properties": {
              "svg": {
                "type": "string",
                "format": "byte",
                "description": "BASE64 encoded SVG representation of the diagram, used for thumbnails and reports",
                "pattern": "^[A-Za-z0-9+/]*=*$",
                "maxLength": 102400
              },
              "update_vector": {
                "type": "integer",
                "format": "int64",
                "description": "Version of the diagram when this SVG was generated. If not provided when svg is updated, will be auto-set to BaseDiagram.update_vector",
                "minimum": 0
              }
            },
            "nullable": true,
            "additionalProperties": false
          },
          "description": {
            "type": "string",
            "maxLength": 1024,
            "nullable": true,
            "description": "Optional description of the diagram",
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          }
        },
        "required": [
          "name",
          "type"
        ],
        "discriminator": {
          "propertyName": "type",
          "mapping": {
            "DFD-1.0.0": "#/components/schemas/DfdDiagramInput"
          }
        },
        "additionalProperties": false
      },
      "DfdDiagram": {
        "x-discriminator-value": "DFD-1.0.0",
        "allOf": [
          {
            "$ref": "#/components/schemas/BaseDiagram"
          },
          {
            "type": "object",
            "description": "Data Flow Diagram (DFD) with cells - API response schema",
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "DFD-1.0.0"
                ],
                "description": "DFD diagram type with version",
                "maxLength": 1000
              },
              "cells": {
                "type": "array",
                "items": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/Node"
                    },
                    {
                      "$ref": "#/components/schemas/Edge"
                    }
                  ],
                  "discriminator": {
                    "propertyName": "shape",
                    "mapping": {
                      "actor": "#/components/schemas/Node",
                      "process": "#/components/schemas/Node",
                      "store": "#/components/schemas/Node",
                      "security-boundary": "#/components/schemas/Node",
                      "text-box": "#/components/schemas/Node",
                      "edge": "#/components/schemas/Edge"
                    }
                  }
                },
                "description": "List of diagram cells (nodes and edges) following X6 structure",
                "maxItems": 10000
              }
            },
            "required": [
              "cells"
            ],
            "additionalProperties": false
          }
        ]
      },
      "DfdDiagramInput": {
        "x-discriminator-value": "DFD-1.0.0",
        "allOf": [
          {
            "$ref": "#/components/schemas/BaseDiagramInput"
          },
          {
            "type": "object",
            "description": "Data Flow Diagram (DFD) input for PUT requests - excludes readOnly fields",
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "DFD-1.0.0"
                ],
                "description": "DFD diagram type with version",
                "maxLength": 1000
              },
              "cells": {
                "type": "array",
                "items": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/Node"
                    },
                    {
                      "$ref": "#/components/schemas/Edge"
                    }
                  ],
                  "discriminator": {
                    "propertyName": "shape",
                    "mapping": {
                      "actor": "#/components/schemas/Node",
                      "process": "#/components/schemas/Node",
                      "store": "#/components/schemas/Node",
                      "security-boundary": "#/components/schemas/Node",
                      "text-box": "#/components/schemas/Node",
                      "edge": "#/components/schemas/Edge"
                    }
                  }
                },
                "description": "List of diagram cells (nodes and edges) following X6 structure",
                "maxItems": 10000
              }
            },
            "required": [
              "cells"
            ],
            "additionalProperties": false
          }
        ]
      },
      "CreateDiagramRequest": {
        "type": "object",
        "description": "Request body for creating a new diagram - only includes client-provided fields",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the diagram",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "type": {
            "type": "string",
            "description": "Type of diagram with version",
            "enum": [
              "DFD-1.0.0"
            ],
            "maxLength": 64
          }
        },
        "required": [
          "name",
          "type"
        ],
        "additionalProperties": false
      },
      "Diagram": {
        "deprecated": true,
        "description": "DEPRECATED: Empty wrapper schema for polymorphic diagram types. Use DfdDiagram directly instead. This schema is kept for backward compatibility but generates empty classes in client libraries.",
        "oneOf": [
          {
            "$ref": "#/components/schemas/DfdDiagram"
          }
        ],
        "discriminator": {
          "propertyName": "type",
          "mapping": {
            "DFD-1.0.0": "#/components/schemas/DfdDiagram"
          }
        },
        "example": {
          "id": "359314D9-B6A3-460B-805F-B82190D7290F",
          "type": "DFD-1.0.0",
          "name": "Workflow Diagram",
          "description": "A process workflow",
          "created_at": "2025-04-06T12:00:00Z",
          "modified_at": "2025-04-06T12:30:00Z",
          "metadata": [],
          "cells": [
            {
              "id": "233598D2-8C6D-4A73-AFE1-647081C4F7AA",
              "shape": "process",
              "x": 100,
              "y": 100,
              "width": 120,
              "height": 60,
              "zIndex": 10,
              "visible": true,
              "attrs": {
                "body": {
                  "fill": "#ffffff",
                  "stroke": "#000000",
                  "strokeWidth": 2
                },
                "text": {
                  "text": "Process Data",
                  "fontSize": 14,
                  "fill": "#000000"
                }
              },
              "ports": {
                "groups": {
                  "in": {
                    "position": "left"
                  },
                  "out": {
                    "position": "right"
                  }
                },
                "items": [
                  {
                    "id": "port_in_1",
                    "group": "in"
                  },
                  {
                    "id": "port_out_1",
                    "group": "out"
                  }
                ]
              },
              "data": []
            },
            {
              "id": "456789AB-CD12-34EF-56GH-789012345678",
              "shape": "edge",
              "source": {
                "cell": "233598D2-8C6D-4A73-AFE1-647081C4F7AA",
                "port": "port_out_1"
              },
              "target": {
                "cell": "789ABC12-3456-78DE-F012-3456789ABCDE"
              },
              "zIndex": 1,
              "visible": true,
              "attrs": {
                "line": {
                  "stroke": "#808080",
                  "strokeWidth": 1,
                  "targetMarker": {
                    "name": "classic",
                    "size": 8
                  }
                }
              },
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Data Flow",
                      "fontSize": 12,
                      "fill": "#333333"
                    }
                  },
                  "position": 0.5
                }
              ],
              "vertices": [],
              "data": []
            }
          ]
        }
      },
      "Cell": {
        "type": "object",
        "description": "Base schema for all diagram cells (nodes and edges) in AntV X6 native format. This schema matches X6's toJSON() output exactly, enabling zero-transformation persistence. X6-specific properties like markup, tools, router, and connector are fully supported.",
        "discriminator": {
          "propertyName": "shape"
        },
        "required": [
          "id",
          "shape"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier of the cell (UUID)",
            "format": "uuid",
            "example": "37EAEDFA-BF37-4996-8665-242FEC34BBFF",
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "shape": {
            "type": "string",
            "description": "Shape type identifier that determines cell structure and behavior",
            "example": "process",
            "pattern": "^[a-z][a-z0-9-]*$",
            "maxLength": 64
          },
          "zIndex": {
            "type": "number",
            "description": "Z-order layer for rendering (higher values render on top)",
            "default": 1,
            "minimum": 0
          },
          "visible": {
            "type": "boolean",
            "description": "Whether the cell is visible in the diagram",
            "default": true
          },
          "data": {
            "type": "object",
            "description": "Flexible data storage compatible with X6, with reserved metadata namespace",
            "properties": {
              "_metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Reserved namespace for structured business metadata",
                "maxItems": 100
              }
            },
            "additionalProperties": true,
            "default": {
              "_metadata": []
            }
          },
          "markup": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MarkupElement"
            },
            "description": "SVG/HTML markup definition for custom shape rendering in X6",
            "maxItems": 1000
          }
        },
        "additionalProperties": false
      },
      "Node": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Cell"
          },
          {
            "type": "object",
            "description": "A diagram node representing an entity, process, store, or boundary. Supports both X6 position/size object format and flat x/y/width/height format. Input accepts either format. Output always uses flat format (x, y, width, height).",
            "required": [],
            "properties": {
              "shape": {
                "type": "string",
                "enum": [
                  "actor",
                  "process",
                  "store",
                  "security-boundary",
                  "text-box"
                ],
                "description": "Node type determining its visual representation and behavior",
                "maxLength": 1000
              },
              "position": {
                "type": "object",
                "description": "Node position in X6 nested format. Use either this with size object OR use flat x/y/width/height properties.",
                "properties": {
                  "x": {
                    "type": "number",
                    "description": "X coordinate"
                  },
                  "y": {
                    "type": "number",
                    "description": "Y coordinate"
                  }
                },
                "required": [
                  "x",
                  "y"
                ],
                "additionalProperties": false
              },
              "size": {
                "type": "object",
                "description": "Node size in X6 nested format. Use either this with position object OR use flat x/y/width/height properties.",
                "properties": {
                  "width": {
                    "type": "number",
                    "description": "Width in pixels",
                    "minimum": 40
                  },
                  "height": {
                    "type": "number",
                    "description": "Height in pixels",
                    "minimum": 30
                  }
                },
                "required": [
                  "width",
                  "height"
                ],
                "additionalProperties": false
              },
              "angle": {
                "type": "number",
                "description": "Rotation angle in degrees",
                "default": 0
              },
              "attrs": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/NodeAttrs"
                  }
                ],
                "description": "Visual styling attributes for the node"
              },
              "ports": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/PortConfiguration"
                  }
                ],
                "description": "Port configuration for connections"
              },
              "parent": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the parent cell for nested/grouped nodes (UUID)",
                "nullable": true,
                "maxLength": 36,
                "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
              },
              "x": {
                "type": "number",
                "description": "X coordinate (flat format). Use either this with y, width, height OR use position/size objects."
              },
              "y": {
                "type": "number",
                "description": "Y coordinate (flat format)"
              },
              "width": {
                "type": "number",
                "description": "Width in pixels (flat format)",
                "minimum": 40
              },
              "height": {
                "type": "number",
                "description": "Height in pixels (flat format)",
                "minimum": 30
              }
            },
            "example": {
              "id": "233598D2-8C6D-4A73-AFE1-647081C4F7AA",
              "shape": "process",
              "x": 100,
              "y": 100,
              "width": 120,
              "height": 60,
              "zIndex": 10,
              "visible": true,
              "attrs": {
                "body": {
                  "fill": "#ffffff",
                  "stroke": "#000000",
                  "strokeWidth": 2
                },
                "text": {
                  "text": "Process Data",
                  "fontSize": 14,
                  "fill": "#000000"
                }
              }
            },
            "additionalProperties": false
          }
        ]
      },
      "Edge": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Cell"
          },
          {
            "type": "object",
            "description": "A diagram edge representing a connection or data flow between nodes. Fully compatible with X6 Edge objects and supports X6 routing algorithms (manhattan, orth, oneSide, metro, er), connector styles (normal, rounded, smooth, jumpover), custom markup, tools, and convenience properties (label, style) for easier integration.",
            "required": [
              "source",
              "target"
            ],
            "properties": {
              "shape": {
                "type": "string",
                "enum": [
                  "edge"
                ],
                "description": "Edge type identifier",
                "maxLength": 1000
              },
              "source": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeTerminal"
                  }
                ],
                "description": "Source connection point"
              },
              "target": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeTerminal"
                  }
                ],
                "description": "Target connection point"
              },
              "attrs": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeAttrs"
                  }
                ],
                "description": "Visual styling attributes for the edge"
              },
              "labels": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/EdgeLabel"
                },
                "description": "Text labels positioned along the edge",
                "maxItems": 1000
              },
              "vertices": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Point"
                },
                "description": "Intermediate waypoints for edge routing",
                "maxItems": 1000
              },
              "router": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeRouter"
                  }
                ],
                "description": "Edge routing algorithm configuration for path calculation"
              },
              "connector": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeConnector"
                  }
                ],
                "description": "Edge connector style configuration for visual appearance"
              },
              "defaultLabel": {
                "allOf": [
                  {
                    "$ref": "#/components/schemas/EdgeLabel"
                  }
                ],
                "description": "Default label configuration applied to edges without explicit labels"
              }
            },
            "example": {
              "id": "456789AB-CD12-34EF-56GH-789012345678",
              "shape": "edge",
              "source": {
                "cell": "233598D2-8C6D-4A73-AFE1-647081C4F7AA",
                "port": "port_out_1"
              },
              "target": {
                "cell": "789ABC12-3456-78DE-F012-3456789ABCDE"
              },
              "zIndex": 1,
              "visible": true,
              "attrs": {
                "line": {
                  "stroke": "#808080",
                  "strokeWidth": 1,
                  "targetMarker": {
                    "name": "classic",
                    "size": 8
                  }
                }
              },
              "labels": [
                {
                  "attrs": {
                    "text": {
                      "text": "Data Flow",
                      "fontSize": 12,
                      "fill": "#333333"
                    }
                  },
                  "position": 0.5
                }
              ],
              "vertices": [],
              "data": {
                "_metadata": [
                  {
                    "key": "flow-type",
                    "value": "data"
                  },
                  {
                    "key": "sensitivity",
                    "value": "public"
                  }
                ],
                "routingHints": {
                  "preferredPath": "shortest",
                  "avoidOverlap": true
                }
              },
              "router": {
                "name": "manhattan",
                "args": {
                  "step": 10,
                  "padding": 20
                }
              },
              "connector": {
                "name": "rounded",
                "args": {
                  "radius": 5
                }
              }
            },
            "additionalProperties": false
          }
        ]
      },
      "ThreatModel": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ThreatModelBase"
          },
          {
            "type": "object",
            "description": "Complete ThreatModel with server-generated fields",
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the threat model (UUID)",
                "maxLength": 36,
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp (RFC3339)",
                "maxLength": 24,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last modification timestamp (RFC3339)",
                "maxLength": 24,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "created_by": {
                "type": "string",
                "description": "User name, email or identifier of the creator of the threat model",
                "maxLength": 256,
                "pattern": "^[^<>\"'&]*$",
                "readOnly": true
              },
              "documents": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Document"
                },
                "description": "List of documents related to the threat model",
                "readOnly": true,
                "maxItems": 1000
              },
              "repositories": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Repository"
                },
                "description": "List of source code repositories related to the threat model",
                "readOnly": true,
                "maxItems": 1000
              },
              "diagrams": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Diagram"
                },
                "description": "List of diagram objects associated with this threat model",
                "readOnly": true,
                "maxItems": 10000
              },
              "threats": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Threat"
                },
                "description": "List of threats within the threat model",
                "readOnly": true,
                "maxItems": 1000
              },
              "notes": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Note"
                },
                "description": "List of notes associated with the threat model",
                "readOnly": true,
                "maxItems": 1000
              },
              "assets": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ExtendedAsset"
                },
                "description": "List of assets associated with the threat model",
                "readOnly": true,
                "maxItems": 1000
              },
              "status_updated": {
                "type": "string",
                "format": "date-time",
                "nullable": true,
                "description": "Timestamp when the status field was last modified (RFC3339). Automatically updated by the server when status changes.",
                "maxLength": 24,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            },
            "additionalProperties": false
          }
        ],
        "example": {
          "id": "F898D276-DE86-4837-9B5E-C46E1A08EAB6",
          "name": "System Threat Model",
          "description": "Threats for system X",
          "created_at": "2025-04-06T12:00:00Z",
          "modified_at": "2025-04-06T12:00:00Z",
          "owner": "user@example.com",
          "created_by": "user@example.com",
          "threat_model_framework": "STRIDE",
          "authorization": [
            {
              "subject": "user@example.com",
              "subject_type": "user",
              "role": "owner"
            },
            {
              "subject": "security-team",
              "subject_type": "group",
              "idp": "saml_okta",
              "role": "writer"
            }
          ],
          "metadata": [],
          "documents": [
            {
              "id": "3ba7b810-9dad-11d1-beef-00c04fd430c8",
              "name": "System Architecture Document",
              "description": "Technical architecture documentation for the system",
              "metadata": [
                {
                  "key": "document_type",
                  "value": "architecture"
                },
                {
                  "key": "version",
                  "value": "2.1"
                }
              ],
              "uri": "https://docs.example.com/system-architecture.pdf"
            }
          ],
          "repositories": [
            {
              "id": "6ba7b810-1dad-11d1-8080-00c04fd430c8",
              "name": "GitHub Repo",
              "description": "Source code for the tmi-ux application",
              "type": "git",
              "parameters": {
                "refType": "branch",
                "refValue": "main"
              },
              "metadata": [
                {
                  "key": "environment",
                  "value": "production"
                },
                {
                  "key": "team",
                  "value": "security"
                }
              ],
              "uri": "https://github.com/ericfitz/tmi-ux.git"
            }
          ],
          "diagrams": [
            {
              "id": "22DB9004-435D-4765-9E41-0291AA8FE15A",
              "type": "DFD-1.0.0",
              "name": "System Overview Diagram",
              "description": "Main system data flow diagram",
              "created_at": "2025-04-06T12:00:00Z",
              "modified_at": "2025-04-06T12:30:00Z",
              "metadata": [],
              "cells": []
            }
          ],
          "threats": [
            {
              "id": "EC464A19-D1CA-4B72-AD8D-055AD2073C2B",
              "threat_model_id": "B7946A3A-5581-42C6-91BF-F41A1E1DD535",
              "name": "Data Breach",
              "description": "Unauthorized data access",
              "mitigation": "Recommendation: implement least privilege authorization policy",
              "created_at": "2025-04-06T12:01:00Z",
              "modified_at": "2025-04-06T12:01:00Z",
              "diagram_id": "",
              "cell_id": "",
              "severity": "High",
              "score": 7.5,
              "priority": "High",
              "mitigated": false,
              "status": "Open",
              "threat_type": "Information Disclosure",
              "metadata": [],
              "issue_uri": "https://issues.example.com/browse/SEC-456"
            }
          ],
          "issue_uri": "https://issues.example.com/browse/TM-123",
          "notes": [
            {
              "id": "6ba7b810-9dad-11d1-beef-00c04fd430c8",
              "name": "Security Considerations",
              "content": "# Security Notes\n\n- Consider authentication requirements\n- Review encryption needs",
              "description": "Important security considerations for the threat model",
              "metadata": [
                {
                  "key": "priority",
                  "value": "high"
                }
              ]
            }
          ],
          "assets": [
            {
              "id": "7ba7b810-9dad-11d1-beef-00c04fd430c9",
              "name": "Customer Database",
              "description": "Primary database containing customer information",
              "type": "data",
              "criticality": "high",
              "classification": [
                "confidential",
                "regulated"
              ],
              "sensitivity": [
                "pii",
                "financial"
              ],
              "threat_model_id": "F898D276-DE86-4837-9B5E-C46E1A08EAB6",
              "created_at": "2025-04-06T12:00:00Z",
              "modified_at": "2025-04-06T12:00:00Z",
              "metadata": [
                {
                  "key": "data_retention",
                  "value": "7_years"
                }
              ]
            }
          ],
          "status": [
            "In progress",
            "Review"
          ],
          "status_updated": "2025-04-08T14:30:00Z"
        }
      },
      "Threat": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ThreatBase"
          },
          {
            "type": "object",
            "description": "Complete Threat with server-generated fields",
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the threat (UUID)",
                "maxLength": 36,
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
              },
              "threat_model_id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier of the parent threat model (UUID)",
                "maxLength": 36,
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp (RFC3339)",
                "maxLength": 24,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last modification timestamp (RFC3339)",
                "maxLength": 24,
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            },
            "additionalProperties": false
          }
        ]
      },
      "Authorization": {
        "type": "object",
        "description": "Authorization entry defining access permissions for users or groups",
        "properties": {
          "subject": {
            "type": "string",
            "description": "Email address or user id for users, group name for groups",
            "minLength": 1,
            "maxLength": 500,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "subject_type": {
            "type": "string",
            "enum": [
              "user",
              "group"
            ],
            "description": "Type of authorization subject: user (individual) or group",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            },
            "maxLength": 1000
          },
          "idp": {
            "type": "string",
            "description": "Identity provider (required for groups, optional for users)",
            "maxLength": 100,
            "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$"
          },
          "role": {
            "type": "string",
            "enum": [
              "reader",
              "writer",
              "owner"
            ],
            "description": "Role: reader (view), writer (edit), owner (full control)",
            "maxLength": 6,
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          }
        },
        "required": [
          "subject",
          "subject_type",
          "role"
        ],
        "additionalProperties": false
      },
      "Metadata": {
        "type": "object",
        "description": "A key-value pair for extensible metadata",
        "properties": {
          "key": {
            "type": "string",
            "description": "Metadata key",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[a-zA-Z0-9_./:-]+$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "value": {
            "type": "string",
            "description": "Metadata value",
            "minLength": 1,
            "maxLength": 1024,
            "pattern": "^[^<>]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          }
        },
        "required": [
          "key",
          "value"
        ],
        "additionalProperties": false
      },
      "Error": {
        "type": "object",
        "description": "Standard error response format",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error code",
            "pattern": "^[\\u0020-\\uFFFF]*$",
            "maxLength": 1000
          },
          "error_description": {
            "type": "string",
            "description": "Human-readable error description",
            "pattern": "^[\\u0020-\\uFFFF]*$",
            "maxLength": 1000
          },
          "error_uri": {
            "type": "string",
            "format": "uri",
            "description": "URI to documentation about the error",
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
            "maxLength": 1000
          },
          "details": {
            "type": "object",
            "description": "Additional context-specific error information",
            "properties": {
              "code": {
                "type": "string",
                "description": "Machine-readable error code for programmatic handling",
                "example": "COLLABORATION_SESSION_NOT_FOUND",
                "pattern": "^[a-zA-Z0-9_-]*$",
                "maxLength": 512
              },
              "context": {
                "type": "object",
                "description": "Contextual information about the error",
                "additionalProperties": true,
                "example": {
                  "diagram_id": "550e8400-e29b-41d4-a716-446655440000",
                  "requested_operation": "end_session"
                }
              },
              "suggestion": {
                "type": "string",
                "description": "Human-readable suggestion for resolving the error",
                "example": "Start a collaboration session first using POST /diagrams/{id}/collaborate",
                "pattern": "^[\\u0020-\\uFFFF]*$",
                "maxLength": 1000
              }
            },
            "additionalProperties": false,
            "nullable": true
          }
        },
        "required": [
          "error",
          "error_description"
        ],
        "example": {
          "error": "invalid_request",
          "error_description": "The request is missing a required parameter",
          "error_uri": "https://docs.example.com/oauth2/errors/invalid_request"
        },
        "additionalProperties": false
      },
      "AuthTokenResponse": {
        "type": "object",
        "description": "JWT token response for authentication endpoints",
        "properties": {
          "access_token": {
            "type": "string",
            "description": "JWT access token",
            "pattern": "^[a-zA-Z0-9_.-]*$",
            "maxLength": 4096
          },
          "refresh_token": {
            "type": "string",
            "description": "Refresh token for obtaining new access tokens",
            "pattern": "^[a-zA-Z0-9_.-]*$",
            "maxLength": 1024
          },
          "token_type": {
            "type": "string",
            "enum": [
              "Bearer"
            ],
            "description": "Token type",
            "maxLength": 1000
          },
          "expires_in": {
            "type": "integer",
            "description": "Access token expiration time in seconds"
          }
        },
        "required": [
          "access_token",
          "refresh_token",
          "token_type",
          "expires_in"
        ],
        "example": {
          "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
          "refresh_token": "def456...",
          "token_type": "Bearer",
          "expires_in": 3600
        },
        "additionalProperties": false
      },
      "CollaborationSession": {
        "type": "object",
        "description": "Details of an active collaboration session for a diagram",
        "properties": {
          "session_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the session (UUID)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "host": {
            "type": "string",
            "description": "Email address of the session host",
            "maxLength": 256,
            "readOnly": true,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "presenter": {
            "type": "string",
            "description": "Email address of the current presenter",
            "maxLength": 256,
            "readOnly": true,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the associated threat model (UUID)",
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "threat_model_name": {
            "type": "string",
            "description": "Name of the associated threat model",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "diagram_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the associated diagram (UUID)",
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "diagram_name": {
            "type": "string",
            "description": "Name of the associated diagram",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "participants": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Participant"
            },
            "description": "List of active participants",
            "maxItems": 1000
          },
          "websocket_url": {
            "type": "string",
            "description": "WebSocket URL for real-time updates",
            "maxLength": 1024,
            "pattern": "^(https?|wss?|file)://[^\\s]*$"
          }
        },
        "required": [
          "session_id",
          "host",
          "threat_model_id",
          "threat_model_name",
          "diagram_id",
          "diagram_name",
          "participants",
          "websocket_url"
        ],
        "example": {
          "session_id": "D7744D3A-ED22-40AF-862B-29786CAD0007",
          "host": "admin@example.com",
          "threat_model_id": "5311D207-AFD5-4A1A-BA83-14C1445DC257",
          "threat_model_name": "E-commerce Platform Security Analysis",
          "diagram_id": "DFF7F4A9-CBCE-4001-9198-2706C86F7EF3",
          "diagram_name": "User Authentication Flow",
          "participants": [
            {
              "user": {
                "user_id": "oauth2|test|user123",
                "email": "admin@example.com",
                "name": "Admin User"
              },
              "last_activity": "2025-04-06T12:02:00Z",
              "permissions": "writer"
            }
          ],
          "websocket_url": "wss://api.example.com/threat_models/5311D207-AFD5-4A1A-BA83-14C1445DC257/diagrams/DFF7F4A9-CBCE-4001-9198-2706C86F7EF3/ws"
        },
        "additionalProperties": false
      },
      "DiagramListItem": {
        "type": "object",
        "description": "Summary diagram object for GET /diagrams list endpoints. Excludes large fields (cells, image) for performance. Full diagram details available via GET /diagrams/{id} which returns DfdDiagram.",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the diagram (UUID)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "name": {
            "type": "string",
            "description": "Name of the diagram",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "type": {
            "type": "string",
            "enum": [
              "DFD-1.0.0"
            ],
            "description": "Type of the diagram",
            "maxLength": 1000
          }
        },
        "required": [
          "id",
          "name",
          "type"
        ],
        "additionalProperties": false
      },
      "TMListItem": {
        "type": "object",
        "description": "Enhanced item for threat model list endpoints with key metadata and counts",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the threat model (UUID)",
            "maxLength": 36,
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "name": {
            "type": "string",
            "description": "Name of the threat model",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "minLength": 1
          },
          "description": {
            "type": "string",
            "description": "Description of the threat model",
            "maxLength": 1024,
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp (RFC3339)",
            "maxLength": 24,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp (RFC3339)",
            "maxLength": 24,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "owner": {
            "type": "string",
            "description": "Email address of the current owner",
            "pattern": "^[\\u0020-\\uFFFF]*$",
            "maxLength": 1000
          },
          "created_by": {
            "type": "string",
            "description": "Email address, name or identifier of the creator",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "threat_model_framework": {
            "type": "string",
            "description": "The framework used for this threat model",
            "pattern": "^[A-Za-z0-9_-]*$",
            "maxLength": 30
          },
          "document_count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of documents associated with this threat model"
          },
          "repo_count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of source code repository entries associated with this threat model"
          },
          "diagram_count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of diagrams associated with this threat model"
          },
          "threat_count": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of threats defined in this threat model"
          },
          "issue_uri": {
            "type": "string",
            "format": "uri",
            "description": "URL to an issue in an issue tracking system",
            "maxLength": 1000,
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          },
          "asset_count": {
            "type": "integer",
            "description": "Number of assets associated with this threat model",
            "minimum": 0
          },
          "note_count": {
            "type": "integer",
            "description": "Number of notes associated with this threat model",
            "minimum": 0
          },
          "status": {
            "type": "string",
            "nullable": true,
            "description": "Status of the threat model in the organization's threat modeling or SDLC process. Examples: \"Not started\", \"In progress\", \"Review\", \"Approved\", \"Closed\"",
            "maxLength": 128,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "status_updated": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Timestamp when the status field was last modified (RFC3339). Automatically updated by the server when status changes.",
            "maxLength": 24,
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          }
        },
        "required": [
          "id",
          "name",
          "created_at",
          "modified_at",
          "owner",
          "created_by",
          "threat_model_framework",
          "document_count",
          "repo_count",
          "diagram_count",
          "threat_count",
          "asset_count",
          "note_count"
        ],
        "additionalProperties": false
      },
      "Point": {
        "type": "object",
        "description": "A 2D point with x and y coordinates",
        "required": [
          "x",
          "y"
        ],
        "properties": {
          "x": {
            "type": "number",
            "description": "X coordinate"
          },
          "y": {
            "type": "number",
            "description": "Y coordinate"
          }
        },
        "example": {
          "x": 100,
          "y": 200
        },
        "additionalProperties": false
      },
      "EdgeTerminal": {
        "type": "object",
        "description": "Connection point for an edge (source or target)",
        "required": [
          "cell"
        ],
        "properties": {
          "cell": {
            "type": "string",
            "format": "uuid",
            "description": "ID of the connected node (UUID)",
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "port": {
            "type": "string",
            "description": "ID of the specific port on the node (optional)",
            "nullable": true,
            "maxLength": 64,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          }
        },
        "example": {
          "cell": "233598D2-8C6D-4A73-AFE1-647081C4F7AA",
          "port": "port_out_1"
        },
        "additionalProperties": false
      },
      "NodeAttrs": {
        "type": "object",
        "description": "Visual attributes for a node",
        "properties": {
          "body": {
            "type": "object",
            "description": "Body/shape styling attributes",
            "properties": {
              "fill": {
                "type": "string",
                "description": "Fill color",
                "maxLength": 32,
                "pattern": "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
              },
              "stroke": {
                "type": "string",
                "description": "Stroke color",
                "maxLength": 32,
                "pattern": "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
              },
              "strokeWidth": {
                "type": "number",
                "description": "Stroke width in pixels",
                "minimum": 0
              },
              "strokeDasharray": {
                "type": "string",
                "description": "Dash pattern for strokes",
                "nullable": true,
                "maxLength": 64,
                "pattern": "^[0-9]+(\\\\.[0-9]+)?(,[0-9]+(\\\\.[0-9]+)?)*$"
              }
            },
            "additionalProperties": false
          },
          "text": {
            "type": "object",
            "description": "Text/label styling attributes",
            "properties": {
              "text": {
                "type": "string",
                "description": "Label text content",
                "maxLength": 256,
                "pattern": "^[\\u0020-\\uFFFF]*$"
              },
              "fontSize": {
                "type": "number",
                "description": "Font size in pixels",
                "minimum": 1
              },
              "fill": {
                "type": "string",
                "description": "Text color",
                "maxLength": 32,
                "pattern": "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
              },
              "fontFamily": {
                "type": "string",
                "description": "Font family",
                "maxLength": 64,
                "pattern": "^[a-zA-Z0-9 ,'-]*$"
              }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      },
      "EdgeAttrs": {
        "type": "object",
        "description": "Visual attributes for an edge",
        "properties": {
          "line": {
            "type": "object",
            "description": "Line styling attributes",
            "properties": {
              "stroke": {
                "type": "string",
                "description": "Line color",
                "maxLength": 32,
                "pattern": "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
              },
              "strokeWidth": {
                "type": "number",
                "description": "Line width in pixels",
                "minimum": 0
              },
              "strokeDasharray": {
                "type": "string",
                "description": "Dash pattern for the line",
                "nullable": true,
                "maxLength": 64,
                "pattern": "^[0-9]+(\\\\.[0-9]+)?(,[0-9]+(\\\\.[0-9]+)?)*$"
              },
              "targetMarker": {
                "type": "object",
                "description": "Arrowhead marker configuration",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Marker type",
                    "enum": [
                      "classic",
                      "block",
                      "diamond",
                      "circle"
                    ],
                    "maxLength": 32,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  },
                  "size": {
                    "type": "number",
                    "description": "Marker size in pixels",
                    "minimum": 1
                  }
                },
                "additionalProperties": false
              },
              "sourceMarker": {
                "type": "object",
                "description": "Source marker configuration",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Marker type",
                    "enum": [
                      "classic",
                      "block",
                      "diamond",
                      "circle"
                    ],
                    "maxLength": 32,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  },
                  "size": {
                    "type": "number",
                    "description": "Marker size in pixels",
                    "minimum": 1
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      },
      "EdgeLabel": {
        "type": "object",
        "description": "Label positioned along an edge",
        "properties": {
          "attrs": {
            "type": "object",
            "description": "Label styling attributes",
            "properties": {
              "text": {
                "type": "object",
                "description": "Text styling",
                "properties": {
                  "text": {
                    "type": "string",
                    "description": "Label text content",
                    "maxLength": 256,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  },
                  "fontSize": {
                    "type": "number",
                    "description": "Font size in pixels",
                    "minimum": 1
                  },
                  "fill": {
                    "type": "string",
                    "description": "Text color",
                    "maxLength": 32,
                    "pattern": "^(#[0-9a-fA-F]*|#[0-9a-fA-F]*|rgb\\([0-9]*,[0-9]*,[0-9]*\\)|[a-z]+)$"
                  },
                  "fontFamily": {
                    "type": "string",
                    "description": "Font family",
                    "maxLength": 64,
                    "pattern": "^[a-zA-Z0-9 ,'-]*$"
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          },
          "position": {
            "oneOf": [
              {
                "type": "number",
                "description": "Simple position: 0-1 for percentage, >1 for pixels from start, <0 for pixels from end"
              },
              {
                "type": "object",
                "description": "Advanced position with offset and angle (X6 LabelPositionObject format)",
                "required": [
                  "distance"
                ],
                "properties": {
                  "distance": {
                    "type": "number",
                    "description": "Position along the edge: 0-1 for percentage, >1 for pixels from start, <0 for pixels from end"
                  },
                  "offset": {
                    "oneOf": [
                      {
                        "type": "number",
                        "description": "Perpendicular offset from edge (positive = down/right, negative = up/left)"
                      },
                      {
                        "type": "object",
                        "description": "Absolute x,y offset",
                        "properties": {
                          "x": {
                            "type": "number"
                          },
                          "y": {
                            "type": "number"
                          }
                        },
                        "additionalProperties": false
                      }
                    ]
                  },
                  "angle": {
                    "type": "number",
                    "description": "Rotation angle in degrees (clockwise)"
                  },
                  "options": {
                    "type": "object",
                    "description": "Advanced positioning options",
                    "properties": {
                      "absoluteDistance": {
                        "type": "boolean",
                        "description": "Forces absolute coordinates for distance"
                      },
                      "reverseDistance": {
                        "type": "boolean",
                        "description": "Forces reverse absolute coordinates"
                      },
                      "absoluteOffset": {
                        "type": "boolean",
                        "description": "Forces absolute coordinates for offset"
                      },
                      "keepGradient": {
                        "type": "boolean",
                        "description": "Auto-adjusts angle to match path gradient"
                      },
                      "ensureLegibility": {
                        "type": "boolean",
                        "description": "Rotates labels to avoid upside-down text"
                      }
                    },
                    "additionalProperties": false
                  }
                },
                "additionalProperties": false
              }
            ]
          }
        },
        "example": {
          "attrs": {
            "text": {
              "text": "Data Flow",
              "fontSize": 12,
              "fill": "#333333"
            }
          },
          "position": 0.5
        },
        "additionalProperties": false
      },
      "PortConfiguration": {
        "type": "object",
        "description": "Port configuration for node connections",
        "properties": {
          "groups": {
            "type": "object",
            "description": "Port group definitions",
            "additionalProperties": {
              "type": "object",
              "properties": {
                "position": {
                  "type": "string",
                  "enum": [
                    "top",
                    "right",
                    "bottom",
                    "left"
                  ],
                  "description": "Port position on the node"
                }
              },
              "additionalProperties": false
            }
          },
          "items": {
            "type": "array",
            "description": "Individual port instances",
            "items": {
              "type": "object",
              "required": [
                "id",
                "group"
              ],
              "properties": {
                "id": {
                  "type": "string",
                  "description": "Unique port identifier",
                  "maxLength": 64,
                  "pattern": "^[\\u0020-\\uFFFF]*$"
                },
                "group": {
                  "type": "string",
                  "description": "Port group this port belongs to",
                  "maxLength": 32,
                  "pattern": "^[\\u0020-\\uFFFF]*$"
                }
              },
              "additionalProperties": false
            },
            "maxItems": 1000
          }
        },
        "additionalProperties": false
      },
      "MarkupElement": {
        "type": "object",
        "description": "SVG/HTML markup element for custom shape definitions in X6",
        "required": [
          "tagName"
        ],
        "properties": {
          "tagName": {
            "type": "string",
            "description": "SVG or HTML tag name (e.g., 'rect', 'circle', 'path', 'text')",
            "example": "rect",
            "pattern": "^[\\u0020-\\uFFFF]*$",
            "maxLength": 1000
          },
          "selector": {
            "type": "string",
            "description": "CSS selector for targeting this element in styling",
            "example": "body",
            "pattern": "^[\\u0020-\\uFFFF]*$",
            "maxLength": 1000
          },
          "attrs": {
            "type": "object",
            "description": "Element attributes and styling properties",
            "additionalProperties": true,
            "example": {
              "fill": "#ffffff",
              "stroke": "#000000",
              "stroke-width": 2
            }
          },
          "children": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MarkupElement"
            },
            "description": "Nested child elements",
            "maxItems": 1000
          }
        },
        "additionalProperties": false
      },
      "EdgeRouter": {
        "oneOf": [
          {
            "type": "string",
            "enum": [
              "normal",
              "orth",
              "oneSide",
              "manhattan",
              "metro",
              "er"
            ],
            "description": "Built-in router name",
            "maxLength": 1000
          },
          {
            "type": "object",
            "description": "Router with custom configuration",
            "required": [
              "name"
            ],
            "properties": {
              "name": {
                "type": "string",
                "enum": [
                  "normal",
                  "orth",
                  "oneSide",
                  "manhattan",
                  "metro",
                  "er"
                ],
                "description": "Router algorithm name",
                "maxLength": 256,
                "pattern": "^[\\u0020-\\uFFFF]*$"
              },
              "args": {
                "type": "object",
                "description": "Router-specific arguments",
                "additionalProperties": true,
                "properties": {
                  "padding": {
                    "type": "number",
                    "description": "Padding around obstacles for routing"
                  },
                  "step": {
                    "type": "number",
                    "description": "Grid step size for orthogonal routing"
                  },
                  "directions": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": [
                        "top",
                        "right",
                        "bottom",
                        "left"
                      ],
                      "maxLength": 1000
                    },
                    "description": "Allowed routing directions",
                    "maxItems": 1000
                  }
                }
              }
            },
            "additionalProperties": false
          }
        ],
        "description": "Edge routing algorithm configuration for pathfinding",
        "example": {
          "name": "manhattan",
          "args": {
            "step": 10,
            "padding": 20
          }
        }
      },
      "EdgeConnector": {
        "oneOf": [
          {
            "type": "string",
            "enum": [
              "normal",
              "rounded",
              "smooth",
              "jumpover"
            ],
            "description": "Built-in connector name",
            "maxLength": 1000
          },
          {
            "type": "object",
            "description": "Connector with custom configuration",
            "required": [
              "name"
            ],
            "properties": {
              "name": {
                "type": "string",
                "enum": [
                  "normal",
                  "rounded",
                  "smooth",
                  "jumpover"
                ],
                "description": "Connector style name",
                "maxLength": 256,
                "pattern": "^[\\u0020-\\uFFFF]*$"
              },
              "args": {
                "type": "object",
                "description": "Connector-specific arguments",
                "additionalProperties": true,
                "properties": {
                  "radius": {
                    "type": "number",
                    "description": "Radius for rounded connectors"
                  },
                  "precision": {
                    "type": "number",
                    "description": "Precision for smooth connectors"
                  },
                  "size": {
                    "type": "number",
                    "description": "Jump size for jumpover connectors"
                  },
                  "jump": {
                    "type": "string",
                    "enum": [
                      "arc",
                      "gap",
                      "cubic"
                    ],
                    "description": "Jump style for jumpover connectors",
                    "maxLength": 1000
                  }
                }
              }
            },
            "additionalProperties": false
          }
        ],
        "description": "Edge connector style configuration for visual appearance",
        "example": {
          "name": "rounded",
          "args": {
            "radius": 10
          }
        }
      },
      "ThreatModelBase": {
        "type": "object",
        "description": "Base schema for ThreatModel with client-writable fields",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the threat model",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "description": {
            "type": "string",
            "description": "Description of the threat model",
            "maxLength": 1024,
            "pattern": "^[^<>]*$"
          },
          "owner": {
            "type": "string",
            "description": "Email address of the current owner",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$"
          },
          "threat_model_framework": {
            "type": "string",
            "description": "The framework used for this threat model",
            "pattern": "^[A-Za-z0-9_-]*$",
            "maxLength": 30
          },
          "authorization": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Authorization"
            },
            "description": "List of users and their roles for this threat model",
            "maxItems": 1000
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional threat model metadata",
            "nullable": true,
            "maxItems": 100
          },
          "issue_uri": {
            "type": "string",
            "format": "uri",
            "description": "URL to an issue in an issue tracking system for this threat model",
            "maxLength": 1000,
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          },
          "status": {
            "type": "string",
            "nullable": true,
            "description": "Status of the threat model in the organization's threat modeling or SDLC process. Examples: \"Not started\", \"In progress\", \"Review\", \"Approved\", \"Closed\"",
            "maxLength": 128,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          }
        },
        "required": [
          "name",
          "owner",
          "authorization",
          "threat_model_framework"
        ],
        "additionalProperties": false
      },
      "ThreatModelInput": {
        "type": "object",
        "description": "Input schema for creating/updating ThreatModel",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the threat model",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "description": {
            "type": "string",
            "description": "Description of the threat model and its purpose",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          },
          "threat_model_framework": {
            "type": "string",
            "description": "The framework used for this threat model",
            "pattern": "^[A-Za-z0-9_-]*$",
            "maxLength": 30
          },
          "authorization": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Authorization"
            },
            "description": "List of users and their roles for this threat model",
            "maxItems": 1000
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional threat model metadata",
            "nullable": true,
            "maxItems": 100
          },
          "issue_uri": {
            "type": "string",
            "format": "uri",
            "description": "URL to an issue in an issue tracking system for this threat model",
            "maxLength": 1000,
            "nullable": true,
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          }
        },
        "required": [
          "name"
        ],
        "additionalProperties": false
      },
      "ThreatBase": {
        "type": "object",
        "description": "Base schema for Threat with client-writable fields",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the threat",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "minLength": 1
          },
          "description": {
            "type": "string",
            "description": "Description of the threat and risk to the organization",
            "maxLength": 1024,
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          },
          "mitigation": {
            "type": "string",
            "description": "Recommended or planned mitigation(s) for the threat",
            "maxLength": 1024,
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          },
          "diagram_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the associated diagram (if applicable) (UUID)",
            "nullable": true,
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "cell_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the associated cell (if applicable) (UUID)",
            "nullable": true,
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          },
          "severity": {
            "type": "string",
            "description": "Severity level of the threat",
            "maxLength": 50,
            "pattern": "^[\\u0020-\\uFFFF_().-]*$"
          },
          "score": {
            "type": "number",
            "description": "Numeric score representing the risk or impact of the threat",
            "minimum": 0.0,
            "maximum": 10.0
          },
          "priority": {
            "type": "string",
            "description": "Priority level for addressing the threat",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "mitigated": {
            "type": "boolean",
            "description": "Whether the threat has been mitigated"
          },
          "status": {
            "type": "string",
            "description": "Current status of the threat",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "threat_type": {
            "type": "string",
            "description": "Type or category of the threat",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional threat metadata",
            "nullable": true,
            "maxItems": 100
          },
          "issue_uri": {
            "type": "string",
            "format": "uri",
            "description": "URL to an issue in an issue tracking system for this threat",
            "maxLength": 1000,
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          },
          "asset_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier of the associated asset (if applicable) (UUID)",
            "nullable": true,
            "maxLength": 36,
            "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
          }
        },
        "required": [
          "name",
          "threat_type"
        ],
        "additionalProperties": false
      },
      "ThreatInput": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ThreatBase"
          }
        ],
        "description": "Input schema for creating/updating Threat"
      },
      "User": {
        "type": "object",
        "description": "Represents a user in the system",
        "properties": {
          "user_id": {
            "type": "string",
            "description": "OAuth provider's unique identifier for the user (from primary provider)",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "email": {
            "type": "string",
            "description": "User's email address",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "name": {
            "type": "string",
            "description": "User's display name",
            "maxLength": 256,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "picture": {
            "type": "string",
            "description": "URL to user's profile picture",
            "maxLength": 1024,
            "pattern": "^(https?|wss?|file)://[^\\s]*$"
          },
          "idp": {
            "type": "string",
            "description": "Identity provider used for current session",
            "maxLength": 100,
            "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$"
          },
          "groups": {
            "type": "array",
            "description": "Groups the user belongs to (from identity provider)",
            "items": {
              "type": "string",
              "pattern": "^[\\u0020-\\uFFFF]*$",
              "maxLength": 1000
            },
            "maxItems": 1000
          },
          "last_login": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of user's last login",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          }
        },
        "required": [
          "user_id",
          "email",
          "name"
        ],
        "additionalProperties": false
      },
      "Participant": {
        "type": "object",
        "description": "A participant in a collaboration session",
        "properties": {
          "user": {
            "$ref": "#/components/schemas/User"
          },
          "last_activity": {
            "type": "string",
            "format": "date-time",
            "description": "Last activity timestamp",
            "maxLength": 36,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "permissions": {
            "type": "string",
            "enum": [
              "reader",
              "writer"
            ],
            "description": "Access permissions in the collaboration session",
            "maxLength": 1000
          }
        },
        "required": [
          "user",
          "last_activity",
          "permissions"
        ],
        "additionalProperties": false
      },
      "DeletionChallenge": {
        "type": "object",
        "description": "Challenge response for user account deletion",
        "required": [
          "challenge_text",
          "expires_at"
        ],
        "properties": {
          "challenge_text": {
            "type": "string",
            "description": "The exact challenge string that must be provided to confirm deletion",
            "pattern": "^[\\u0020-\\uFFFF]*$",
            "maxLength": 1000
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "When the challenge expires (3 minutes from issuance)",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          }
        },
        "additionalProperties": false
      },
      "Repository": {
        "description": "Complete Repository schema with server-generated fields",
        "allOf": [
          {
            "$ref": "#/components/schemas/RepositoryBase"
          },
          {
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the repository",
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                "maxLength": 36
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "readOnly": true,
                "maxItems": 100
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 24,
                "description": "Creation timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 24,
                "description": "Last modification timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            },
            "additionalProperties": false
          }
        ]
      },
      "Note": {
        "description": "Complete Note schema with server-generated fields",
        "allOf": [
          {
            "$ref": "#/components/schemas/NoteBase"
          },
          {
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the note",
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                "maxLength": 36
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "readOnly": true,
                "maxItems": 100
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 24,
                "description": "Creation timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 24,
                "description": "Last modification timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            },
            "additionalProperties": false
          }
        ]
      },
      "Asset": {
        "description": "Complete Asset schema with server-generated fields",
        "allOf": [
          {
            "$ref": "#/components/schemas/AssetBase"
          },
          {
            "type": "object",
            "required": [
              "id"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Unique identifier for the asset",
                "readOnly": true,
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                "maxLength": 36
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "description": "Optional metadata key-value pairs",
                "readOnly": true,
                "maxItems": 100
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 24,
                "description": "Creation timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "maxLength": 24,
                "description": "Last modification timestamp (RFC3339)",
                "readOnly": true,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            },
            "additionalProperties": false
          }
        ]
      },
      "ExtendedAsset": {
        "allOf": [
          {
            "$ref": "#/components/schemas/Asset"
          },
          {
            "type": "object",
            "properties": {
              "threat_model_id": {
                "type": "string",
                "format": "uuid",
                "description": "ID of the threat model this asset belongs to",
                "maxLength": 36,
                "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
              },
              "created_at": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp (ISO3339)",
                "maxLength": 36,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              },
              "modified_at": {
                "type": "string",
                "format": "date-time",
                "description": "Last modification timestamp (ISO3339)",
                "maxLength": 36,
                "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
              }
            },
            "required": [
              "threat_model_id",
              "created_at",
              "modified_at"
            ],
            "additionalProperties": false
          }
        ],
        "example": {
          "id": "6ba7b810-9dad-11d1-beef-00c04fd430c8",
          "name": "Customer Database",
          "description": "Primary database containing customer information",
          "type": "data",
          "criticality": "high",
          "classification": [
            "confidential",
            "regulated"
          ],
          "sensitivity": [
            "pii",
            "financial"
          ],
          "threat_model_id": "6ba7b810-9dad-11d1-beef-00c04fd430c7",
          "created_at": "2024-01-15T10:30:00Z",
          "modified_at": "2024-01-15T10:30:00Z"
        }
      },
      "AssetBase": {
        "type": "object",
        "description": "Base fields for Asset (user-writable only)",
        "required": [
          "name",
          "type"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Asset name",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "description": {
            "type": "string",
            "description": "Description of the asset",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          },
          "type": {
            "type": "string",
            "description": "Type of asset",
            "enum": [
              "data",
              "hardware",
              "software",
              "infrastructure",
              "service",
              "personnel"
            ],
            "maxLength": 64,
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "criticality": {
            "type": "string",
            "description": "Criticality level of the asset",
            "maxLength": 128,
            "nullable": true,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "classification": {
            "type": "array",
            "items": {
              "type": "string",
              "maxLength": 128,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Classification tags for the asset",
            "maxItems": 50,
            "nullable": true
          },
          "sensitivity": {
            "type": "string",
            "description": "Sensitivity label for the asset",
            "maxLength": 128,
            "nullable": true,
            "pattern": "^[\\u0020-\\uFFFF]*$"
          }
        },
        "additionalProperties": false
      },
      "AssetInput": {
        "description": "Input schema for creating or updating Asset",
        "allOf": [
          {
            "$ref": "#/components/schemas/AssetBase"
          }
        ]
      },
      "DocumentBase": {
        "type": "object",
        "description": "Base fields for Document (user-writable only)",
        "required": [
          "name",
          "uri"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Document name",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "description": {
            "type": "string",
            "description": "Description of document purpose or content",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          },
          "uri": {
            "type": "string",
            "format": "uri",
            "description": "URL location of the document",
            "maxLength": 1000,
            "x-oapi-codegen-extra-tags": {
              "binding": "required,url"
            },
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          }
        },
        "additionalProperties": false
      },
      "DocumentInput": {
        "description": "Input schema for creating or updating Document",
        "allOf": [
          {
            "$ref": "#/components/schemas/DocumentBase"
          }
        ]
      },
      "NoteBase": {
        "type": "object",
        "description": "Base fields for Note (user-writable only)",
        "required": [
          "name",
          "content"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Note name",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "content": {
            "type": "string",
            "description": "Note content in markdown format",
            "minLength": 1,
            "maxLength": 65536,
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            },
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          },
          "description": {
            "type": "string",
            "description": "Description of note purpose or context",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          }
        },
        "additionalProperties": false
      },
      "NoteInput": {
        "description": "Input schema for creating or updating Note",
        "allOf": [
          {
            "$ref": "#/components/schemas/NoteBase"
          }
        ]
      },
      "NoteListItem": {
        "type": "object",
        "description": "Summary information for Note in list responses",
        "required": [
          "name",
          "id"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Note name",
            "minLength": 1,
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "x-oapi-codegen-extra-tags": {
              "binding": "required"
            }
          },
          "description": {
            "type": "string",
            "description": "Description of note purpose or context",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          },
          "metadata": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Metadata"
            },
            "description": "Key-value pairs for additional note metadata",
            "nullable": true,
            "maxItems": 100
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the note",
            "readOnly": true,
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "maxLength": 24,
            "description": "Creation timestamp (RFC3339)",
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "maxLength": 24,
            "description": "Last modification timestamp (RFC3339)",
            "readOnly": true,
            "pattern": "^[0-9]*-[0-9]*-[0-9]*T[0-9]*:[0-9]*:[0-9]*(\\.[0-9]*)?(Z|[+-][0-9]*:[0-9]*)$"
          }
        },
        "additionalProperties": false
      },
      "RepositoryBase": {
        "type": "object",
        "description": "Base fields for Repository (user-writable only)",
        "required": [
          "uri"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Name for the source code reference",
            "maxLength": 256,
            "pattern": "^[^<>\"'&]*$",
            "minLength": 1
          },
          "description": {
            "type": "string",
            "description": "Description of the referenced source code",
            "maxLength": 1024,
            "nullable": true,
            "pattern": "^[\\u0020-\\uFFFF\\n\\r\\t]*$"
          },
          "type": {
            "type": "string",
            "description": "Source code repository type",
            "enum": [
              "git",
              "svn",
              "mercurial",
              "other"
            ],
            "maxLength": 16
          },
          "parameters": {
            "type": "object",
            "description": "repo-specific parameters for retrieving the source",
            "properties": {
              "refType": {
                "type": "string",
                "enum": [
                  "branch",
                  "tag",
                  "commit"
                ],
                "description": "Reference type (branch, tag, or commit)",
                "maxLength": 6
              },
              "refValue": {
                "type": "string",
                "description": "Reference value (branch name, tag value, or commit id)",
                "maxLength": 256,
                "pattern": "^[\\u0020-\\uFFFF]*$"
              },
              "subPath": {
                "type": "string",
                "description": "Sub-path within the repository",
                "maxLength": 256,
                "pattern": "^[\\u0020-\\uFFFF]*$"
              }
            },
            "required": [
              "refType",
              "refValue"
            ],
            "additionalProperties": false
          },
          "uri": {
            "type": "string",
            "format": "uri",
            "description": "URL to retrieve the referenced source code",
            "maxLength": 1000,
            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$"
          }
        },
        "additionalProperties": false
      },
      "RepositoryInput": {
        "description": "Input schema for creating or updating Repository",
        "allOf": [
          {
            "$ref": "#/components/schemas/RepositoryBase"
          }
        ]
      },
      "WebhookSubscription": {
        "type": "object",
        "required": [
          "id",
          "owner_id",
          "name",
          "url",
          "events",
          "status",
          "created_at",
          "modified_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "owner_id": {
            "type": "string",
            "format": "uuid",
            "description": "Owner user ID",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true,
            "description": "Optional threat model filter (null means all threat models)",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 255,
            "description": "Descriptive name",
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "url": {
            "type": "string",
            "format": "uri",
            "minLength": 8,
            "maxLength": 1024,
            "description": "Webhook endpoint URL (must be HTTPS)",
            "pattern": "^(https?|wss?|file)://[^\\s]*$"
          },
          "events": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^[\\u0020-\\uFFFF]*$",
              "maxLength": 1000
            },
            "minItems": 1,
            "description": "List of event types to subscribe to",
            "maxItems": 1000
          },
          "secret": {
            "type": "string",
            "maxLength": 128,
            "description": "HMAC secret for signing payloads (not returned in GET responses)",
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending_verification",
              "active",
              "pending_delete"
            ],
            "description": "Subscription status",
            "maxLength": 1000
          },
          "challenges_sent": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of verification challenges sent"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          },
          "modified_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          },
          "last_successful_use": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Last successful delivery timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          },
          "publication_failures": {
            "type": "integer",
            "minimum": 0,
            "description": "Count of consecutive failed deliveries"
          }
        },
        "additionalProperties": false
      },
      "WebhookSubscriptionInput": {
        "type": "object",
        "required": [
          "name",
          "url",
          "events"
        ],
        "properties": {
          "threat_model_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true,
            "description": "Optional threat model filter",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "name": {
            "type": "string",
            "minLength": 1,
            "maxLength": 255,
            "description": "Descriptive name for the subscription",
            "pattern": "^[\\u0020-\\uFFFF]*$"
          },
          "url": {
            "type": "string",
            "format": "uri",
            "minLength": 8,
            "maxLength": 1024,
            "description": "Webhook endpoint URL (must be HTTPS)",
            "pattern": "^(https?|wss?|file)://[^\\s]*$"
          },
          "events": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^[\\u0020-\\uFFFF]*$",
              "maxLength": 1000
            },
            "minItems": 1,
            "maxItems": 50,
            "description": "List of event types to subscribe to"
          },
          "secret": {
            "type": "string",
            "minLength": 16,
            "maxLength": 128,
            "description": "Optional HMAC secret for signing payloads (auto-generated if not provided)",
            "pattern": "^[\\u0020-\\uFFFF]*$"
          }
        },
        "additionalProperties": false
      },
      "WebhookDelivery": {
        "type": "object",
        "required": [
          "id",
          "subscription_id",
          "event_type",
          "status",
          "attempts",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier (UUIDv7)",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "subscription_id": {
            "type": "string",
            "format": "uuid",
            "description": "Subscription that triggered this delivery",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "event_type": {
            "type": "string",
            "enum": [
              "threat_model.created",
              "threat_model.updated",
              "threat_model.deleted",
              "diagram.created",
              "diagram.updated",
              "diagram.deleted",
              "document.created",
              "document.updated",
              "document.deleted",
              "note.created",
              "note.updated",
              "note.deleted",
              "repository.created",
              "repository.updated",
              "repository.deleted",
              "asset.created",
              "asset.updated",
              "asset.deleted",
              "threat.created",
              "threat.updated",
              "threat.deleted",
              "metadata.created",
              "metadata.updated",
              "metadata.deleted",
              "addon.invoked"
            ],
            "description": "Webhook event type following {resource}.{action} pattern",
            "maxLength": 1000
          },
          "payload": {
            "type": "object",
            "description": "Event payload (JSON)",
            "additionalProperties": false
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "delivered",
              "failed"
            ],
            "description": "Delivery status",
            "maxLength": 1000
          },
          "attempts": {
            "type": "integer",
            "minimum": 0,
            "description": "Number of delivery attempts"
          },
          "next_retry_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Next retry timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          },
          "last_error": {
            "type": "string",
            "description": "Last error message",
            "pattern": "^[\\u0020-\\uFFFF]*$",
            "maxLength": 1000
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          },
          "delivered_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "Successful delivery timestamp",
            "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
            "maxLength": 64
          }
        },
        "additionalProperties": false
      },
      "WebhookTestRequest": {
        "type": "object",
        "properties": {
          "event_type": {
            "type": "string",
            "enum": [
              "threat_model.created",
              "threat_model.updated",
              "threat_model.deleted",
              "diagram.created",
              "diagram.updated",
              "diagram.deleted",
              "document.created",
              "document.updated",
              "document.deleted",
              "note.created",
              "note.updated",
              "note.deleted",
              "repository.created",
              "repository.updated",
              "repository.deleted",
              "asset.created",
              "asset.updated",
              "asset.deleted",
              "threat.created",
              "threat.updated",
              "threat.deleted",
              "metadata.created",
              "metadata.updated",
              "metadata.deleted"
            ],
            "description": "Webhook event type following {resource}.{action} pattern",
            "maxLength": 1000
          }
        },
        "additionalProperties": false
      },
      "WebhookTestResponse": {
        "type": "object",
        "required": [
          "delivery_id",
          "status"
        ],
        "properties": {
          "delivery_id": {
            "type": "string",
            "format": "uuid",
            "description": "Test delivery ID",
            "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
            "maxLength": 36
          },
          "status": {
            "type": "string",
            "description": "Test result status",
            "pattern": "^[\\u0020-\\uFFFF]*$",
            "maxLength": 1000
          },
          "message": {
            "type": "string",
            "description": "Result message",
            "pattern": "^[\\u0020-\\uFFFF]*$",
            "maxLength": 1000
          }
        },
        "additionalProperties": false
      }
    },
    "responses": {
      "Error": {
        "description": "Error response",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "examples": {
              "authorizationError": {
                "summary": "Insufficient permissions for sub-resource access",
                "value": {
                  "error": "access_denied",
                  "error_description": "User does not have sufficient permissions to access this sub-resource",
                  "details": {
                    "required_role": "writer",
                    "user_role": "reader",
                    "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                    "resource_type": "threat"
                  }
                }
              },
              "notFoundError": {
                "summary": "Sub-resource not found",
                "value": {
                  "error": "not_found",
                  "error_description": "The requested sub-resource does not exist or does not belong to the specified threat model",
                  "details": {
                    "resource_id": "550e8400-e29b-41d4-a716-446655440999",
                    "resource_type": "document",
                    "threat_model_id": "550e8400-e29b-41d4-a716-446655440000"
                  }
                }
              },
              "validationError": {
                "summary": "Invalid input data",
                "value": {
                  "error": "invalid_input",
                  "error_description": "The provided data does not meet validation requirements",
                  "details": {
                    "field_errors": [
                      {
                        "field": "name",
                        "message": "Name is required and cannot be empty"
                      },
                      {
                        "field": "uri",
                        "message": "URI must be a valid RFC 3986 URI, e.g. an HTTPS URL"
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "TooManyRequests": {
        "description": "Too Many Requests - Rate limit exceeded. The client has sent too many requests in a given amount of time. See rate limit headers for details.",
        "headers": {
          "X-RateLimit-Limit": {
            "description": "The maximum number of requests allowed in the current time window",
            "schema": {
              "type": "integer",
              "example": 100
            }
          },
          "X-RateLimit-Remaining": {
            "description": "The number of requests remaining in the current time window",
            "schema": {
              "type": "integer",
              "example": 0
            }
          },
          "X-RateLimit-Reset": {
            "description": "Unix timestamp (seconds since epoch) when the rate limit window resets",
            "schema": {
              "type": "integer",
              "example": 1640000000
            }
          },
          "Retry-After": {
            "description": "Number of seconds to wait before retrying the request",
            "schema": {
              "type": "integer",
              "example": 60
            }
          }
        },
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "example": {
              "code": "rate_limit_exceeded",
              "message": "Rate limit exceeded: 100 requests per minute. Retry after 45 seconds.",
              "details": {
                "limit": 100,
                "window": "minute",
                "retry_after": 45
              }
            }
          }
        }
      }
    }
  },
  "paths": {
    "/": {
      "get": {
        "tags": [
          "General"
        ],
        "summary": "Get API information",
        "description": "Returns service, API, and operator information without authentication",
        "operationId": "getApiInfo",
        "responses": {
          "200": {
            "description": "Service and API information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiInfo"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        }
      }
    },
    "/.well-known/openid-configuration": {
      "get": {
        "tags": [
          "OIDC Discovery"
        ],
        "summary": "OpenID Connect Discovery Configuration",
        "description": "Returns OpenID Connect provider configuration metadata as per RFC 8414",
        "operationId": "getOpenIDConfiguration",
        "security": [],
        "responses": {
          "200": {
            "description": "OpenID Connect configuration metadata",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "issuer": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                      "maxLength": 1000
                    },
                    "authorization_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/authorize",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                      "maxLength": 1000
                    },
                    "token_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/token",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                      "maxLength": 1000
                    },
                    "userinfo_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/userinfo",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                      "maxLength": 1000
                    },
                    "jwks_uri": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/.well-known/jwks.json",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                      "maxLength": 1000
                    },
                    "response_types_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "code",
                        "token",
                        "id_token",
                        "code token",
                        "code id_token",
                        "token id_token",
                        "code token id_token"
                      ],
                      "maxItems": 1000
                    },
                    "subject_types_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "public"
                      ],
                      "maxItems": 1000
                    },
                    "id_token_signing_alg_values_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "HS256"
                      ],
                      "maxItems": 1000
                    },
                    "scopes_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "openid",
                        "email",
                        "profile"
                      ],
                      "maxItems": 1000
                    },
                    "claims_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "sub",
                        "email",
                        "email_verified",
                        "name",
                        "given_name",
                        "family_name",
                        "picture",
                        "locale"
                      ],
                      "maxItems": 1000
                    },
                    "introspection_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/introspect",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                      "maxLength": 1000
                    }
                  },
                  "required": [
                    "issuer",
                    "authorization_endpoint",
                    "token_endpoint",
                    "jwks_uri",
                    "response_types_supported",
                    "subject_types_supported",
                    "id_token_signing_alg_values_supported"
                  ],
                  "additionalProperties": false
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        }
      }
    },
    "/.well-known/oauth-authorization-server": {
      "get": {
        "tags": [
          "OIDC Discovery"
        ],
        "summary": "OAuth 2.0 Authorization Server Metadata",
        "description": "Returns OAuth 2.0 authorization server metadata as per RFC 8414",
        "operationId": "getOAuthAuthorizationServerMetadata",
        "security": [],
        "responses": {
          "200": {
            "description": "OAuth 2.0 authorization server metadata",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "issuer": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                      "maxLength": 1000
                    },
                    "authorization_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/authorize",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                      "maxLength": 1000
                    },
                    "token_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/token",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                      "maxLength": 1000
                    },
                    "introspection_endpoint": {
                      "type": "string",
                      "format": "uri",
                      "example": "http://localhost:8080/oauth2/introspect",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                      "maxLength": 1000
                    },
                    "response_types_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "code",
                        "token",
                        "id_token"
                      ],
                      "maxItems": 1000
                    },
                    "grant_types_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "authorization_code",
                        "implicit",
                        "refresh_token"
                      ],
                      "maxItems": 1000
                    },
                    "token_endpoint_auth_methods_supported": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "example": [
                        "client_secret_post",
                        "none"
                      ],
                      "maxItems": 1000
                    }
                  },
                  "required": [
                    "issuer",
                    "authorization_endpoint",
                    "token_endpoint",
                    "response_types_supported"
                  ],
                  "additionalProperties": false
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        }
      }
    },
    "/.well-known/jwks.json": {
      "get": {
        "tags": [
          "OIDC Discovery"
        ],
        "summary": "JSON Web Key Set",
        "description": "Returns the JSON Web Key Set (JWKS) for JWT signature verification",
        "operationId": "getJWKS",
        "security": [],
        "responses": {
          "200": {
            "description": "JSON Web Key Set",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "keys": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "kty": {
                            "type": "string",
                            "example": "oct",
                            "maxLength": 1000
                          },
                          "use": {
                            "type": "string",
                            "example": "sig",
                            "maxLength": 1000
                          },
                          "alg": {
                            "type": "string",
                            "example": "HS256",
                            "maxLength": 1000
                          },
                          "kid": {
                            "type": "string",
                            "example": "tmi-signing-key",
                            "maxLength": 1000
                          }
                        },
                        "required": [
                          "kty",
                          "use",
                          "alg",
                          "kid"
                        ],
                        "additionalProperties": false
                      },
                      "maxItems": 1000
                    }
                  },
                  "required": [
                    "keys"
                  ],
                  "additionalProperties": false
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        }
      }
    },
    "/.well-known/oauth-protected-resource": {
      "get": {
        "tags": [
          "OAuth Discovery"
        ],
        "summary": "OAuth 2.0 Protected Resource Metadata",
        "description": "Returns OAuth 2.0 protected resource metadata as per RFC 9728",
        "operationId": "getOAuthProtectedResourceMetadata",
        "security": [],
        "responses": {
          "200": {
            "description": "OAuth 2.0 protected resource metadata",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuthProtectedResourceMetadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "ip",
          "tier": "public-discovery",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 10,
              "configurable": false,
              "tracking_method": "Source IP address"
            }
          ]
        }
      }
    },
    "/oauth2/introspect": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Token Introspection",
        "description": "Introspects a JWT token to determine its validity and metadata as per RFC 7662",
        "operationId": "introspectToken",
        "requestBody": {
          "required": true,
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "token": {
                    "type": "string",
                    "description": "The JWT token to introspect",
                    "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  },
                  "token_type_hint": {
                    "type": "string",
                    "description": "Optional hint about the type of token being introspected",
                    "example": "access_token",
                    "nullable": true,
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  }
                },
                "required": [
                  "token"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Token introspection result",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "active": {
                      "type": "boolean",
                      "description": "Whether the token is active/valid",
                      "example": true
                    },
                    "sub": {
                      "type": "string",
                      "description": "Subject (user identifier)",
                      "example": "user@example.com",
                      "maxLength": 1000
                    },
                    "email": {
                      "type": "string",
                      "description": "User email address",
                      "example": "user@example.com",
                      "maxLength": 1000
                    },
                    "email_verified": {
                      "type": "boolean",
                      "description": "Whether the email is verified",
                      "example": true
                    },
                    "name": {
                      "type": "string",
                      "description": "User's full name",
                      "example": "John Doe",
                      "maxLength": 256,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "exp": {
                      "type": "integer",
                      "description": "Token expiration time (Unix timestamp)",
                      "example": 1640995200
                    },
                    "iat": {
                      "type": "integer",
                      "description": "Token issued at time (Unix timestamp)",
                      "example": 1640991600
                    },
                    "iss": {
                      "type": "string",
                      "description": "Token issuer",
                      "example": "http://localhost:8080",
                      "maxLength": 1000
                    }
                  },
                  "required": [
                    "active"
                  ],
                  "additionalProperties": false
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        }
      }
    },
    "/oauth2/providers": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "List available OAuth providers",
        "description": "Returns a list of configured OAuth providers available for authentication",
        "operationId": "getAuthProviders",
        "responses": {
          "200": {
            "description": "List of available OAuth providers",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "providers": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "description": "Provider identifier",
                            "maxLength": 1000
                          },
                          "name": {
                            "type": "string",
                            "description": "Display name of the provider",
                            "maxLength": 256,
                            "pattern": "^[\\u0020-\\uFFFF]*$"
                          },
                          "icon": {
                            "type": "string",
                            "description": "Icon identifier for the provider",
                            "maxLength": 1000
                          },
                          "auth_url": {
                            "type": "string",
                            "format": "uri",
                            "description": "TMI authorization endpoint URL for this provider",
                            "pattern": "^(https?|wss?|file)://[^\\s]*$",
                            "maxLength": 1024
                          },
                          "token_url": {
                            "type": "string",
                            "format": "uri",
                            "description": "TMI token exchange endpoint URL for this provider",
                            "pattern": "^(https?|wss?|file)://[^\\s]*$",
                            "maxLength": 1024
                          },
                          "redirect_uri": {
                            "type": "string",
                            "format": "uri",
                            "description": "OAuth callback URI configured for this provider",
                            "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                            "maxLength": 1000
                          },
                          "client_id": {
                            "type": "string",
                            "description": "OAuth client ID for this provider",
                            "maxLength": 1000
                          }
                        },
                        "required": [
                          "id",
                          "name",
                          "icon",
                          "auth_url",
                          "token_url",
                          "redirect_uri",
                          "client_id"
                        ],
                        "additionalProperties": false
                      },
                      "maxItems": 1000
                    }
                  },
                  "required": [
                    "providers"
                  ],
                  "additionalProperties": false
                },
                "example": {
                  "providers": [
                    {
                      "id": "google",
                      "name": "Google",
                      "icon": "fa-brands fa-google",
                      "auth_url": "http://localhost:8080/oauth2/authorize?idp=google",
                      "token_url": "http://localhost:8080/oauth2/token?idp=google",
                      "redirect_uri": "http://localhost:8080/oauth2/callback",
                      "client_id": "675196260523-e8ppeu62pv222jhnpebe929b2tgl2jm0.apps.googleusercontent.com"
                    },
                    {
                      "id": "github",
                      "name": "GitHub",
                      "icon": "fa-brands fa-github",
                      "auth_url": "http://localhost:8080/oauth2/authorize?idp=github",
                      "token_url": "http://localhost:8080/oauth2/token?idp=github",
                      "redirect_uri": "http://localhost:8080/oauth2/callback",
                      "client_id": "your-github-client-id"
                    },
                    {
                      "id": "microsoft",
                      "name": "Microsoft",
                      "icon": "fa-brands fa-microsoft",
                      "auth_url": "http://localhost:8080/oauth2/authorize?idp=microsoft",
                      "token_url": "http://localhost:8080/oauth2/token?idp=microsoft",
                      "redirect_uri": "http://localhost:8080/oauth2/callback",
                      "client_id": "your-microsoft-client-id"
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/oauth2/providers/{idp}/groups": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Get groups for identity provider",
        "description": "Returns groups available from a specific identity provider for autocomplete and discovery",
        "operationId": "getProviderGroups",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "idp",
            "in": "path",
            "required": true,
            "description": "Identity provider ID (e.g., saml_okta, saml_azure)",
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
              "maxLength": 100
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of groups from the identity provider",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "idp": {
                      "type": "string",
                      "description": "Identity provider ID",
                      "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
                      "maxLength": 100
                    },
                    "groups": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string",
                            "description": "Group name",
                            "maxLength": 256,
                            "pattern": "^[\\u0020-\\uFFFF]*$"
                          },
                          "display_name": {
                            "type": "string",
                            "description": "Display name for the group",
                            "maxLength": 256,
                            "pattern": "^[\\u0020-\\uFFFF]*$"
                          },
                          "used_in_authorizations": {
                            "type": "boolean",
                            "description": "Whether this group is used in any threat model authorizations"
                          }
                        },
                        "required": [
                          "name"
                        ],
                        "additionalProperties": false
                      },
                      "maxItems": 1000
                    }
                  },
                  "required": [
                    "idp",
                    "groups"
                  ],
                  "additionalProperties": false
                },
                "example": {
                  "idp": "saml_okta",
                  "groups": [
                    {
                      "name": "security-team",
                      "display_name": "Security Team",
                      "used_in_authorizations": true
                    },
                    {
                      "name": "developers",
                      "display_name": "Development Team",
                      "used_in_authorizations": false
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/oauth2/authorize": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Initiate OAuth authorization flow",
        "description": "Redirects user to OAuth provider's authorization page. Supports client callback URL for seamless client integration. Generates state parameter for CSRF protection.",
        "operationId": "authorizeOAuthProvider",
        "parameters": [
          {
            "name": "idp",
            "in": "query",
            "required": false,
            "description": "OAuth provider identifier. Defaults to 'test' provider in non-production builds if not specified.",
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
              "maxLength": 100
            }
          },
          {
            "name": "client_callback",
            "in": "query",
            "required": false,
            "description": "Client callback URL where TMI should redirect after successful OAuth completion with tokens as query parameters. If not provided, tokens are returned as JSON response.",
            "schema": {
              "type": "string",
              "format": "uri",
              "example": "http://localhost:4200/oauth2/callback",
              "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
              "maxLength": 1000
            }
          },
          {
            "name": "state",
            "in": "query",
            "required": false,
            "description": "CSRF protection state parameter. Recommended for security. Will be included in the callback response.",
            "schema": {
              "type": "string",
              "example": "random_state_abc123",
              "pattern": "^[a-zA-Z0-9_~.+/=-]*$",
              "maxLength": 256
            }
          },
          {
            "name": "login_hint",
            "in": "query",
            "required": false,
            "description": "User identity hint for test OAuth provider. Allows specifying a desired user identity for testing and automation. Only supported by the test provider (ignored by production providers like Google, GitHub, etc.). Must be 3-20 characters, alphanumeric and hyphens only.",
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9-]{3,20}$",
              "example": "alice",
              "maxLength": 1000
            }
          },
          {
            "name": "scope",
            "in": "query",
            "required": true,
            "description": "OAuth 2.0 scope parameter. For OpenID Connect, must include \"openid\". Supports \"profile\" and \"email\" scopes. Other scopes are silently ignored. Space-separated values.",
            "schema": {
              "type": "string",
              "example": "openid profile email",
              "pattern": "^[a-zA-Z0-9_][a-zA-Z0-9_ ]*[a-zA-Z0-9_]$",
              "maxLength": 256
            }
          }
        ],
        "responses": {
          "302": {
            "description": "Redirect to OAuth provider authorization page",
            "headers": {
              "Location": {
                "schema": {
                  "type": "string",
                  "format": "uri",
                  "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                  "maxLength": 1000
                },
                "description": "OAuth provider authorization URL with client_id, redirect_uri, response_type, scope, and state parameters"
              }
            }
          },
          "400": {
            "description": "Invalid provider or provider not configured",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error generating authorization URL",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        }
      }
    },
    "/oauth2/token": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Exchange OAuth authorization code for JWT tokens",
        "description": "Provider-neutral endpoint to exchange OAuth authorization codes for TMI JWT tokens. Supports Google, GitHub, and Microsoft OAuth providers.",
        "operationId": "exchangeOAuthCode",
        "parameters": [
          {
            "name": "idp",
            "in": "query",
            "required": false,
            "description": "OAuth provider identifier. Defaults to 'test' provider in non-production builds if not specified.",
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$",
              "maxLength": 100
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "code": {
                    "type": "string",
                    "description": "Authorization code received from OAuth provider",
                    "example": "4/0AX4XfWiXY2BZ_example_auth_code_from_google",
                    "pattern": "^[a-zA-Z0-9_-]*$",
                    "maxLength": 512
                  },
                  "state": {
                    "type": "string",
                    "description": "State parameter for CSRF protection (optional but recommended)",
                    "example": "random_state_value_abc123",
                    "pattern": "^[a-zA-Z0-9_-]*$",
                    "maxLength": 256
                  },
                  "redirect_uri": {
                    "type": "string",
                    "format": "uri",
                    "description": "Redirect URI used in the authorization request (must match exactly)",
                    "example": "https://your-web-app.com/oauth2/callback",
                    "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                    "maxLength": 1000
                  }
                },
                "required": [
                  "code",
                  "redirect_uri"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OAuth exchange successful, TMI JWT tokens issued",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokenResponse"
                },
                "example": {
                  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyQGV4YW1wbGUuY29tIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDI2MjJ9.example_jwt_signature",
                  "refresh_token": "8xLOxBtZp8_example_refresh_token",
                  "token_type": "Bearer",
                  "expires_in": 3600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - invalid provider, missing parameters, or invalid state",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "invalid_provider": {
                    "summary": "Invalid provider",
                    "value": {
                      "error": "Invalid provider: invalid_provider",
                      "error_description": "Provider 'invalid_provider' is not configured or supported"
                    }
                  },
                  "missing_code": {
                    "summary": "Missing authorization code",
                    "value": {
                      "error": "Invalid request: missing required fields",
                      "error_description": "The 'code' parameter is required"
                    }
                  },
                  "invalid_state": {
                    "summary": "Invalid state parameter",
                    "value": {
                      "error": "Invalid state parameter",
                      "error_description": "State parameter validation failed - possible CSRF attack"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error - OAuth provider communication failed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "provider_error": {
                    "summary": "OAuth provider communication failed",
                    "value": {
                      "error": "Failed to exchange authorization code: oauth2: cannot fetch token: 400 Bad Request",
                      "error_description": "Unable to communicate with OAuth provider or invalid authorization code"
                    }
                  },
                  "user_info_error": {
                    "summary": "Failed to get user information",
                    "value": {
                      "error": "Failed to get user info: 401 Unauthorized",
                      "error_description": "OAuth provider denied access to user information"
                    }
                  }
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        }
      }
    },
    "/oauth2/refresh": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Refresh JWT token",
        "description": "Exchanges a refresh token for a new JWT access token",
        "operationId": "refreshToken",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "refresh_token": {
                    "type": "string",
                    "description": "Valid refresh token",
                    "example": "8xLOxBtZp8_example_refresh_token",
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  }
                },
                "required": [
                  "refresh_token"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "New JWT issued successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokenResponse"
                },
                "example": {
                  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyQGV4YW1wbGUuY29tIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDI2MjJ9.new_jwt_signature",
                  "refresh_token": "9yMPyCtZq9_new_refresh_token",
                  "token_type": "Bearer",
                  "expires_in": 3600
                }
              }
            }
          },
          "400": {
            "description": "Bad request - missing or invalid refresh token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "missing_token": {
                    "summary": "Missing refresh token",
                    "value": {
                      "error": "Invalid request: missing required fields",
                      "error_description": "The 'refresh_token' parameter is required"
                    }
                  },
                  "invalid_format": {
                    "summary": "Invalid token format",
                    "value": {
                      "error": "Invalid refresh token format",
                      "error_description": "Refresh token must be a valid UUID string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or expired refresh token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "expired_token": {
                    "summary": "Expired refresh token",
                    "value": {
                      "error": "Invalid refresh token",
                      "error_description": "The refresh token has expired or has been revoked"
                    }
                  },
                  "invalid_token": {
                    "summary": "Invalid refresh token",
                    "value": {
                      "error": "Invalid refresh token",
                      "error_description": "The provided refresh token is not valid"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        }
      }
    },
    "/oauth2/userinfo": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Get current user information",
        "description": "Returns information about the currently authenticated user",
        "operationId": "getCurrentUser",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Current user information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "sub": {
                      "type": "string",
                      "description": "Subject identifier (email or provider-assigned ID)",
                      "maxLength": 1000
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "description": "Unique identifier for the user (UUID)",
                      "maxLength": 36,
                      "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
                    },
                    "email": {
                      "type": "string",
                      "format": "email",
                      "description": "User email address",
                      "pattern": "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$",
                      "maxLength": 254
                    },
                    "name": {
                      "type": "string",
                      "description": "User display name",
                      "maxLength": 256,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "idp": {
                      "type": "string",
                      "description": "Current identity provider",
                      "maxLength": 100,
                      "pattern": "^[a-zA-Z][a-zA-Z0-9_-]*$"
                    },
                    "groups": {
                      "type": "array",
                      "description": "Groups the user belongs to",
                      "items": {
                        "type": "string",
                        "maxLength": 1000
                      },
                      "maxItems": 1000
                    },
                    "providers": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "provider": {
                            "type": "string",
                            "description": "OAuth provider name",
                            "maxLength": 1000
                          },
                          "is_primary": {
                            "type": "boolean",
                            "description": "Whether this is the primary authentication method"
                          }
                        },
                        "additionalProperties": false
                      },
                      "description": "Linked OAuth providers",
                      "maxItems": 1000
                    }
                  },
                  "required": [
                    "id",
                    "email",
                    "name"
                  ],
                  "additionalProperties": false
                },
                "example": {
                  "sub": "user@example.com",
                  "id": "550e8400-e29b-41d4-a716-446655440000",
                  "email": "user@example.com",
                  "name": "John Doe",
                  "idp": "saml_okta",
                  "groups": [
                    "security-team",
                    "developers"
                  ],
                  "providers": [
                    {
                      "provider": "saml_okta",
                      "is_primary": true
                    },
                    {
                      "provider": "google",
                      "is_primary": false
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/oauth2/callback": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Handle OAuth callback",
        "description": "Exchanges OAuth authorization code for JWT tokens. If client_callback was provided during authorization, redirects to client with tokens. Otherwise returns tokens as JSON response.",
        "operationId": "handleOAuthCallback",
        "parameters": [
          {
            "name": "code",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_~.+/=-]*$",
              "maxLength": 512
            },
            "description": "Authorization code from the OAuth provider"
          },
          {
            "name": "state",
            "in": "query",
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_~.+/=-]*$",
              "maxLength": 256
            },
            "description": "Optional state parameter for CSRF protection"
          }
        ],
        "responses": {
          "200": {
            "description": "JWT tokens issued successfully (legacy mode when no client_callback provided)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokenResponse"
                }
              }
            }
          },
          "302": {
            "description": "Redirect to client callback URL with tokens (when client_callback was provided)",
            "headers": {
              "Location": {
                "schema": {
                  "type": "string",
                  "format": "uri",
                  "example": "http://localhost:4200/oauth2/callback?access_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&refresh_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&expires_in=3600&token_type=Bearer&state=random_state_abc123",
                  "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
                  "maxLength": 1000
                },
                "description": "Client callback URL with access_token, refresh_token, expires_in, token_type, and state as query parameters"
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        }
      }
    },
    "/oauth2/revoke": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "Logout user",
        "description": "Invalidates the user's JWT token by adding it to a blacklist, effectively ending the session. Once logged out, the token cannot be used for further authenticated requests until it naturally expires. The token blacklist is maintained in Redis with automatic cleanup based on token expiration times.",
        "operationId": "logoutUser",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "description": "Empty request body - token is provided via Authorization header",
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {},
                "example": {},
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "204": {
            "description": "User logged out successfully. The JWT token has been invalidated and added to the blacklist.",
            "headers": {
              "X-Request-ID": {
                "description": "Unique request identifier for tracking",
                "schema": {
                  "type": "string",
                  "example": "req_abc123def456"
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed - invalid, missing, or malformed token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "examples": {
                  "missing_token": {
                    "summary": "Missing Authorization header",
                    "value": {
                      "error": "unauthorized",
                      "error_description": "Missing Authorization header"
                    }
                  },
                  "invalid_format": {
                    "summary": "Invalid Authorization header format",
                    "value": {
                      "error": "unauthorized",
                      "error_description": "Invalid Authorization header format"
                    }
                  },
                  "malformed_token": {
                    "summary": "Malformed JWT token",
                    "value": {
                      "error": "unauthorized",
                      "error_description": "Invalid token format"
                    }
                  },
                  "blacklisted_token": {
                    "summary": "Token already blacklisted",
                    "value": {
                      "error": "unauthorized",
                      "error_description": "Token has been revoked"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error - token blacklisting failed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/collaboration/sessions": {
      "get": {
        "tags": [
          "Collaboration"
        ],
        "summary": "List active collaboration sessions",
        "description": "Returns all currently active collaboration sessions for diagrams. Clients can use this endpoint to discover existing sessions before connecting via WebSocket.",
        "operationId": "getCollaborationSessions",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "List of active collaboration sessions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CollaborationSession"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "active_sessions": {
                    "summary": "Multiple active sessions",
                    "value": [
                      {
                        "session_id": "550e8400-e29b-41d4-a716-446655440000",
                        "host": "alice@example.com",
                        "presenter": "alice@example.com",
                        "threat_model_id": "987f6543-e89b-12d3-a456-426614174000",
                        "threat_model_name": "E-commerce Platform",
                        "diagram_id": "123e4567-e89b-12d3-a456-426614174000",
                        "diagram_name": "Data Flow Diagram",
                        "participants": [
                          {
                            "user": {
                              "user_id": "oauth2|google|118354289635789012345",
                              "email": "alice@example.com",
                              "name": "Alice Smith"
                            },
                            "last_activity": "2024-01-20T14:30:00Z",
                            "permissions": "writer"
                          },
                          {
                            "user": {
                              "user_id": "oauth2|github|67890",
                              "email": "bob@example.com",
                              "name": "Bob Johnson"
                            },
                            "last_activity": "2024-01-20T14:35:00Z",
                            "permissions": "reader"
                          }
                        ]
                      }
                    ]
                  },
                  "no_sessions": {
                    "summary": "No active sessions",
                    "value": []
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed - invalid, missing, or malformed token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models": {
      "get": {
        "tags": [
          "Threat Models"
        ],
        "summary": "List threat models",
        "description": "Returns a list of threat models accessible to the authenticated user with enhanced metadata and entity counts",
        "operationId": "listThreatModels",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 20
            },
            "description": "Number of threat models to return"
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 0
            },
            "description": "Pagination offset"
          },
          {
            "name": "owner",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by owner name or email"
          },
          {
            "name": "name",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by threat model name (partial match)"
          },
          {
            "name": "description",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 1000,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by threat model description (partial match)"
          },
          {
            "name": "issue_uri",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 1000,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by issue URI (partial match)"
          },
          {
            "name": "created_after",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date-time",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
              "maxLength": 64
            },
            "description": "Filter threat models created after this date (RFC3339 format)"
          },
          {
            "name": "created_before",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date-time",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
              "maxLength": 64
            },
            "description": "Filter threat models created before this date (RFC3339 format)"
          },
          {
            "name": "modified_after",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date-time",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
              "maxLength": 64
            },
            "description": "Filter threat models modified after this date (RFC3339 format)"
          },
          {
            "name": "modified_before",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date-time",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
              "maxLength": 64
            },
            "description": "Filter threat models modified before this date (RFC3339 format)"
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by status value (exact match). To filter by multiple statuses, use multiple status parameters or comma-separated values."
          },
          {
            "name": "status_updated_after",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date-time",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
              "maxLength": 64
            },
            "description": "Filter threat models where status was updated after this timestamp (RFC3339)"
          },
          {
            "name": "status_updated_before",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date-time",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
              "maxLength": 64
            },
            "description": "Filter threat models where status was updated before this timestamp (RFC3339)"
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated list of threat models with enhanced metadata and entity counts",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/TMListItem"
                  },
                  "maxItems": 1000
                },
                "example": {
                  "data": [
                    {
                      "id": "550e8400-e29b-41d4-a716-446655440000",
                      "name": "System Threat Model",
                      "description": "Comprehensive threat model for our web application system",
                      "created_at": "2025-04-06T12:00:00Z",
                      "modified_at": "2025-04-06T14:30:00Z",
                      "owner": "user@example.com",
                      "created_by": "admin@example.com",
                      "threat_model_framework": "STRIDE",
                      "document_count": 3,
                      "source_count": 2,
                      "diagram_count": 1,
                      "threat_count": 15,
                      "issue_uri": "https://github.com/example/issues/123"
                    }
                  ],
                  "pagination": {
                    "total": 1,
                    "limit": 20,
                    "offset": 0,
                    "has_more": false
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Models"
        ],
        "summary": "Create a threat model",
        "description": "Creates a new threat model with the authenticated user as owner",
        "operationId": "createThreatModel",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ThreatModelInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Threat model created successfully",
            "headers": {
              "Location": {
                "schema": {
                  "type": "string"
                },
                "description": "URL of the new threat model"
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThreatModel"
                },
                "example": {
                  "id": "550e8400-e29b-41d4-a716-446655440000",
                  "name": "System Threat Model",
                  "description": "Threats for system X",
                  "created_at": "2025-04-06T12:00:00Z",
                  "modified_at": "2025-04-06T12:00:00Z",
                  "owner": "user@example.com",
                  "created_by": "user@example.com",
                  "threat_model_framework": "STRIDE",
                  "authorization": [
                    {
                      "subject": "user@example.com",
                      "subject_type": "user",
                      "role": "owner"
                    }
                  ],
                  "metadata": [],
                  "documents": [],
                  "repositories": [],
                  "diagrams": [],
                  "threats": []
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}": {
      "get": {
        "tags": [
          "Threat Models"
        ],
        "summary": "Retrieve a threat model",
        "description": "Retrieves the full details of a specific threat model if the user has access",
        "operationId": "getThreatModel",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model to retrieve (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Full threat model details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThreatModel"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Models"
        ],
        "summary": "Update a threat model",
        "description": "Fully updates a threat model; restricted to writer/owner roles",
        "operationId": "updateThreatModel",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model to update (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ThreatModelInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Threat model updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThreatModel"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Models"
        ],
        "summary": "Partially update a threat model",
        "description": "Applies JSON Patch operations to a threat model; restricted to writer/owner roles",
        "operationId": "patchThreatModel",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model to update (UUID)"
          }
        ],
        "requestBody": {
          "content": {
            "application/json-patch+json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "op": {
                      "type": "string",
                      "enum": [
                        "add",
                        "replace",
                        "remove",
                        "move",
                        "copy",
                        "test"
                      ],
                      "description": "Patch operation type",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "path": {
                      "type": "string",
                      "description": "JSON path to target",
                      "pattern": "^(/[^/]*)*$",
                      "maxLength": 512
                    },
                    "value": {
                      "description": "Value to apply",
                      "nullable": true
                    }
                  },
                  "required": [
                    "op",
                    "path"
                  ],
                  "additionalProperties": false
                },
                "maxItems": 1000
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Threat model updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThreatModel"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Models"
        ],
        "summary": "Delete a threat model",
        "description": "Deletes a threat model; restricted to owner role",
        "operationId": "deleteThreatModel",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model to delete (UUID)"
          }
        ],
        "responses": {
          "204": {
            "description": "Threat model deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List threats in a threat model",
        "description": "Returns a paginated list of threats within the specified threat model",
        "operationId": "getThreatModelThreats",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            },
            "description": "Maximum number of threats to return"
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            },
            "description": "Number of threats to skip"
          },
          {
            "name": "sort",
            "in": "query",
            "schema": {
              "type": "string",
              "default": "created_at:desc",
              "maxLength": 1000,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Sort order (e.g., created_at:desc, name:asc, severity:desc, score:desc)"
          },
          {
            "name": "name",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by threat name (partial match)"
          },
          {
            "name": "description",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 1000,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by threat description (partial match)"
          },
          {
            "name": "threat_type",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 1000,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by threat type (exact match)"
          },
          {
            "name": "severity",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "Unknown",
                "None",
                "Low",
                "Medium",
                "High",
                "Critical"
              ],
              "maxLength": 1000,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by severity level (exact match)"
          },
          {
            "name": "priority",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by priority (exact match)"
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Filter by status (exact match)"
          },
          {
            "name": "diagram_id",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            },
            "description": "Filter by diagram ID (exact match)"
          },
          {
            "name": "cell_id",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            },
            "description": "Filter by cell ID (exact match)"
          },
          {
            "name": "score_gt",
            "in": "query",
            "schema": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 10.0
            },
            "description": "Filter threats with score greater than this value"
          },
          {
            "name": "score_lt",
            "in": "query",
            "schema": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 10.0
            },
            "description": "Filter threats with score less than this value"
          },
          {
            "name": "score_eq",
            "in": "query",
            "schema": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 10.0
            },
            "description": "Filter threats with score equal to this value"
          },
          {
            "name": "score_ge",
            "in": "query",
            "schema": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 10.0
            },
            "description": "Filter threats with score greater than or equal to this value"
          },
          {
            "name": "score_le",
            "in": "query",
            "schema": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 10.0
            },
            "description": "Filter threats with score less than or equal to this value"
          },
          {
            "name": "created_after",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date-time",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
              "maxLength": 64
            },
            "description": "Filter threats created after this date (RFC3339 format)"
          },
          {
            "name": "created_before",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date-time",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
              "maxLength": 64
            },
            "description": "Filter threats created before this date (RFC3339 format)"
          },
          {
            "name": "modified_after",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date-time",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
              "maxLength": 64
            },
            "description": "Filter threats modified after this date (RFC3339 format)"
          },
          {
            "name": "modified_before",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date-time",
              "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]{1,6})?(Z|[+-][0-9]{2}:[0-9]{2})$",
              "maxLength": 64
            },
            "description": "Filter threats modified before this date (RFC3339 format)"
          }
        ],
        "responses": {
          "200": {
            "description": "List of threats",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Threat"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "threatList": {
                    "summary": "List of threats with metadata",
                    "value": {
                      "threats": [
                        {
                          "id": "550e8400-e29b-41d4-a716-446655440003",
                          "name": "SQL Injection Vulnerability",
                          "description": "Database injection through malicious SQL queries",
                          "severity": "High",
                          "priority": "urgent",
                          "status": "active",
                          "mitigated": false,
                          "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                          "created_at": "2025-01-15T10:30:00Z",
                          "modified_at": "2025-01-15T14:45:00Z",
                          "metadata": [
                            {
                              "key": "category",
                              "value": "data_validation"
                            },
                            {
                              "key": "owasp_top_10",
                              "value": "A03"
                            },
                            {
                              "key": "assigned_to",
                              "value": "security-team"
                            }
                          ]
                        },
                        {
                          "id": "550e8400-e29b-41d4-a716-446655440004",
                          "name": "Cross-Site Scripting (XSS)",
                          "description": "Client-side script injection vulnerability",
                          "severity": "Medium",
                          "priority": "medium",
                          "status": "identified",
                          "mitigated": false,
                          "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                          "created_at": "2025-01-15T11:00:00Z",
                          "modified_at": "2025-01-15T11:00:00Z",
                          "metadata": [
                            {
                              "key": "category",
                              "value": "input_validation"
                            },
                            {
                              "key": "owasp_top_10",
                              "value": "A07"
                            }
                          ]
                        }
                      ],
                      "total_count": 12
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new threat",
        "description": "Creates a new threat within the specified threat model",
        "operationId": "createThreatModelThreat",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ThreatInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Threat created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Threat"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats/{threat_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific threat",
        "description": "Returns details of a specific threat within the threat model",
        "operationId": "getThreatModelThreat",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Threat details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Threat"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update a threat",
        "description": "Updates a specific threat within the threat model",
        "operationId": "updateThreatModelThreat",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ThreatInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Threat updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Threat"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Partially update a threat",
        "description": "Applies JSON patch operations to a specific threat within the threat model",
        "operationId": "patchThreatModelThreat",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "op": {
                      "type": "string",
                      "enum": [
                        "add",
                        "remove",
                        "replace",
                        "move",
                        "copy",
                        "test"
                      ],
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "path": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "value": {},
                    "from": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    }
                  },
                  "required": [
                    "op",
                    "path"
                  ],
                  "additionalProperties": false
                },
                "maxItems": 1000
              },
              "examples": {
                "updateThreatDetails": {
                  "summary": "Update threat name and severity",
                  "value": [
                    {
                      "op": "replace",
                      "path": "/name",
                      "value": "Updated SQL Injection Threat"
                    },
                    {
                      "op": "replace",
                      "path": "/severity",
                      "value": "Critical"
                    },
                    {
                      "op": "replace",
                      "path": "/description",
                      "value": "Updated description with more details"
                    }
                  ]
                },
                "addMetadata": {
                  "summary": "Add metadata to a threat",
                  "value": [
                    {
                      "op": "add",
                      "path": "/metadata/-",
                      "value": {
                        "key": "priority",
                        "value": "urgent"
                      }
                    },
                    {
                      "op": "add",
                      "path": "/metadata/-",
                      "value": {
                        "key": "assigned_to",
                        "value": "security-team"
                      }
                    }
                  ]
                },
                "updateStatus": {
                  "summary": "Update threat status and mitigation",
                  "value": [
                    {
                      "op": "replace",
                      "path": "/status",
                      "value": "mitigated"
                    },
                    {
                      "op": "replace",
                      "path": "/mitigated",
                      "value": true
                    },
                    {
                      "op": "replace",
                      "path": "/mitigation",
                      "value": "Implemented input validation and parameterized queries"
                    }
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Threat patched successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Threat"
                },
                "examples": {
                  "patchedThreat": {
                    "summary": "Successfully patched threat with updated fields",
                    "value": {
                      "id": "550e8400-e29b-41d4-a716-446655440003",
                      "name": "Updated SQL Injection Threat",
                      "description": "Updated description with more details",
                      "severity": "Critical",
                      "priority": "urgent",
                      "status": "active",
                      "mitigated": false,
                      "threat_model_id": "550e8400-e29b-41d4-a716-446655440000",
                      "created_at": "2025-01-15T10:30:00Z",
                      "modified_at": "2025-01-15T14:45:00Z",
                      "metadata": [
                        {
                          "key": "priority",
                          "value": "urgent"
                        },
                        {
                          "key": "assigned_to",
                          "value": "security-team"
                        },
                        {
                          "key": "cve_reference",
                          "value": "CVE-2024-1234"
                        }
                      ]
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete a threat",
        "description": "Deletes a specific threat from the threat model",
        "operationId": "deleteThreatModelThreat",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          }
        ],
        "responses": {
          "204": {
            "description": "Threat deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats/{threat_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get threat metadata",
        "description": "Returns all metadata key-value pairs for the specified threat",
        "operationId": "getThreatMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Threat metadata list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create threat metadata",
        "description": "Creates new metadata entry for the specified threat",
        "operationId": "createThreatMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats/{threat_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get threat metadata by key",
        "description": "Returns a specific metadata entry by key for the specified threat",
        "operationId": "getThreatMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to retrieve"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update threat metadata by key",
        "description": "Updates a specific metadata entry by key for the specified threat",
        "operationId": "updateThreatMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to update"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "New value for the metadata entry",
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete threat metadata by key",
        "description": "Deletes a specific metadata entry by key for the specified threat",
        "operationId": "deleteThreatMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to delete"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats/{threat_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create threat metadata",
        "description": "Creates multiple metadata entries in a single operation for the specified threat",
        "operationId": "bulkCreateThreatMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entries created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert threat metadata",
        "description": "Creates or updates multiple metadata key-value pairs for the specified threat",
        "operationId": "bulkUpsertThreatMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/threats/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create threats",
        "description": "Creates multiple threats in a single operation for the specified threat model",
        "operationId": "bulkCreateThreatModelThreats",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Threat"
                },
                "maxItems": 20,
                "description": "Array of threats to create"
              },
              "examples": {
                "bulkCreateThreats": {
                  "summary": "Create multiple threats at once",
                  "value": [
                    {
                      "name": "SQL Injection Attack",
                      "description": "Attacker injects malicious SQL code through user input",
                      "impact": "High",
                      "likelihood": "Medium",
                      "risk_rating": "High",
                      "metadata": [
                        {
                          "key": "category",
                          "value": "injection"
                        },
                        {
                          "key": "stride",
                          "value": "tampering"
                        }
                      ]
                    },
                    {
                      "name": "Cross-Site Scripting (XSS)",
                      "description": "Malicious scripts executed in user's browser",
                      "impact": "Medium",
                      "likelihood": "High",
                      "risk_rating": "High",
                      "metadata": [
                        {
                          "key": "category",
                          "value": "xss"
                        },
                        {
                          "key": "stride",
                          "value": "tampering"
                        }
                      ]
                    }
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Threats created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Threat"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk update threats",
        "description": "Updates multiple threats in a single operation for the specified threat model",
        "operationId": "bulkUpdateThreatModelThreats",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Threat"
                },
                "maxItems": 20,
                "description": "Array of threats to update (must include id field)"
              },
              "examples": {
                "bulkUpdateThreats": {
                  "summary": "Update multiple threats at once",
                  "value": [
                    {
                      "id": "750e8400-e29b-41d4-a716-446655440001",
                      "name": "Updated SQL Injection Attack",
                      "description": "Updated description for SQL injection vulnerability",
                      "impact": "High",
                      "likelihood": "Low",
                      "risk_rating": "Medium",
                      "metadata": [
                        {
                          "key": "category",
                          "value": "injection"
                        },
                        {
                          "key": "mitigation",
                          "value": "parameterized-queries"
                        }
                      ]
                    }
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Threats updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Threat"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "summary": "Bulk PATCH threats",
        "description": "Apply JSON Patch operations to multiple threats in a single request",
        "operationId": "bulkPatchThreatModelThreats",
        "tags": [
          "Threats"
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "type": "object",
                "required": [
                  "patches"
                ],
                "properties": {
                  "patches": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": [
                        "id",
                        "operations"
                      ],
                      "properties": {
                        "id": {
                          "type": "string",
                          "format": "uuid",
                          "description": "Threat ID to patch",
                          "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                          "maxLength": 36
                        },
                        "operations": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "required": [
                              "op",
                              "path"
                            ],
                            "properties": {
                              "op": {
                                "type": "string",
                                "enum": [
                                  "add",
                                  "remove",
                                  "replace",
                                  "move",
                                  "copy",
                                  "test"
                                ],
                                "maxLength": 1000,
                                "pattern": "^[\\u0020-\\uFFFF]*$"
                              },
                              "path": {
                                "type": "string",
                                "maxLength": 1000,
                                "pattern": "^[\\u0020-\\uFFFF]*$"
                              },
                              "value": {},
                              "from": {
                                "type": "string",
                                "maxLength": 1000,
                                "pattern": "^[\\u0020-\\uFFFF]*$"
                              }
                            },
                            "additionalProperties": false
                          },
                          "description": "JSON Patch operations to apply",
                          "maxItems": 1000
                        }
                      },
                      "additionalProperties": false
                    },
                    "maxItems": 1000
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully patched threats",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Threat"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "summary": "Bulk DELETE threats",
        "description": "Delete multiple threats in a single request",
        "operationId": "bulkDeleteThreatModelThreats",
        "tags": [
          "Threats"
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "threat_ids",
            "in": "query",
            "required": true,
            "schema": {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uuid",
                "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                "maxLength": 36
              },
              "minItems": 1,
              "maxItems": 20
            },
            "description": "Comma-separated list of threat IDs to delete (UUID format)",
            "style": "form",
            "explode": false
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully deleted threats",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "deleted_count": {
                      "type": "integer",
                      "description": "Number of threats deleted"
                    },
                    "deleted_ids": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "format": "uuid",
                        "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
                        "maxLength": 36
                      },
                      "description": "IDs of deleted threats",
                      "maxItems": 1000
                    }
                  },
                  "additionalProperties": false
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List documents in a threat model",
        "description": "Returns a paginated list of documents within the specified threat model",
        "operationId": "getThreatModelDocuments",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            },
            "description": "Maximum number of documents to return"
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            },
            "description": "Number of documents to skip"
          }
        ],
        "responses": {
          "200": {
            "description": "List of documents",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Document"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "documentList": {
                    "summary": "List of documents with pagination",
                    "value": {
                      "documents": [
                        {
                          "id": "550e8400-e29b-41d4-a716-446655440001",
                          "name": "Security Requirements Document",
                          "description": "Detailed security requirements and compliance standards",
                          "metadata": [
                            {
                              "key": "classification",
                              "value": "internal"
                            },
                            {
                              "key": "version",
                              "value": "1.2"
                            }
                          ],
                          "uri": "https://docs.company.com/security-requirements.pdf"
                        },
                        {
                          "id": "550e8400-e29b-41d4-a716-446655440002",
                          "name": "Architecture Design Document",
                          "description": "System architecture and design specifications",
                          "metadata": [
                            {
                              "key": "classification",
                              "value": "internal"
                            },
                            {
                              "key": "version",
                              "value": "2.0"
                            }
                          ],
                          "uri": "https://docs.company.com/architecture-design.pdf"
                        }
                      ],
                      "total_count": 5
                    }
                  },
                  "emptyList": {
                    "summary": "Empty document list",
                    "value": {
                      "documents": [],
                      "total_count": 0
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new document",
        "description": "Creates a new document within the specified threat model",
        "operationId": "createThreatModelDocument",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DocumentInput"
              },
              "examples": {
                "createDocument": {
                  "summary": "Create a new security document",
                  "value": {
                    "name": "Security Requirements Document",
                    "description": "Detailed security requirements and compliance standards",
                    "metadata": [
                      {
                        "key": "classification",
                        "value": "internal"
                      },
                      {
                        "key": "version",
                        "value": "1.0"
                      },
                      {
                        "key": "owner",
                        "value": "security-team"
                      }
                    ],
                    "uri": "https://docs.company.com/security-requirements.pdf"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Document created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Document"
                },
                "examples": {
                  "createdDocument": {
                    "summary": "Successfully created document with generated ID",
                    "value": {
                      "id": "550e8400-e29b-41d4-a716-446655440001",
                      "name": "Security Requirements Document",
                      "description": "Detailed security requirements and compliance standards",
                      "metadata": [
                        {
                          "key": "classification",
                          "value": "internal"
                        },
                        {
                          "key": "version",
                          "value": "1.0"
                        },
                        {
                          "key": "owner",
                          "value": "security-team"
                        }
                      ],
                      "uri": "https://docs.company.com/security-requirements.pdf"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents/{document_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific document",
        "description": "Returns details of a specific document within the threat model",
        "operationId": "getThreatModelDocument",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the document (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Document details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Document"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update a document",
        "description": "Updates a specific document within the threat model",
        "operationId": "updateThreatModelDocument",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the document (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DocumentInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Document updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Document"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete a document",
        "description": "Deletes a specific document from the threat model",
        "operationId": "deleteThreatModelDocument",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the document (UUID)"
          }
        ],
        "responses": {
          "204": {
            "description": "Document deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "summary": "Partially update document",
        "description": "Apply JSON Patch operations to partially update a document",
        "operationId": "patchThreatModelDocument",
        "tags": [
          "Documents"
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            },
            "description": "Document ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": [
                    "op",
                    "path"
                  ],
                  "properties": {
                    "op": {
                      "type": "string",
                      "enum": [
                        "add",
                        "remove",
                        "replace",
                        "move",
                        "copy",
                        "test"
                      ],
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "path": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "value": {},
                    "from": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    }
                  },
                  "additionalProperties": false
                },
                "maxItems": 1000
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully patched document",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Document"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents/{document_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get document metadata",
        "description": "Returns all metadata key-value pairs for the specified document",
        "operationId": "getDocumentMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the document (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Document metadata list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create document metadata",
        "description": "Creates new metadata entry for the specified document",
        "operationId": "createDocumentMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the document (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents/{document_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get document metadata by key",
        "description": "Returns a specific metadata entry by key for the specified document",
        "operationId": "getDocumentMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the document (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to retrieve"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update document metadata by key",
        "description": "Updates a specific metadata entry by key for the specified document",
        "operationId": "updateDocumentMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the document (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to update"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "New value for the metadata entry",
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete document metadata by key",
        "description": "Deletes a specific metadata entry by key for the specified document",
        "operationId": "deleteDocumentMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the document (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to delete"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents/{document_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create document metadata",
        "description": "Creates multiple metadata entries in a single operation for the specified document",
        "operationId": "bulkCreateDocumentMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the document (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entries created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert document metadata",
        "description": "Creates or updates multiple metadata key-value pairs for the specified document",
        "operationId": "bulkUpsertDocumentMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "document_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the document (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/documents/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create documents",
        "description": "Creates multiple documents in a single operation for the specified threat model",
        "operationId": "bulkCreateThreatModelDocuments",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Document"
                },
                "maxItems": 20,
                "description": "Array of documents to create"
              },
              "examples": {
                "bulkCreateDocuments": {
                  "summary": "Create multiple documents at once",
                  "value": [
                    {
                      "name": "Architecture Document",
                      "description": "System architecture documentation",
                      "metadata": [
                        {
                          "key": "type",
                          "value": "architecture"
                        },
                        {
                          "key": "version",
                          "value": "2.1"
                        }
                      ],
                      "uri": "https://docs.company.com/architecture.pdf"
                    },
                    {
                      "name": "Security Requirements",
                      "description": "Security requirements and compliance standards",
                      "metadata": [
                        {
                          "key": "classification",
                          "value": "internal"
                        },
                        {
                          "key": "department",
                          "value": "security"
                        }
                      ],
                      "uri": "https://docs.company.com/security.pdf"
                    }
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Documents created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Document"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "bulkCreatedDocuments": {
                    "summary": "Successfully created documents with generated IDs",
                    "value": [
                      {
                        "id": "550e8400-e29b-41d4-a716-446655440001",
                        "name": "Architecture Document",
                        "description": "System architecture documentation",
                        "metadata": [
                          {
                            "key": "type",
                            "value": "architecture"
                          },
                          {
                            "key": "version",
                            "value": "2.1"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://docs.company.com/architecture.pdf"
                      },
                      {
                        "id": "550e8400-e29b-41d4-a716-446655440002",
                        "name": "Security Requirements",
                        "description": "Security requirements and compliance standards",
                        "metadata": [
                          {
                            "key": "classification",
                            "value": "internal"
                          },
                          {
                            "key": "department",
                            "value": "security"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://docs.company.com/security.pdf"
                      }
                    ]
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert documents",
        "description": "Create or update multiple documents in a single request",
        "operationId": "bulkUpsertThreatModelDocuments",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Document"
                },
                "maxItems": 20,
                "description": "Array of documents to create"
              },
              "examples": {
                "bulkCreateDocuments": {
                  "summary": "Create multiple documents at once",
                  "value": [
                    {
                      "name": "Architecture Document",
                      "description": "System architecture documentation",
                      "metadata": [
                        {
                          "key": "type",
                          "value": "architecture"
                        },
                        {
                          "key": "version",
                          "value": "2.1"
                        }
                      ],
                      "uri": "https://docs.company.com/architecture.pdf"
                    },
                    {
                      "name": "Security Requirements",
                      "description": "Security requirements and compliance standards",
                      "metadata": [
                        {
                          "key": "classification",
                          "value": "internal"
                        },
                        {
                          "key": "department",
                          "value": "security"
                        }
                      ],
                      "uri": "https://docs.company.com/security.pdf"
                    }
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Documents created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Document"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "bulkCreatedDocuments": {
                    "summary": "Successfully created documents with generated IDs",
                    "value": [
                      {
                        "id": "550e8400-e29b-41d4-a716-446655440001",
                        "name": "Architecture Document",
                        "description": "System architecture documentation",
                        "metadata": [
                          {
                            "key": "type",
                            "value": "architecture"
                          },
                          {
                            "key": "version",
                            "value": "2.1"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://docs.company.com/architecture.pdf"
                      },
                      {
                        "id": "550e8400-e29b-41d4-a716-446655440002",
                        "name": "Security Requirements",
                        "description": "Security requirements and compliance standards",
                        "metadata": [
                          {
                            "key": "classification",
                            "value": "internal"
                          },
                          {
                            "key": "department",
                            "value": "security"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://docs.company.com/security.pdf"
                      }
                    ]
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List sources in a threat model",
        "description": "Returns a paginated list of source code references within the specified threat model",
        "operationId": "getThreatModelRepositories",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            },
            "description": "Maximum number of sources to return"
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            },
            "description": "Number of sources to skip"
          }
        ],
        "responses": {
          "200": {
            "description": "List of source code references",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Repository"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "sourceList": {
                    "summary": "List of source code references",
                    "value": {
                      "sources": [
                        {
                          "id": "550e8400-e29b-41d4-a716-446655440010",
                          "name": "Authentication Service",
                          "type": "git",
                          "description": "Core authentication and authorization service",
                          "parameters": {
                            "refType": "branch",
                            "refValue": "main"
                          },
                          "metadata": [
                            {
                              "key": "language",
                              "value": "go"
                            },
                            {
                              "key": "coverage",
                              "value": "85%"
                            },
                            {
                              "key": "security_scan",
                              "value": "passed"
                            }
                          ],
                          "uri": "https://github.com/company/auth-service"
                        },
                        {
                          "id": "550e8400-e29b-41d4-a716-446655440011",
                          "name": "Database Layer",
                          "type": "git",
                          "description": "Database access layer and ORM implementation",
                          "parameters": {
                            "refType": "tag",
                            "refValue": "v1.2.3"
                          },
                          "metadata": [
                            {
                              "key": "language",
                              "value": "go"
                            },
                            {
                              "key": "database",
                              "value": "postgresql"
                            }
                          ],
                          "uri": "https://github.com/company/db-layer"
                        }
                      ],
                      "total_count": 3
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new source reference",
        "description": "Creates a new source code reference within the specified threat model",
        "operationId": "createThreatModelRepository",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RepositoryInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Source reference created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Repository"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories/{repository_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific source reference",
        "description": "Returns details of a specific source code reference within the threat model",
        "operationId": "getThreatModelRepository",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the source reference (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Source reference details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Repository"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update a source reference",
        "description": "Updates a specific source code reference within the threat model",
        "operationId": "updateThreatModelRepository",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the source reference (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RepositoryInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Source reference updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Repository"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete a source reference",
        "description": "Deletes a specific source code reference from the threat model",
        "operationId": "deleteThreatModelRepository",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the source reference (UUID)"
          }
        ],
        "responses": {
          "204": {
            "description": "Source reference deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "summary": "Partially update repository",
        "description": "Apply JSON Patch operations to partially update a repository",
        "operationId": "patchThreatModelRepository",
        "tags": [
          "Repositories"
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            },
            "description": "Repository ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": [
                    "op",
                    "path"
                  ],
                  "properties": {
                    "op": {
                      "type": "string",
                      "enum": [
                        "add",
                        "remove",
                        "replace",
                        "move",
                        "copy",
                        "test"
                      ],
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "path": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "value": {},
                    "from": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    }
                  },
                  "additionalProperties": false
                },
                "maxItems": 1000
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully patched repository",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Repository"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories/{repository_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get source metadata",
        "description": "Returns all metadata key-value pairs for the specified source reference",
        "operationId": "getRepositoryMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the source reference (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Source metadata list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create source metadata",
        "description": "Creates new metadata entry for the specified source reference",
        "operationId": "createRepositoryMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the source reference (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories/{repository_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get source metadata by key",
        "description": "Returns a specific metadata entry by key for the specified source reference",
        "operationId": "getRepositoryMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the source reference (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to retrieve"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update source metadata by key",
        "description": "Updates a specific metadata entry by key for the specified source reference",
        "operationId": "updateRepositoryMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the source reference (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to update"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "New value for the metadata entry",
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete source metadata by key",
        "description": "Deletes a specific metadata entry by key for the specified source reference",
        "operationId": "deleteRepositoryMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the source reference (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to delete"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories/{repository_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create source metadata",
        "description": "Creates multiple metadata entries in a single operation for the specified source reference",
        "operationId": "bulkCreateRepositoryMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the source reference (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entries created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert repository metadata",
        "description": "Creates or updates multiple metadata key-value pairs for the specified repository",
        "operationId": "bulkUpsertRepositoryMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "repository_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the source reference (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/repositories/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create sources",
        "description": "Creates multiple source references in a single operation for the specified threat model",
        "operationId": "bulkCreateThreatModelRepositories",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Repository"
                },
                "maxItems": 20,
                "description": "Array of source references to create"
              },
              "examples": {
                "bulkCreateSources": {
                  "summary": "Create multiple source references at once",
                  "value": [
                    {
                      "name": "User Authentication Module",
                      "description": "Core user authentication logic",
                      "metadata": [
                        {
                          "key": "language",
                          "value": "go"
                        },
                        {
                          "key": "maintainer",
                          "value": "security-team"
                        }
                      ],
                      "uri": "https://github.com/company/repo/blob/main/oauth2/user.go"
                    },
                    {
                      "name": "Database Connection Pool",
                      "description": "Database connection management",
                      "metadata": [
                        {
                          "key": "type",
                          "value": "infrastructure"
                        },
                        {
                          "key": "criticality",
                          "value": "high"
                        }
                      ],
                      "uri": "https://github.com/company/repo/blob/main/db/pool.go"
                    }
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Sources created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Repository"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "bulkCreatedSources": {
                    "summary": "Successfully created sources with generated IDs",
                    "value": [
                      {
                        "id": "650e8400-e29b-41d4-a716-446655440001",
                        "name": "User Authentication Module",
                        "description": "Core user authentication logic",
                        "metadata": [
                          {
                            "key": "language",
                            "value": "go"
                          },
                          {
                            "key": "maintainer",
                            "value": "security-team"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://github.com/company/repo/blob/main/oauth2/user.go"
                      },
                      {
                        "id": "650e8400-e29b-41d4-a716-446655440002",
                        "name": "Database Connection Pool",
                        "description": "Database connection management",
                        "metadata": [
                          {
                            "key": "type",
                            "value": "infrastructure"
                          },
                          {
                            "key": "criticality",
                            "value": "high"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://github.com/company/repo/blob/main/db/pool.go"
                      }
                    ]
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert repositories",
        "description": "Create or update multiple repositories in a single request",
        "operationId": "bulkUpsertThreatModelRepositories",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Repository"
                },
                "maxItems": 20,
                "description": "Array of source references to create"
              },
              "examples": {
                "bulkCreateSources": {
                  "summary": "Create multiple source references at once",
                  "value": [
                    {
                      "name": "User Authentication Module",
                      "description": "Core user authentication logic",
                      "metadata": [
                        {
                          "key": "language",
                          "value": "go"
                        },
                        {
                          "key": "maintainer",
                          "value": "security-team"
                        }
                      ],
                      "uri": "https://github.com/company/repo/blob/main/oauth2/user.go"
                    },
                    {
                      "name": "Database Connection Pool",
                      "description": "Database connection management",
                      "metadata": [
                        {
                          "key": "type",
                          "value": "infrastructure"
                        },
                        {
                          "key": "criticality",
                          "value": "high"
                        }
                      ],
                      "uri": "https://github.com/company/repo/blob/main/db/pool.go"
                    }
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Sources created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Repository"
                  },
                  "maxItems": 1000
                },
                "examples": {
                  "bulkCreatedSources": {
                    "summary": "Successfully created sources with generated IDs",
                    "value": [
                      {
                        "id": "650e8400-e29b-41d4-a716-446655440001",
                        "name": "User Authentication Module",
                        "description": "Core user authentication logic",
                        "metadata": [
                          {
                            "key": "language",
                            "value": "go"
                          },
                          {
                            "key": "maintainer",
                            "value": "security-team"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://github.com/company/repo/blob/main/oauth2/user.go"
                      },
                      {
                        "id": "650e8400-e29b-41d4-a716-446655440002",
                        "name": "Database Connection Pool",
                        "description": "Database connection management",
                        "metadata": [
                          {
                            "key": "type",
                            "value": "infrastructure"
                          },
                          {
                            "key": "criticality",
                            "value": "high"
                          }
                        ],
                        "created_at": "2025-04-06T12:00:00Z",
                        "modified_at": "2025-04-06T12:00:00Z",
                        "uri": "https://github.com/company/repo/blob/main/db/pool.go"
                      }
                    ]
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get threat model metadata",
        "description": "Returns all metadata key-value pairs for the specified threat model",
        "operationId": "getThreatModelMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Threat model metadata list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create threat model metadata",
        "description": "Creates new metadata entry for the specified threat model",
        "operationId": "createThreatModelMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get threat model metadata by key",
        "description": "Returns a specific metadata entry by key for the specified threat model",
        "operationId": "getThreatModelMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to retrieve"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update threat model metadata by key",
        "description": "Updates a specific metadata entry by key for the specified threat model",
        "operationId": "updateThreatModelMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to update"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "New value for the metadata entry",
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete threat model metadata by key",
        "description": "Deletes a specific metadata entry by key for the specified threat model",
        "operationId": "deleteThreatModelMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to delete"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create threat model metadata",
        "description": "Creates multiple metadata entries in a single operation for the specified threat model",
        "operationId": "bulkCreateThreatModelMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entries created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert threat model metadata",
        "description": "Creates or updates multiple metadata key-value pairs for the specified threat model",
        "operationId": "bulkUpsertThreatModelMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List threat model diagrams",
        "description": "Returns all diagrams associated with a specific threat model",
        "operationId": "getThreatModelDiagrams",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            },
            "description": "Maximum number of items to return"
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            },
            "description": "Number of items to skip"
          }
        ],
        "responses": {
          "200": {
            "description": "List of diagrams",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/DiagramListItem"
                  },
                  "maxItems": 1000
                },
                "example": [
                  {
                    "id": "123e4567-e89b-12d3-a456-426614174000",
                    "name": "System Architecture Diagram",
                    "type": "DFD-1.0.0"
                  },
                  {
                    "id": "456e7890-e89b-12d3-a456-426614174001",
                    "name": "Data Flow Diagram",
                    "type": "DFD-1.0.0"
                  }
                ]
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new diagram",
        "description": "Creates a new diagram within the specified threat model",
        "operationId": "createThreatModelDiagram",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDiagramRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Diagram created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DfdDiagram"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific diagram",
        "description": "Retrieves a specific diagram from the threat model",
        "operationId": "getThreatModelDiagram",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Diagram details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DfdDiagram"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update a diagram",
        "description": "Completely replaces a diagram with new data. Use DfdDiagramInput schema which excludes readOnly fields (id, created_at, modified_at, update_vector).",
        "operationId": "updateThreatModelDiagram",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DfdDiagramInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Diagram updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DfdDiagram"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Partially update a diagram",
        "description": "Apply JSON Patch operations to update specific parts of a diagram",
        "operationId": "patchThreatModelDiagram",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "op": {
                      "type": "string",
                      "enum": [
                        "add",
                        "remove",
                        "replace",
                        "move",
                        "copy",
                        "test"
                      ],
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "path": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "value": {},
                    "from": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    }
                  },
                  "required": [
                    "op",
                    "path"
                  ],
                  "additionalProperties": false
                },
                "maxItems": 10000
              },
              "examples": {
                "updateName": {
                  "summary": "Update diagram name",
                  "value": [
                    {
                      "op": "replace",
                      "path": "/name",
                      "value": "Updated Diagram Name"
                    }
                  ]
                },
                "addCell": {
                  "summary": "Add a new cell to the diagram",
                  "value": [
                    {
                      "op": "add",
                      "path": "/cells/-",
                      "value": {
                        "id": "new-cell-id",
                        "shape": "process",
                        "x": 100,
                        "y": 100,
                        "width": 120,
                        "height": 60,
                        "label": "New Process"
                      }
                    }
                  ]
                },
                "addMetadata": {
                  "summary": "Add metadata to diagram",
                  "value": [
                    {
                      "op": "add",
                      "path": "/metadata/-",
                      "value": {
                        "key": "version",
                        "value": "2.0"
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Diagram updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DfdDiagram"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "422": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete a diagram",
        "description": "Permanently removes a diagram from the threat model",
        "operationId": "deleteThreatModelDiagram",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "responses": {
          "204": {
            "description": "Diagram deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}/collaborate": {
      "get": {
        "tags": [
          "Collaboration"
        ],
        "summary": "Get diagram collaboration session",
        "description": "Retrieves the current collaboration session details for a diagram. The session payload indicates who has been authorized to the session, not who is currently active in the WebSocket session. The 200 status indicates successful retrieval - clients must NOT evaluate the payload to determine session status.",
        "operationId": "getDiagramCollaborationSession",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Collaboration session details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CollaborationSession"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Collaboration"
        ],
        "summary": "Create diagram collaboration session",
        "description": "Creates a new collaboration session for real-time diagram editing. Only one collaboration session can exist per diagram at a time. If a session already exists, returns 409 with a link to join the existing session.",
        "operationId": "createDiagramCollaborationSession",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "responses": {
          "201": {
            "description": "Collaboration session created successfully. The 201 status indicates successful creation - clients must NOT evaluate the payload to determine success.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CollaborationSession"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "409": {
            "description": "Collaboration session already exists for this diagram",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "error",
                    "join_url"
                  ],
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message indicating session already exists",
                      "maxLength": 1000
                    },
                    "join_url": {
                      "type": "string",
                      "description": "URL to join the existing collaboration session",
                      "example": "/threat_models/{threat_model_id}/diagrams/{diagram_id}/collaborate",
                      "pattern": "^(https?|wss?|file)://[^\\s]*$",
                      "maxLength": 1024
                    }
                  },
                  "additionalProperties": false
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Collaboration"
        ],
        "summary": "End diagram collaboration session",
        "description": "Terminates the active collaboration session for a diagram",
        "operationId": "endDiagramCollaborationSession",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "responses": {
          "204": {
            "description": "Collaboration session ended successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get diagram metadata",
        "description": "Retrieves all metadata entries for the specified diagram",
        "operationId": "getDiagramMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "List of metadata entries",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create diagram metadata",
        "description": "Creates a new metadata entry for the specified diagram",
        "operationId": "createDiagramMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get diagram metadata by key",
        "description": "Retrieves a specific metadata entry for the diagram by key",
        "operationId": "getDiagramMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to retrieve"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update diagram metadata by key",
        "description": "Updates or creates a metadata entry for the diagram with the specified key",
        "operationId": "updateDiagramMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to update"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "maxLength": 1024,
                    "description": "Metadata value",
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete diagram metadata by key",
        "description": "Removes a specific metadata entry for the diagram by key",
        "operationId": "deleteDiagramMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 256,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to delete"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/diagrams/{diagram_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create diagram metadata",
        "description": "Creates multiple metadata entries in a single operation for the specified diagram",
        "operationId": "bulkCreateDiagramMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entries created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert diagram metadata",
        "description": "Creates or updates multiple metadata key-value pairs for the specified diagram",
        "operationId": "bulkUpsertDiagramMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "diagram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the diagram (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 20
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/users/me": {
      "delete": {
        "summary": "Delete authenticated user account and all data",
        "description": "Two-step deletion process:\n1. First call (no challenge parameter) - Returns challenge string\n2. Second call (with challenge parameter) - Confirms deletion\n\nOwnership behavior:\n- Shared threat models: Transfers ownership to another owner from authorization list\n- Unshared threat models: Deletes completely along with all child resources",
        "operationId": "deleteUserAccount",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "challenge",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "maxLength": 1000,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Challenge string from first request (step 2 only). Must match exactly."
          }
        ],
        "responses": {
          "200": {
            "description": "Challenge issued (step 1)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeletionChallenge"
                }
              }
            }
          },
          "204": {
            "description": "User deleted successfully (step 2)"
          },
          "400": {
            "description": "Invalid or expired challenge, or challenge provided on first request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - valid JWT token required",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Get current user profile",
        "description": "Returns detailed information about the currently authenticated user including groups and identity provider",
        "operationId": "getCurrentUserProfile",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Current user profile",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                },
                "example": {
                  "user_id": "provider-user-123",
                  "email": "alice@example.com",
                  "name": "Alice Smith",
                  "picture": "https://example.com/avatar.jpg",
                  "idp": "saml_okta",
                  "groups": [
                    "security-team",
                    "developers"
                  ],
                  "last_login": "2024-01-15T10:30:00Z"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/notes": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List notes in a threat model",
        "description": "Returns a paginated list of notes within the specified threat model",
        "operationId": "getThreatModelNotes",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            },
            "description": "Maximum number of notes to return"
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            },
            "description": "Number of notes to skip"
          }
        ],
        "responses": {
          "200": {
            "description": "List of notes",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/NoteListItem"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new note",
        "description": "Creates a new note within the specified threat model",
        "operationId": "createThreatModelNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NoteInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Note created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Note"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/notes/{note_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific note",
        "description": "Returns details of a specific note within the threat model",
        "operationId": "getThreatModelNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the note (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Note details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Note"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update a note",
        "description": "Updates a specific note within the threat model",
        "operationId": "updateThreatModelNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the note (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NoteInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Note updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Note"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete a note",
        "description": "Deletes a specific note from the threat model",
        "operationId": "deleteThreatModelNote",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the note (UUID)"
          }
        ],
        "responses": {
          "204": {
            "description": "Note deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "summary": "Partially update note",
        "description": "Apply JSON Patch operations to partially update a note",
        "operationId": "patchThreatModelNote",
        "tags": [
          "Notes"
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            },
            "description": "Note ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": [
                    "op",
                    "path"
                  ],
                  "properties": {
                    "op": {
                      "type": "string",
                      "enum": [
                        "add",
                        "remove",
                        "replace",
                        "move",
                        "copy",
                        "test"
                      ],
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "path": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "value": {},
                    "from": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    }
                  },
                  "additionalProperties": false
                },
                "maxItems": 1000
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully patched note",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Note"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/notes/{note_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get note metadata",
        "description": "Returns all metadata key-value pairs for the specified note",
        "operationId": "getNoteMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the note (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Note metadata list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create note metadata",
        "description": "Creates new metadata entry for the specified note",
        "operationId": "createNoteMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the note (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata entry created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/notes/{note_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get note metadata by key",
        "description": "Returns a specific metadata entry by key for the specified note",
        "operationId": "getNoteMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the note (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to retrieve"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata entry",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update note metadata by key",
        "description": "Updates a specific metadata entry by key for the specified note",
        "operationId": "updateNoteMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the note (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to update"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "New value for the metadata entry",
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata entry updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete note metadata by key",
        "description": "Deletes a specific metadata entry by key for the specified note",
        "operationId": "deleteNoteMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the note (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 255,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key to delete"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata entry deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/notes/{note_id}/metadata/bulk": {
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk update note metadata",
        "description": "Updates multiple metadata entries for the specified note in a single operation",
        "operationId": "bulkUpdateNoteMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the note (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata entries updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create note metadata",
        "description": "Creates multiple metadata key-value pairs for the specified note",
        "operationId": "bulkCreateNoteMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "note_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the note (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "List assets in a threat model",
        "description": "Returns a paginated list of assets within the specified threat model",
        "operationId": "getThreatModelAssets",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            },
            "description": "Maximum number of assets to return"
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            },
            "description": "Number of assets to skip"
          }
        ],
        "responses": {
          "200": {
            "description": "List of assets",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Asset"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Create a new asset",
        "description": "Creates a new asset within the specified threat model",
        "operationId": "createThreatModelAsset",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AssetInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Asset created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Asset"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create assets",
        "description": "Creates multiple assets within the specified threat model (maximum 50 per request)",
        "operationId": "bulkCreateThreatModelAssets",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Asset"
                },
                "maxItems": 50
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Assets created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Asset"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert assets",
        "description": "Create or update multiple assets in a single request",
        "operationId": "bulkUpsertThreatModelAssets",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Asset"
                },
                "maxItems": 50
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Assets created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Asset"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets/{asset_id}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get a specific asset",
        "description": "Returns a single asset by its ID",
        "operationId": "getThreatModelAsset",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the asset (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Asset details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Asset"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update an asset",
        "description": "Updates an existing asset within the specified threat model",
        "operationId": "updateThreatModelAsset",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the asset (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AssetInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Asset updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Asset"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete an asset",
        "description": "Deletes an asset from the specified threat model",
        "operationId": "deleteThreatModelAsset",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the asset (UUID)"
          }
        ],
        "responses": {
          "204": {
            "description": "Asset deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "patch": {
        "summary": "Partially update asset",
        "description": "Apply JSON Patch operations to partially update a asset",
        "operationId": "patchThreatModelAsset",
        "tags": [
          "Assets"
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            },
            "description": "Asset ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json-patch+json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "required": [
                    "op",
                    "path"
                  ],
                  "properties": {
                    "op": {
                      "type": "string",
                      "enum": [
                        "add",
                        "remove",
                        "replace",
                        "move",
                        "copy",
                        "test"
                      ],
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "path": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    },
                    "value": {},
                    "from": {
                      "type": "string",
                      "maxLength": 1000,
                      "pattern": "^[\\u0020-\\uFFFF]*$"
                    }
                  },
                  "additionalProperties": false
                },
                "maxItems": 1000
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully patched asset",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Asset"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets/{asset_id}/metadata": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get all metadata for an asset",
        "description": "Returns all metadata key-value pairs for the specified asset",
        "operationId": "getThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the asset (UUID)"
          }
        ],
        "responses": {
          "200": {
            "description": "Asset metadata",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Add metadata to an asset",
        "description": "Adds a new metadata key-value pair to the specified asset",
        "operationId": "createThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the asset (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets/{asset_id}/metadata/{key}": {
      "get": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Get specific metadata for an asset",
        "description": "Returns a single metadata value by its key",
        "operationId": "getThreatModelAssetMetadataByKey",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the asset (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 128,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key"
          }
        ],
        "responses": {
          "200": {
            "description": "Metadata value",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Update asset metadata",
        "description": "Updates an existing metadata value by its key",
        "operationId": "updateThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the asset (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 128,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Metadata"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Metadata"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "delete": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Delete asset metadata",
        "description": "Deletes a metadata key-value pair from the specified asset",
        "operationId": "deleteThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the asset (UUID)"
          },
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "maxLength": 128,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            },
            "description": "Metadata key"
          }
        ],
        "responses": {
          "204": {
            "description": "Metadata deleted successfully"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/threat_models/{threat_model_id}/assets/{asset_id}/metadata/bulk": {
      "post": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk create asset metadata",
        "description": "Creates multiple metadata key-value pairs for the specified asset",
        "operationId": "bulkCreateThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the asset (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Metadata created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      },
      "put": {
        "tags": [
          "Threat Model Sub-Resources"
        ],
        "summary": "Bulk upsert asset metadata",
        "description": "Creates or updates multiple metadata key-value pairs for the specified asset",
        "operationId": "bulkUpsertThreatModelAssetMetadata",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the threat model (UUID)"
          },
          {
            "name": "asset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "maxLength": 36,
              "pattern": "^[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*-[0-9a-fA-F]*$"
            },
            "description": "Unique identifier of the asset (UUID)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Metadata"
                },
                "maxItems": 100
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata upserted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Metadata"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error"
          },
          "401": {
            "$ref": "#/components/responses/Error"
          },
          "403": {
            "$ref": "#/components/responses/Error"
          },
          "404": {
            "$ref": "#/components/responses/Error"
          },
          "500": {
            "$ref": "#/components/responses/Error"
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/saml/metadata": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Get SAML service provider metadata",
        "description": "Returns the SP metadata XML for SAML configuration",
        "operationId": "getSAMLMetadata",
        "responses": {
          "200": {
            "description": "SAML metadata XML",
            "content": {
              "application/samlmetadata+xml": {
                "schema": {
                  "type": "string",
                  "format": "xml",
                  "maxLength": 1000
                }
              }
            }
          },
          "500": {
            "description": "Failed to generate metadata",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "scope": "user",
          "tier": "resource-operations",
          "limits": [
            {
              "type": "requests_per_minute",
              "default": 100,
              "configurable": true,
              "quota_source": "user_api_quotas"
            }
          ]
        }
      }
    },
    "/saml/login": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "Initiate SAML authentication",
        "description": "Starts SAML authentication flow by redirecting to IdP",
        "operationId": "initiateSAMLLogin",
        "parameters": [
          {
            "name": "client_callback",
            "in": "query",
            "required": false,
            "description": "Client callback URL to redirect after authentication",
            "schema": {
              "type": "string",
              "format": "uri",
              "pattern": "^[a-zA-Z][a-zA-Z0-9+.-]*://[^\\s]*$",
              "maxLength": 1000
            }
          }
        ],
        "responses": {
          "302": {
            "description": "Redirect to SAML IdP for authentication"
          },
          "500": {
            "description": "Failed to initiate SAML authentication",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        }
      }
    },
    "/saml/acs": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "SAML Assertion Consumer Service",
        "description": "Processes SAML responses from IdP after authentication",
        "operationId": "processSAMLResponse",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "SAMLResponse": {
                    "type": "string",
                    "description": "Base64-encoded SAML response",
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  },
                  "RelayState": {
                    "type": "string",
                    "description": "State parameter for CSRF protection",
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  }
                },
                "required": [
                  "SAMLResponse"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Authentication successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokenResponse"
                }
              }
            }
          },
          "302": {
            "description": "Redirect to client callback with token"
          },
          "400": {
            "description": "Invalid SAML response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        }
      }
    },
    "/saml/slo": {
      "get": {
        "tags": [
          "Authentication"
        ],
        "summary": "SAML Single Logout",
        "description": "Handles SAML logout requests from IdP",
        "operationId": "processSAMLLogout",
        "parameters": [
          {
            "name": "SAMLRequest",
            "in": "query",
            "required": true,
            "description": "Base64-encoded SAML logout request",
            "schema": {
              "type": "string",
              "maxLength": 1000,
              "pattern": "^[\\u0020-\\uFFFF]*$"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Logout successful",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "maxLength": 1000
                    }
                  },
                  "additionalProperties": false
                }
              }
            }
          },
          "400": {
            "description": "Invalid SAML logout request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        }
      },
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "SAML Single Logout (POST)",
        "description": "Handles SAML logout requests from IdP via POST",
        "operationId": "processSAMLLogoutPost",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "SAMLRequest": {
                    "type": "string",
                    "description": "Base64-encoded SAML logout request",
                    "maxLength": 1000,
                    "pattern": "^[\\u0020-\\uFFFF]*$"
                  }
                },
                "required": [
                  "SAMLRequest"
                ],
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Logout successful",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "maxLength": 1000
                    }
                  },
                  "additionalProperties": false
                }
              }
            }
          },
          "400": {
            "description": "Invalid SAML logout request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "security": [],
        "x-rate-limit": {
          "strategy": "multi-scope",
          "tier": "auth-flows",
          "scopes": [
            {
              "name": "session",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 5,
                  "configurable": false,
                  "tracking_method": "OAuth state parameter or SAML request ID"
                }
              ]
            },
            {
              "name": "ip",
              "limits": [
                {
                  "type": "requests_per_minute",
                  "default": 100,
                  "configurable": false,
                  "tracking_method": "Source IP address"
                }
              ]
            },
            {
              "name": "user_identifier",
              "limits": [
                {
                  "type": "attempts_per_hour",
                  "default": 10,
                  "configurable": false,
                  "tracking_method": "login_hint parameter or email address"
                }
              ]
            }
          ],
          "enforcement": "Most restrictive limit applies"
        }
      }
    },
    "/webhooks/subscriptions": {
      "get": {
        "summary": "List webhook subscriptions",
        "description": "List all webhook subscriptions owned by the authenticated user. Optionally filter by threat_model_id.",
        "operationId": "listWebhookSubscriptions",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "threat_model_id",
            "in": "query",
            "description": "Filter subscriptions by threat model ID",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Pagination offset",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Pagination limit",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of webhook subscriptions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/WebhookSubscription"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      },
      "post": {
        "summary": "Create webhook subscription",
        "description": "Create a new webhook subscription. The subscription will be in pending_verification status until the challenge is completed.",
        "operationId": "createWebhookSubscription",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookSubscriptionInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Webhook subscription created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscription"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "description": "Too Many Requests",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      }
    },
    "/webhooks/subscriptions/{webhook_id}": {
      "get": {
        "summary": "Get webhook subscription",
        "description": "Get a specific webhook subscription by ID",
        "operationId": "getWebhookSubscription",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "webhook_id",
            "in": "path",
            "description": "Webhook subscription ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Webhook subscription details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscription"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      },
      "delete": {
        "summary": "Delete webhook subscription",
        "description": "Delete a webhook subscription. Only the owner can delete a subscription.",
        "operationId": "deleteWebhookSubscription",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "webhook_id",
            "in": "path",
            "description": "Webhook subscription ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Webhook subscription deleted"
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      }
    },
    "/webhooks/subscriptions/{webhook_id}/test": {
      "post": {
        "summary": "Test webhook subscription",
        "description": "Send a test event to the webhook URL to verify it's working correctly",
        "operationId": "testWebhookSubscription",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "webhook_id",
            "in": "path",
            "description": "Webhook subscription ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            }
          }
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookTestRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Test webhook sent",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookTestResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      }
    },
    "/webhooks/deliveries": {
      "get": {
        "summary": "List webhook deliveries",
        "description": "List webhook deliveries for the authenticated user's subscriptions",
        "operationId": "listWebhookDeliveries",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "subscription_id",
            "in": "query",
            "description": "Filter by subscription ID",
            "required": false,
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Pagination offset",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Pagination limit",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of webhook deliveries",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/WebhookDelivery"
                  },
                  "maxItems": 1000
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      }
    },
    "/webhooks/deliveries/{delivery_id}": {
      "get": {
        "summary": "Get webhook delivery",
        "description": "Get details of a specific webhook delivery",
        "operationId": "getWebhookDelivery",
        "tags": [
          "webhooks"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "delivery_id",
            "in": "path",
            "description": "Webhook delivery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "pattern": "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$",
              "maxLength": 36
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Webhook delivery details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookDelivery"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "429": {
            "$ref": "#/components/responses/TooManyRequests"
          }
        },
        "x-rate-limit": {
          "scope": "user",
          "tier": "webhooks",
          "limits": [
            {
              "type": "subscription_requests_per_minute",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_minute"
            },
            {
              "type": "subscription_requests_per_day",
              "default": 20,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscription_requests_per_day"
            },
            {
              "type": "events_per_minute",
              "default": 12,
              "configurable": true,
              "quota_source": "webhook_quotas.max_events_per_minute"
            },
            {
              "type": "max_subscriptions",
              "default": 10,
              "configurable": true,
              "quota_source": "webhook_quotas.max_subscriptions"
            }
          ]
        }
      }
    }
  },
  "tags": [
    {
      "name": "webhooks",
      "description": "Webhook subscription management"
    }
  ]
}