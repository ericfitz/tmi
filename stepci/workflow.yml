version: "1.0"
name: TMI (Threat Modeling Improved) API
config:
  http:
    baseURL: http://localhost:8080
tests:
  default:
    name: Default
    steps:
      - id: getApiInfo
        name: Get API information
        http:
          url: /
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/ApiInfo"
      - id: getAuthProviders
        name: List available OAuth providers
        http:
          url: /auth/providers
          method: GET
          check:
            status: 200
            schema:
              type: object
              properties:
                providers:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                        description: Provider identifier
                      name:
                        type: string
                        description: Display name of the provider
                      icon:
                        type: string
                        description: Icon identifier for the provider
                      auth_url:
                        type: string
                        format: uri
                        description: TMI authorization endpoint URL for this provider
                      redirect_uri:
                        type: string
                        format: uri
                        description: OAuth callback URI configured for this provider
                      client_id:
                        type: string
                        description: OAuth client ID for this provider
                    required:
                      - id
                      - name
                      - icon
                      - auth_url
                      - redirect_uri
                      - client_id
              required:
                - providers
            json:
              providers:
                - id: google
                  name: Google
                  icon: fa-brands fa-google
                  auth_url: http://localhost:8080/auth/login/google
                  redirect_uri: http://localhost:8080/auth/callback
                  client_id: >-
                    675196260523-e8ppeu62pv222jhnpebe929b2tgl2jm0.apps.googleusercontent.com
                - id: github
                  name: GitHub
                  icon: fa-brands fa-github
                  auth_url: http://localhost:8080/auth/login/github
                  redirect_uri: http://localhost:8080/auth/callback
                  client_id: your-github-client-id
                - id: microsoft
                  name: Microsoft
                  icon: fa-brands fa-microsoft
                  auth_url: http://localhost:8080/auth/login/microsoft
                  redirect_uri: http://localhost:8080/auth/callback
                  client_id: your-microsoft-client-id
      - id: authorizeOAuthProvider
        name: Get authentication token using fallback method
        http:
          url: /auth/token/test
          method: POST
          headers:
            Content-Type: application/json
          json:
            code: "test_auth_code_stepci"
            redirect_uri: "http://localhost:8079/"
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/AuthTokenResponse"
        captures:
          access_token:
            jsonpath: $.access_token
          refresh_token:
            jsonpath: $.refresh_token
            json:
              access_token: >-
                eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyQGV4YW1wbGUuY29tIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDI2MjJ9.example_jwt_signature
              refresh_token: 8xLOxBtZp8_example_refresh_token
              token_type: Bearer
              expires_in: 3600
      - id: refreshToken
        name: Refresh JWT token
        http:
          url: /auth/refresh
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            refresh_token: velit Excepteur in cillum
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/AuthTokenResponse"
            json:
              access_token: >-
                eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyQGV4YW1wbGUuY29tIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDI2MjJ9.new_jwt_signature
              refresh_token: 9yMPyCtZq9_new_refresh_token
              token_type: Bearer
              expires_in: 3600
      - id: getCurrentUser
        name: Get current user information
        http:
          url: /auth/me
          method: GET
          headers:
            Authorization: "Bearer {{ access_token }}"
          check:
            status: 200
            schema:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                  description: Unique identifier for the user (UUID)
                  maxLength: 36
                email:
                  type: string
                  format: email
                  description: User email address
                name:
                  type: string
                  description: User display name
                providers:
                  type: array
                  items:
                    type: object
                    properties:
                      provider:
                        type: string
                        description: OAuth provider name
                      is_primary:
                        type: boolean
                        description: Whether this is the primary authentication method
                  description: Linked OAuth providers
              required:
                - id
                - email
                - name
            json:
              id: 550e8400-e29b-41d4-a716-446655440000
              email: user@example.com
              name: John Doe
              providers:
                - provider: google
                  is_primary: true
      - id: handleOAuthCallback
        name: Handle OAuth callback
        http:
          url: /auth/callback
          method: GET
          params:
            code: Duis officia cillum
            state: eu ea pariatur aliquip
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/AuthTokenResponse"
      - id: logoutUser
        name: Logout user
        http:
          url: /auth/logout
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            enim244: true
          check:
            status: 204
      - id: getCollaborationSessions
        name: List active collaboration sessions
        http:
          url: /collaboration/sessions
          method: GET
          check:
            status: 200
            schema:
              type: array
              items:
                $ref: "#/components/schemas/CollaborationSession"
            json:
              - diagram_id: 123e4567-e89b-12d3-a456-426614174000
                participants:
                  - user_id: alice@example.com
                  - user_id: bob@example.com
      - id: listThreatModels
        name: List threat models
        http:
          url: /threat_models
          method: GET
          params:
            limit: 20
            offset: 21842404
            sort: created_at:desc
            owner: sint est dolor
            name: veniam Ut
            description: Excepteur
            issue_url: sint laborum officia
            created_after: "1936-02-17T17:20:22.0Z"
            created_before: "1942-06-08T08:43:34.0Z"
            modified_after: "1957-08-12T01:45:55.0Z"
            modified_before: "1951-12-10T11:46:53.0Z"
          check:
            status: 200
            schema:
              allOf:
                - $ref: "#/components/schemas/PaginatedResponse"
                - properties:
                    data:
                      type: array
                      items:
                        $ref: "#/components/schemas/TMListItem"
            json:
              data:
                - id: 550e8400-e29b-41d4-a716-446655440000
                  name: System Threat Model
                  description: Comprehensive threat model for our web application system
                  created_at: "2025-04-06T12:00:00Z"
                  modified_at: "2025-04-06T14:30:00Z"
                  owner: user@example.com
                  created_by: admin@example.com
                  threat_model_framework: STRIDE
                  issue_url: https://github.com/example/issues/123
                  document_count: 3
                  source_count: 2
                  diagram_count: 1
                  threat_count: 15
              pagination:
                total: 1
                limit: 20
                offset: 0
                has_more: false
      - id: createThreatModel
        name: Create a threat model
        http:
          url: /threat_models
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            name: est mollit ipsum laboris
            description: dolor aute ut ea
            threat_model_framework: consequat nulla cillum tempor do
            issue_url: https://C.zhbWSnkQGzdfMJggpt86XW3HeY,ucdmiZ+faEIZFdoK4,LOO3z2ZYRX
            authorization:
              - subject: "ZAk:"
                role: owner
              - subject: 48-n! 8vXG
                role: writer
              - subject: o-I.UE\H
                role: owner
            metadata:
              - key: "5"
                value: pP'!
              - key: s2C
                value: DTNUQG
              - key: lRRUAXVZ
                value: nW=do
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/ThreatModel"
            json:
              id: 550e8400-e29b-41d4-a716-446655440000
              name: System Threat Model
              description: Threats for system X
              created_at: "2025-04-06T12:00:00Z"
              modified_at: "2025-04-06T12:00:00Z"
              owner: user@example.com
              created_by: user@example.com
              threat_model_framework: STRIDE
              authorization:
                - subject: user@example.com
                  role: owner
              metadata: []
              documents: []
              sourceCode: []
              diagrams: []
              threats: []
      - id: getThreatModel
        name: Retrieve a threat model
        http:
          url: /threat_models/a833e402-93b9-b55d-5b2e-5d8306422fc8
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/ThreatModel"
      - id: updateThreatModel
        name: Update a threat model
        http:
          url: /threat_models/9710b5b3-9a5e-068a-a4a7-d377faee30bb
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            name: et enim
            description: exercitation
            threat_model_framework: exercitation
            issue_url: >-
              http://usadnWYlGyEquOVhKPPsczlmWLb.viouR0JeEMDJCIZkrUVv.5RxtQ3G,bytuGEgywCgPZ7a91Av4RC6lZLVoOYXhr7jmSDQP
            authorization:
              - subject: (1^lZcei
                role: owner
              - subject: CV(
                role: reader
              - subject: \{A
                role: writer
              - subject: m0
                role: owner
              - subject: \uBAD-Gs
                role: writer
            metadata:
              - key: EBLLXpQ
                value: "&Ng"
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/ThreatModel"
      - id: patchThreatModel
        name: Partially update a threat model
        http:
          url: /threat_models/b4a31277-4c78-3b64-f3fa-8b195f46458f
          method: PATCH
          headers:
            Content-Type: application/json-patch+json
          body:
            file:
              - op: copy
                path: est irure sed
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/ThreatModel"
      - id: deleteThreatModel
        name: Delete a threat model
        http:
          url: /threat_models/7925b294-7ac6-81ca-bcaa-18770e21f02a
          method: DELETE
          check:
            status: 204
      - id: getThreatModelThreats
        name: List threats in a threat model
        http:
          url: /threat_models/bdbd22b2-95c8-65c4-51f1-901c6f8ced89/threats
          method: GET
          params:
            limit: 20
            offset: 18144095
          check:
            status: 200
            schema:
              type: object
              properties:
                threats:
                  type: array
                  items:
                    $ref: "#/components/schemas/Threat"
                total_count:
                  type: integer
                  description: Total number of threats in the threat model
              required:
                - threats
                - total_count
            json:
              threats:
                - id: 550e8400-e29b-41d4-a716-446655440003
                  name: SQL Injection Vulnerability
                  description: Database injection through malicious SQL queries
                  severity: High
                  priority: urgent
                  status: active
                  mitigated: false
                  threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                  created_at: "2025-01-15T10:30:00Z"
                  modified_at: "2025-01-15T14:45:00Z"
                  metadata:
                    - key: category
                      value: data_validation
                    - key: owasp_top_10
                      value: A03
                    - key: assigned_to
                      value: security-team
                - id: 550e8400-e29b-41d4-a716-446655440004
                  name: Cross-Site Scripting (XSS)
                  description: Client-side script injection vulnerability
                  severity: Medium
                  priority: medium
                  status: identified
                  mitigated: false
                  threat_model_id: 550e8400-e29b-41d4-a716-446655440000
                  created_at: "2025-01-15T11:00:00Z"
                  modified_at: "2025-01-15T11:00:00Z"
                  metadata:
                    - key: category
                      value: input_validation
                    - key: owasp_top_10
                      value: A07
              total_count: 12
      - id: createThreatModelThreat
        name: Create a new threat
        http:
          url: /threat_models/33e0ae77-c099-8d50-b3bd-fc961f565be4/threats
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            name: cupidatat et ipsum
            mitigation: amet do nostrud dolor
            diagram_id: 629a6209-12bf-8b10-f80f-86a673558cba
            cell_id: fa36c7d1-e85e-71e3-0dca-742823dd7f55
            severity: Medium
            score: 9.232893108896878
            priority: dolo
            mitigated: true
            status: in in amet ex qui
            threat_type: nisi velit
            metadata:
              - key: Vgxb8EEt
                value: _-XJ&4qT9#
              - key: ./d:8W.
                value: lR;JU_1J\
              - key: t8QVEK
                value: .t7Sp:FUk3
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/Threat"
      - id: getThreatModelThreat
        name: Get a specific threat
        http:
          url: >-
            /threat_models/d4f659e8-595b-6197-3319-581945467a25/threats/4cc0c7aa-f347-55b1-9289-7114d3cb1441
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Threat"
      - id: updateThreatModelThreat
        name: Update a threat
        http:
          url: >-
            /threat_models/309ff3cf-8c82-8709-76dd-a5ff28e179af/threats/2446458b-bc56-0d38-4cdc-7a96e3626fa5
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            name: non irure
            description: quis esse Excepteur
            mitigation: deserunt adipisicing amet ipsum Duis
            diagram_id: 95cc4990-d759-3ec3-8734-aeb6c529c2a4
            cell_id: e77bd580-350e-9734-3610-e1698d0145f0
            severity: None
            score: 6.259383677437801
            priority: amet
            mitigated: false
            status: laboris fugiat commodo in anim
            threat_type: non cupidatat
            issue_url: >-
              https://vwdYuVrIJKECSAgBNonlApVkehXfVdXiz.ptkBkBtdFvkHEonXieua60D1zr1eJDeOF0ZEfCkindI+3q1uVgG+zPBOP6sw9IubeRsEop
            metadata:
              - key: 4TEh4D.tOHE
                value: oGB!xxGx
              - key: S
                value: sc9GN-B"b&
              - key: 5qn1CK
                value: D
              - key: rRdDI
                value: 9m?Jn
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Threat"
      - id: patchThreatModelThreat
        name: Partially update a threat
        http:
          url: >-
            /threat_models/a1fccac4-864d-2d86-f965-565ac21f848a/threats/4a9ba4ab-e642-638b-6755-5895d50d97f2
          method: PATCH
          headers:
            Content-Type: application/json-patch+json
          body:
            file:
              - op: replace
                path: /name
                value: Updated SQL Injection Threat
              - op: replace
                path: /severity
                value: Critical
              - op: replace
                path: /description
                value: Updated description with more details
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Threat"
            json:
              id: 550e8400-e29b-41d4-a716-446655440003
              name: Updated SQL Injection Threat
              description: Updated description with more details
              severity: Critical
              priority: urgent
              status: active
              mitigated: false
              threat_model_id: 550e8400-e29b-41d4-a716-446655440000
              created_at: "2025-01-15T10:30:00Z"
              modified_at: "2025-01-15T14:45:00Z"
              metadata:
                - key: priority
                  value: urgent
                - key: assigned_to
                  value: security-team
                - key: cve_reference
                  value: CVE-2024-1234
      - id: deleteThreatModelThreat
        name: Delete a threat
        http:
          url: >-
            /threat_models/c7a46ed9-8f99-81aa-4572-1019f74f94d4/threats/379af4eb-45b4-e76a-07c4-4732f330188e
          method: DELETE
          check:
            status: 204
      - id: getThreatMetadata
        name: Get threat metadata
        http:
          url: >-
            /threat_models/c40bcf62-5730-9489-2381-99426d6c5b72/threats/e7d57720-cc7c-dba4-95e7-7759ef557b96/metadata
          method: GET
          check:
            status: 200
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
      - id: createThreatMetadata
        name: Create threat metadata
        http:
          url: >-
            /threat_models/ba480c16-14e2-6414-7aa6-b5fa13244312/threats/f29a264c-06f5-e928-bbfc-24b4d035a7fb/metadata
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            key: "y"
            value: Tv
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: getThreatMetadataByKey
        name: Get threat metadata by key
        http:
          url: >-
            /threat_models/4b298594-785b-4474-96a3-d68a4ae76c1f/threats/f566dacb-9184-3d68-03fa-80630542d7a7/metadata/adipisicing
            officia
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: updateThreatMetadataByKey
        name: Update threat metadata by key
        http:
          url: >-
            /threat_models/ff2b080d-9a4c-66df-5aab-dd5264db87e5/threats/99f72b11-9a0a-2cad-8e70-120530194049/metadata/pariatur
            incididunt Duis ex
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            value: ex
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: deleteThreatMetadataByKey
        name: Delete threat metadata by key
        http:
          url: >-
            /threat_models/f8be277a-3068-7a83-2baa-58a7ef0563ee/threats/683c48a1-1078-553b-84ea-fa8b28b29e27/metadata/in
            aliquip
          method: DELETE
          check:
            status: 204
      - id: bulkCreateThreatMetadata
        name: Bulk create threat metadata
        http:
          url: >-
            /threat_models/5b0a1321-22dc-889d-0f62-6130556e00eb/threats/60d57336-9483-a9ea-96c4-889cc0d5c895/metadata/bulk
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            - key: 8AS
              value: OCMU%.+V7
            - key: D.
              value: "|{(+lHEz+"
            - key: CnLEgZZkQ4t
              value: fP?#k]o=i
            - key: "wYw.K7P:"
              value: ","
            - key: Jc8/vc
              value: zM.LqdD4Z8
            - key: q9l
              value: YgZ2q5
            - key: ffR7I9oxT
              value: "-:&gZs\\no"
            - key: 01hkQRH
              value: ",zuaXd`"
          check:
            status: 201
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
      - id: bulkCreateThreatModelThreats
        name: Bulk create threats
        http:
          url: /threat_models/a42b0d1e-2e55-d1b5-7aab-b78e0dc77a38/threats/bulk
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            - name: SQL Injection Attack
              description: Attacker injects malicious SQL code through user input
              impact: High
              likelihood: Medium
              risk_rating: High
              metadata:
                - key: category
                  value: injection
                - key: stride
                  value: tampering
            - name: Cross-Site Scripting (XSS)
              description: Malicious scripts executed in user's browser
              impact: Medium
              likelihood: High
              risk_rating: High
              metadata:
                - key: category
                  value: xss
                - key: stride
                  value: tampering
          check:
            status: 201
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Threat"
      - id: bulkUpdateThreatModelThreats
        name: Bulk update threats
        http:
          url: /threat_models/9e0f3a25-4346-2af6-9725-1a6db31dabf7/threats/bulk
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            - id: 750e8400-e29b-41d4-a716-446655440001
              name: Updated SQL Injection Attack
              description: Updated description for SQL injection vulnerability
              impact: High
              likelihood: Low
              risk_rating: Medium
              metadata:
                - key: category
                  value: injection
                - key: mitigation
                  value: parameterized-queries
          check:
            status: 200
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Threat"
      - id: batchPatchThreatModelThreats
        name: Batch patch threats
        http:
          url: >-
            /threat_models/484f8080-d334-b381-cec0-b926d35859c9/threats/batch/patch
          method: POST
          headers:
            Content-Type: application/json-patch+json
          body:
            file:
              patches:
                - threat_id: 750e8400-e29b-41d4-a716-446655440001
                  operations:
                    - op: replace
                      path: /risk_rating
                      value: Medium
                    - op: replace
                      path: /likelihood
                      value: Low
                - threat_id: 750e8400-e29b-41d4-a716-446655440002
                  operations:
                    - op: add
                      path: /metadata/-
                      value:
                        key: reviewed
                        value: "true"
          check:
            status: 200
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Threat"
      - id: batchDeleteThreatModelThreats
        name: Batch delete threats
        http:
          url: /threat_models/d918df16-b8ff-c43b-b9c9-3b36986c06ee/threats/batch
          method: DELETE
          params:
            threat_ids:
              - ffb9b358-a7ee-7fcc-7c2f-fbdb53fcb7fd
          check:
            status: 200
            schema:
              type: object
              properties:
                deleted_count:
                  type: integer
                  description: Number of threats successfully deleted
                deleted_ids:
                  type: array
                  items:
                    type: string
                    format: uuid
                  description: Array of successfully deleted threat IDs
              required:
                - deleted_count
                - deleted_ids
      - id: getThreatModelDocuments
        name: List documents in a threat model
        http:
          url: /threat_models/72cacd64-41bb-ef24-b498-5a3d70f87f31/documents
          method: GET
          params:
            limit: 20
            offset: 41545810
          check:
            status: 200
            schema:
              type: object
              properties:
                documents:
                  type: array
                  items:
                    $ref: "#/components/schemas/Document"
                total_count:
                  type: integer
                  description: Total number of documents in the threat model
              required:
                - documents
                - total_count
            json:
              documents:
                - id: 550e8400-e29b-41d4-a716-446655440001
                  name: Security Requirements Document
                  url: https://docs.company.com/security-requirements.pdf
                  description: Detailed security requirements and compliance standards
                  metadata:
                    - key: classification
                      value: internal
                    - key: version
                      value: "1.2"
                - id: 550e8400-e29b-41d4-a716-446655440002
                  name: Architecture Design Document
                  url: https://docs.company.com/architecture-design.pdf
                  description: System architecture and design specifications
                  metadata:
                    - key: classification
                      value: internal
                    - key: version
                      value: "2.0"
              total_count: 5
      - id: createThreatModelDocument
        name: Create a new document
        http:
          url: /threat_models/f6fc13a2-2018-59b2-4c29-baae862e3ccc/documents
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            name: Security Requirements Document
            url: https://docs.company.com/security-requirements.pdf
            description: Detailed security requirements and compliance standards
            metadata:
              - key: classification
                value: internal
              - key: version
                value: "1.0"
              - key: owner
                value: security-team
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/Document"
            json:
              id: 550e8400-e29b-41d4-a716-446655440001
              name: Security Requirements Document
              url: https://docs.company.com/security-requirements.pdf
              description: Detailed security requirements and compliance standards
              metadata:
                - key: classification
                  value: internal
                - key: version
                  value: "1.0"
                - key: owner
                  value: security-team
      - id: getThreatModelDocument
        name: Get a specific document
        http:
          url: >-
            /threat_models/e9fb9c07-4534-d252-de41-ece0f1728759/documents/c2458f59-7ef3-e85c-ae53-27dfae118dbf
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Document"
      - id: updateThreatModelDocument
        name: Update a document
        http:
          url: >-
            /threat_models/4f1aff76-5fae-2575-b4d8-59e44021d2aa/documents/dbbe4793-3207-06d8-a911-6be2103ac5b9
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            id: 8614dc8a-ed6c-9480-e215-ad740ae2ac75
            name: YLl^nV8:l.
            url: >-
              http://nWpumSLxQESbdLNzMhKBANEwTWVwH.fhOe9Ez+rPMWYqNHMtmH+NrFrZ9yiCyHNlNT,heH3KZRRqfHlo
            description: Ut Excepteur est
            metadata:
              - key: Fj.Cm0ne
                value: "'q* Pvf;"
              - key: J
                value: "{ena"
              - key: h32Z
                value: "]\"OyH?OX%?"
              - key: rcL8jV
                value: 5Yc\./
              - key: Yno
                value: O
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Document"
      - id: deleteThreatModelDocument
        name: Delete a document
        http:
          url: >-
            /threat_models/06c523fb-7a9b-f420-9c36-25fc88e73244/documents/9859bb12-576a-7620-ad37-75b809420212
          method: DELETE
          check:
            status: 204
      - id: getDocumentMetadata
        name: Get document metadata
        http:
          url: >-
            /threat_models/42336678-ab62-acdb-cd42-ad91f0233e21/documents/523be012-ab21-43e7-6eea-3bd48c6bb3f5/metadata
          method: GET
          check:
            status: 200
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
      - id: createDocumentMetadata
        name: Create document metadata
        http:
          url: >-
            /threat_models/ae7444fb-c9c4-6084-718e-09d12426d876/documents/e4a2f66c-7375-1e1f-0398-0933a26b2199/metadata
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            key: QW.dOB
            value: 5\sQN('
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: getDocumentMetadataByKey
        name: Get document metadata by key
        http:
          url: >-
            /threat_models/7f05d301-7e68-ed95-df1c-ebc12c943773/documents/98216edc-c861-ab79-a850-1a7b2d37fa98/metadata/proident
            officia nisi in labore
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: updateDocumentMetadataByKey
        name: Update document metadata by key
        http:
          url: >-
            /threat_models/06488711-638b-f177-5d02-1dcea0a27f07/documents/eae4228b-7021-2bfc-ee8d-062e43c94b0f/metadata/minim
            velit dolore
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            value: consectetur Excepteur
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: deleteDocumentMetadataByKey
        name: Delete document metadata by key
        http:
          url: >-
            /threat_models/20790a16-9864-9269-eebe-85e3cc7cc2c2/documents/dd065c23-e4a6-9be0-4d2a-f359116a627d/metadata/exercitation
          method: DELETE
          check:
            status: 204
      - id: bulkCreateDocumentMetadata
        name: Bulk create document metadata
        http:
          url: >-
            /threat_models/f4a326e7-4d50-ad76-7d5b-8a352ef20fb2/documents/2cf9b903-d07d-379a-e3ec-b525c02ef92c/metadata/bulk
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            - key: 95lzI5L
              value: tT#qH%
            - key: rCffdHUU2
              value: "`rQHcEE"
            - key: od30
              value: "`Jy07_~"
            - key: gVKgQq:m
              value: $W;jVd
            - key: u
              value: ZeyKy,_\X}
            - key: L
              value: E
            - key: "gD7:"
              value: "[g\"\""
            - key: aOJPHpVtyy5
              value: Ck|8i4
            - key: w6t54fW-pg
              value: JbNML
            - key: "3"
              value: NMNQ
            - key: Nh1al
              value: ;C1
            - key: Z
              value: NZG$
            - key: 1gP.P
              value: Zz
            - key: k_HH3WUTpH
              value: "&~YnWx"
            - key: PdHJH
              value: "*KaZF{tLFJ"
            - key: GX2
              value: v3ZN^y`o
            - key: DwSL
              value: a
          check:
            status: 201
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
      - id: bulkCreateThreatModelDocuments
        name: Bulk create documents
        http:
          url: /threat_models/67c24a2d-a1c3-852e-056c-68eae669cd2e/documents/bulk
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            - name: Architecture Document
              url: https://docs.company.com/architecture.pdf
              description: System architecture documentation
              metadata:
                - key: type
                  value: architecture
                - key: version
                  value: "2.1"
            - name: Security Requirements
              url: https://docs.company.com/security.pdf
              description: Security requirements and compliance standards
              metadata:
                - key: classification
                  value: internal
                - key: department
                  value: security
          check:
            status: 201
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Document"
            json:
              - id: 550e8400-e29b-41d4-a716-446655440001
                name: Architecture Document
                url: https://docs.company.com/architecture.pdf
                description: System architecture documentation
                metadata:
                  - key: type
                    value: architecture
                  - key: version
                    value: "2.1"
                created_at: "2025-04-06T12:00:00Z"
                modified_at: "2025-04-06T12:00:00Z"
              - id: 550e8400-e29b-41d4-a716-446655440002
                name: Security Requirements
                url: https://docs.company.com/security.pdf
                description: Security requirements and compliance standards
                metadata:
                  - key: classification
                    value: internal
                  - key: department
                    value: security
                created_at: "2025-04-06T12:00:00Z"
                modified_at: "2025-04-06T12:00:00Z"
      - id: getThreatModelSources
        name: List sources in a threat model
        http:
          url: /threat_models/964c4c99-63cb-85a2-c783-157869616f4c/sources
          method: GET
          params:
            limit: 20
            offset: 44224500
          check:
            status: 200
            schema:
              type: object
              properties:
                sources:
                  type: array
                  items:
                    $ref: "#/components/schemas/Source"
                total_count:
                  type: integer
                  description: Total number of sources in the threat model
              required:
                - sources
                - total_count
            json:
              sources:
                - id: 550e8400-e29b-41d4-a716-446655440010
                  name: Authentication Service
                  url: https://github.com/company/auth-service
                  type: git
                  description: Core authentication and authorization service
                  parameters:
                    refType: branch
                    refValue: main
                  metadata:
                    - key: language
                      value: go
                    - key: coverage
                      value: 85%
                    - key: security_scan
                      value: passed
                - id: 550e8400-e29b-41d4-a716-446655440011
                  name: Database Layer
                  url: https://github.com/company/db-layer
                  type: git
                  description: Database access layer and ORM implementation
                  parameters:
                    refType: tag
                    refValue: v1.2.3
                  metadata:
                    - key: language
                      value: go
                    - key: database
                      value: postgresql
              total_count: 3
      - id: createThreatModelSource
        name: Create a new source reference
        http:
          url: /threat_models/e8a6127e-49b0-fef6-dc95-b183437da537/sources
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            description: cillum
            type: mercurial
            url: >-
              https://bymJbUfHovbGheCoPbkeTzqYpGPzQDDjM.mxdflUKysFqP-c8KXNtlTCaLbakRKtUTEhtTA0v9QMSQYSyV5l4PdiMTkElhXvYFPTWyiITQi0VgBtuHZQbZG-
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/Source"
      - id: getThreatModelSource
        name: Get a specific source reference
        http:
          url: >-
            /threat_models/41820dbe-b2fd-eb89-281d-09ae3409ae37/sources/c3599c96-7db1-d67f-5152-bb2ae9755f15
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Source"
      - id: updateThreatModelSource
        name: Update a source reference
        http:
          url: >-
            /threat_models/28b4d95e-122c-3773-f255-77b094090dfd/sources/75e9b975-0828-7f3d-6c09-eeb3cc996cef
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            id: 92facbc5-026b-614a-1796-61e1f4a15ab5
            type: svn
            url: >-
              https://LeelvML.qvIXrIC,kXczRpwljdRWEtlYY11kBcbtXmjjVeblRAiH0Ufbbkpu1xmeDDi4Jnb
            metadata:
              - key: UGnzP8
                value: +`Yrmb%N
              - key: gO8v/RT:Pr
                value: T{d:N
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Source"
      - id: deleteThreatModelSource
        name: Delete a source reference
        http:
          url: >-
            /threat_models/0906795b-a246-5a03-e145-dd7a496def28/sources/cd84ae50-44dc-580c-095e-062f1f4cbb2d
          method: DELETE
          check:
            status: 204
      - id: getSourceMetadata
        name: Get source metadata
        http:
          url: >-
            /threat_models/1826bab5-7866-a02b-a944-e95bd3db1013/sources/ab7eeebb-ba48-e43f-a605-881054cbcfa8/metadata
          method: GET
          check:
            status: 200
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
      - id: createSourceMetadata
        name: Create source metadata
        http:
          url: >-
            /threat_models/f78303a3-067e-c734-e8d9-7e853ed50d96/sources/ae8bd8a4-cd32-238d-022a-d44eee4f3460/metadata
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            key: QgJ
            value: (
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: getSourceMetadataByKey
        name: Get source metadata by key
        http:
          url: >-
            /threat_models/4e63755a-ec67-c8d2-0d12-431d2f4dcdcc/sources/a82256e1-8b51-905f-617c-500d2cf0fa93/metadata/eiusmod
            consectetur dolore
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: updateSourceMetadataByKey
        name: Update source metadata by key
        http:
          url: >-
            /threat_models/4b47f9dd-b393-86be-431b-631f7feffa7d/sources/f8d2510f-0a70-1c90-4877-3d5064450e8f/metadata/Lorem
            quis amet
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            value: ullamco
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: deleteSourceMetadataByKey
        name: Delete source metadata by key
        http:
          url: >-
            /threat_models/7508c67a-4b62-a37f-496e-7f838d536924/sources/2dd81f54-5495-0007-ea52-d33334b3c0e3/metadata/do
          method: DELETE
          check:
            status: 204
      - id: bulkCreateSourceMetadata
        name: Bulk create source metadata
        http:
          url: >-
            /threat_models/896040c1-03df-c76f-9506-4bdeefed32a0/sources/e21b47d1-50b6-4af5-a673-99d1df158eca/metadata/bulk
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            - key: "5"
              value: x_Hx
            - key: 34bsh9Sqr7
              value: "[(QGp_h"
            - key: ePexSrO
              value: E ?-C;&X
            - key: ":ezHrfJtO"
              value: xRQ
          check:
            status: 201
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
      - id: bulkCreateThreatModelSources
        name: Bulk create sources
        http:
          url: /threat_models/30a2eeae-559f-adb5-33cd-60cc424c92c3/sources/bulk
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            - name: User Authentication Module
              url: https://github.com/company/repo/blob/main/auth/user.go
              description: Core user authentication logic
              metadata:
                - key: language
                  value: go
                - key: maintainer
                  value: security-team
            - name: Database Connection Pool
              url: https://github.com/company/repo/blob/main/db/pool.go
              description: Database connection management
              metadata:
                - key: type
                  value: infrastructure
                - key: criticality
                  value: high
          check:
            status: 201
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Source"
            json:
              - id: 650e8400-e29b-41d4-a716-446655440001
                name: User Authentication Module
                url: https://github.com/company/repo/blob/main/auth/user.go
                description: Core user authentication logic
                metadata:
                  - key: language
                    value: go
                  - key: maintainer
                    value: security-team
                created_at: "2025-04-06T12:00:00Z"
                modified_at: "2025-04-06T12:00:00Z"
              - id: 650e8400-e29b-41d4-a716-446655440002
                name: Database Connection Pool
                url: https://github.com/company/repo/blob/main/db/pool.go
                description: Database connection management
                metadata:
                  - key: type
                    value: infrastructure
                  - key: criticality
                    value: high
                created_at: "2025-04-06T12:00:00Z"
                modified_at: "2025-04-06T12:00:00Z"
      - id: getThreatModelMetadata
        name: Get threat model metadata
        http:
          url: /threat_models/f0819b50-4f9e-7c0a-d743-4b1e9e02819d/metadata
          method: GET
          check:
            status: 200
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
      - id: createThreatModelMetadata
        name: Create threat model metadata
        http:
          url: /threat_models/3e6d8489-3fbd-cffc-3112-254e219f5d74/metadata
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            key: ":_"
            value: FOT
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: getThreatModelMetadataByKey
        name: Get threat model metadata by key
        http:
          url: >-
            /threat_models/e226a9c2-4da3-9018-210f-1998e12926f3/metadata/laboris
            eiusmod
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: updateThreatModelMetadataByKey
        name: Update threat model metadata by key
        http:
          url: /threat_models/42ba6ed4-51fb-b1ee-1c1b-f81e45664d9e/metadata/velit
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            value: in commodo dolore ut sit
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: deleteThreatModelMetadataByKey
        name: Delete threat model metadata by key
        http:
          url: >-
            /threat_models/481741d5-0fd6-b453-f2ad-5c4431cc55fa/metadata/ut
            magna dolore laborum
          method: DELETE
          check:
            status: 204
      - id: bulkCreateThreatModelMetadata
        name: Bulk create threat model metadata
        http:
          url: /threat_models/bd87710d-d15f-0ba7-c28f-f400057d966a/metadata/bulk
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            - key: THo46
              value: )A,Z;H^
            - key: Zmd5
              value: T x]\f(2F
            - key: a
              value: "{o"
            - key: "i8kkLeVpmT:"
              value: "4"
            - key: CSG
              value: 0}Yt?IXPi
            - key: "2"
              value: mFve@u/|mp
            - key: "30"
              value: e3sb=E(T
            - key: NETyCc
              value: P
            - key: ":31OMGkCG"
              value: +P
            - key: bty47j
              value: $$oH
          check:
            status: 201
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
      - id: getThreatModelDiagrams
        name: List threat model diagrams
        http:
          url: /threat_models/5bc068ca-81d7-9116-bea8-4eab70e5a274/diagrams
          method: GET
          params:
            limit: 20
            offset: 98536334
          check:
            status: 200
            schema:
              type: array
              items:
                $ref: "#/components/schemas/DiagramListItem"
            json:
              - id: 123e4567-e89b-12d3-a456-426614174000
                name: System Architecture Diagram
                type: DFD-1.0.0
              - id: 456e7890-e89b-12d3-a456-426614174001
                name: Data Flow Diagram
                type: DFD-1.0.0
      - id: createThreatModelDiagram
        name: Create a new diagram
        http:
          url: /threat_models/c8660a64-85c3-d1ca-d0cf-3f13b9a9dac3/diagrams
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            name: cillum dolore Lorem id exercitation
            type: DFD-1.0.0
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/Diagram"
      - id: getThreatModelDiagram
        name: Get a specific diagram
        http:
          url: >-
            /threat_models/35ba6a19-abc7-5020-5b39-baec5d087017/diagrams/3e5da35d-e882-868c-b607-da9af755dc8e
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Diagram"
      - id: updateThreatModelDiagram
        name: Update a diagram
        http:
          url: >-
            /threat_models/05a93327-00b7-653e-2857-c4c66d894463/diagrams/26791a35-c0b3-8db9-e698-1af1a9ef09f5
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            id: de1c87e9-dc40-02df-ddc6-d4a6dd3fd08d
            name: sed Lorem
            type: DFD-1.0.0
            created_at: "1947-07-29T01:42:07.0Z"
            modified_at: "1961-04-14T01:40:44.0Z"
            cells:
              - id: 8b464789-9a8d-eb96-1c8f-acf8d8719bad
                shape: store
                zIndex: 80868464.9564884
                x: 41286489.69477311
                "y": -39461702.98141656
                width: 75226104.91142087
                height: 43360070.13036372
                ports:
                  groups:
                    pariatur_7:
                      enim_6_: tempor aliqua magna
                      position: right
                    deserunt_c9:
                      laborec5: ullamco aliquip dolor
                      dolorf3f: reprehenderit nulla voluptate
                      cupidatat_00: true
                      proidentd: amet ea laboris
                      position: bottom
                  items:
                    - id: aliqua quis
                      group: do irure velit esse aliqua
                    - id: id
                      group: eiusmod dolore do aute
                    - id: mollit enim
                      group: est dolore
              - id: f3e74cc4-79ff-1b40-d57d-3db2583bcf41
                shape: edge
                markup:
                  - tagName: Duis velit id
                    selector: ut
                    children:
                      - tagName: elit ea Duis nisi
                        selector: ipsum irure et cupidatat laboris
                        attrs:
                          non096: -78360215.0584092
                          dolore67_: anim
                        children: []
                      - tagName: Duis sed
                        selector: et
                        attrs:
                          Ut843: -25260078.319196895
                          do_5: -1700686
                        children: []
                      - tagName: cillum commodo tempor
                        selector: dolor
                        attrs:
                          elit42: elit dolor ex ipsum
                      - tagName: proident voluptate eiusmod commodo esse
                        selector: Lorem est veniam elit
                        attrs:
                          et8f: 71287175
                          sit56: -71262341.77107729
                          officia_3ff: 8838723.324842349
                          dob: -49297505.9579527
                        children: []
                      - tagName: sit
                        children: []
                tools:
                  - name: amet ea incididunt sed deserunt
                source:
                  cell: 9bc5ae1d-e122-e435-67f7-6a90b3aea836
                  port: rep
                target:
                  cell: 6507bc2b-b3d2-37f7-cdad-fda33581dd6a
                  port: e
                attrs:
                  line:
                    occaecat_9: 1407246.2668007165
                    strokeDasharray: mollit in nulla quis
                labels:
                  - attrs:
                      commodo_2: true
                      sint69a: est elit
                      voluptate7b4: 50351052
                      qui_44: -9176953
                      occaecat9: -72158663
                      text:
                        id_0: mollit cupidatat
                        laborisa2: true
                        id_e3: 78961969.32701886
                        aute_72: 76648666
                        pariatur_7: exercitation fugiat esse
                        fugiat_84: cillum
                        Ut260: 42668493.25963026
                        qui939: -35427434.09696123
                        officia_8: false
                    position: 0.4099539221479037
                  - dolorb: sit aute ea aliqua
                    ea8_f: false
                    position: 0.8758759759792226
                  - dolor_8a5: -76223105.52508676
                    qui_df: false
                    attrs:
                      reprehenderitb0: true
                      reprehenderit_0: -92948756.28742975
                      ut_c1: -89756890
                      do95: -47506920
                      qui_a4_: -92695617.46602468
                      voluptate50: -31280223
                    position: 0.6485522759851636
                  - ea_8d: -10189514.508480042
                    deserunt57: 43877385
                    attrs:
                      aliqua_b: true
                      text:
                        nulla_def: -40975403.148432665
                        Excepteur_b: false
                        cillum_cd: non
                        laborea: 53142403.904278845
                        fontSize: 72237493.83627081
                    position: 0.12100987232882143
                router: er
                connector: normal
                label: et pariatur
                style:
                  Duis2: 50718287
                  officia7: 67398603.04340091
                  strokeWidth: 53499913.48154165
                  fontColor: occaeca
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Diagram"
      - id: patchThreatModelDiagram
        name: Partially update a diagram
        http:
          url: >-
            /threat_models/c9a025f0-08cc-267a-ce65-2a5bdb042fdf/diagrams/765322a9-251f-20a5-3897-696cc22fdcd3
          method: PATCH
          headers:
            Content-Type: application/json-patch+json
          body:
            file:
              - op: replace
                path: /name
                value: Updated Diagram Name
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Diagram"
      - id: deleteThreatModelDiagram
        name: Delete a diagram
        http:
          url: >-
            /threat_models/fad54746-6ec8-1829-828b-d61c3c574f8c/diagrams/baf13ca6-98ff-fcbd-94c2-bc8d8f589d89
          method: DELETE
          check:
            status: 204
      - id: getDiagramCollaborationSession
        name: Get diagram collaboration session
        http:
          url: >-
            /threat_models/4ab294ce-16a4-4293-1ae1-ff07e6cab4fe/diagrams/9bee19c1-3e81-05ff-47da-a526ee01c81b/collaborate
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/CollaborationSession"
      - id: createDiagramCollaborationSession
        name: Create diagram collaboration session
        http:
          url: >-
            /threat_models/fd3e0a0f-666c-b774-a5ac-acdbe1071e3e/diagrams/07165d7d-fde9-00ab-d317-c2fd2447f2c9/collaborate
          method: POST
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/CollaborationSession"
      - id: joinDiagramCollaborationSession
        name: Join diagram collaboration session
        http:
          url: >-
            /threat_models/8f303242-50e1-f896-be38-527f4d9a363e/diagrams/6cafc1af-878f-f168-549c-d0d3607903a3/collaborate
          method: PUT
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/CollaborationSession"
      - id: endDiagramCollaborationSession
        name: End diagram collaboration session
        http:
          url: >-
            /threat_models/e0460694-2d98-ee6c-151e-0a7884f5528d/diagrams/5871d3e2-b3e0-7760-7211-283f3aba3cbf/collaborate
          method: DELETE
          check:
            status: 204
      - id: getDiagramMetadata
        name: Get diagram metadata
        http:
          url: >-
            /threat_models/06112962-58ba-55f1-6192-d7a97c1e413e/diagrams/f1b09700-8d43-8255-6118-33ab709e5c36/metadata
          method: GET
          check:
            status: 200
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
      - id: createDiagramMetadata
        name: Create diagram metadata
        http:
          url: >-
            /threat_models/6733232f-6357-4076-cc26-147df8af29ef/diagrams/f1d3b732-709f-6d28-772b-8517c07efb9d/metadata
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            key: P4shH4Ccjs
            value: XYPYFW
          check:
            status: 201
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: getDiagramMetadataByKey
        name: Get diagram metadata by key
        http:
          url: >-
            /threat_models/8243db57-32ab-25d5-d665-4f3477eb7b7e/diagrams/10d419ee-7631-5b5d-971a-342b4a09b4eb/metadata/dolor
            et dolor veniam
          method: GET
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: updateDiagramMetadataByKey
        name: Update diagram metadata by key
        http:
          url: >-
            /threat_models/0a0760b1-dc4f-a04e-53e7-e042850e8b18/diagrams/0c70bbb4-aea3-e923-ce04-e92c7fbf7126/metadata/ut
            aliqua proident
          method: PUT
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            value: nisi eu in
          check:
            status: 200
            schema:
              $ref: "#/components/schemas/Metadata"
      - id: deleteDiagramMetadataByKey
        name: Delete diagram metadata by key
        http:
          url: >-
            /threat_models/61a91173-0c34-d78b-18f8-c85e8a8015c0/diagrams/7f678f0e-4514-d608-b7ff-2fb303afacb2/metadata/dolore
            cillum
          method: DELETE
          check:
            status: 204
      - id: bulkCreateDiagramMetadata
        name: Bulk create diagram metadata
        http:
          url: >-
            /threat_models/c4d9eb13-b5f8-6b3a-6dd7-fa67f470f1b1/diagrams/963812a4-34ee-b57d-072d-699aab9e5a41/metadata/bulk
          method: POST
          headers:
            Content-Type: application/json
            accept: application/json
          json:
            - key: dQXVJDCG4
              value: W~rm9
            - key: ALp
              value: 0u
            - key: C
              value: k
            - key: ncId_88nR
              value: bI3
            - key: H
              value: "#[SMdusF'"
            - key: g04C/
              value: eQ
            - key: Xb
              value: "`?z"
            - key: 83Wy:7i.g
              value: l[mKsns
            - key: XnDxroMzSUb
              value: KP6){?/
            - key: KHV
              value: +(ZG|tD/
            - key: EYEZrfa
              value: UQs7A*;$2)
            - key: K0
              value: y`o,7(U
          check:
            status: 201
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
components:
  schemas:
    ApiInfo:
      type: object
      description: API information response for the root endpoint
      properties:
        status:
          type: object
          properties:
            code:
              type: string
              enum:
                - OK
                - ERROR
              description: Status code indicating if the API is functioning correctly
            time:
              type: string
              format: date-time
              description: Current server time in UTC, formatted as RFC 3339
          required:
            - code
            - time
        service:
          type: object
          properties:
            name:
              type: string
              description: Name of the service
            build:
              type: string
              description: Current build number
              maxLength: 256
          required:
            - name
            - build
        api:
          type: object
          properties:
            version:
              type: string
              description: API version
            specification:
              type: string
              format: uri
              description: URL to the API specification
              maxLength: 1024
          required:
            - version
            - specification
        operator:
          type: object
          properties:
            name:
              type: string
              description: Operator name from environment variables
              maxLength: 256
            contact:
              type: string
              description: Operator contact information from environment variables
              maxLength: 1024
          required:
            - name
            - contact
      required:
        - status
        - service
        - api
        - operator
      example:
        status:
          code: OK
          time: "2025-04-09T12:00:00Z"
        service:
          name: TMI
          build: 1.0.0-386eea0
        api:
          version: "1.0"
          specification: https://github.com/ericfitz/tmi/blob/main/tmi-openapi.json
        operator:
          name: Example Organization
          contact: api-support@example.com
    Document:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the document (UUID)
          maxLength: 36
          readOnly: true
        name:
          type: string
          description: Document name
          minLength: 1
          maxLength: 256
          pattern: ^[^<>"'&]*$
          x-oapi-codegen-extra-tags:
            binding: required
        url:
          type: string
          format: uri
          description: URL location of the document
          maxLength: 1024
          x-oapi-codegen-extra-tags:
            binding: required,url
        description:
          type: string
          description: Description of document purpose or content
          maxLength: 1024
          nullable: true
        metadata:
          type: array
          items:
            $ref: "#/components/schemas/Metadata"
          description: Key-value pairs for additional document metadata
          nullable: true
      required:
        - name
        - url
      example:
        id: 6ba7b810-9dad-11d1-beef-00c04fd430c8
        name: Example Application Design
        url: https://example.com/design.pdf
        description: Technical design document for the Example application
        metadata:
          - key: document_type
            value: technical_specification
          - key: version
            value: "1.2"
    Source:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the source code reference (UUID)
          maxLength: 36
          readOnly: true
        name:
          type: string
          description: Name for the source code reference
          maxLength: 256
        description:
          type: string
          description: Description of the referenced source code
          maxLength: 1024
          nullable: true
        type:
          type: string
          description: Source code repository type
          enum:
            - git
            - svn
            - mercurial
            - other
          maxLength: 16
        url:
          type: string
          format: uri
          description: URL to retrieve the referenced source code
          maxLength: 1024
        parameters:
          type: object
          description: repo-specific parameters for retrieving the source
          properties:
            refType:
              type: string
              enum:
                - branch
                - tag
                - commit
              description: Reference type (branch, tag, or commit)
              maxLength: 6
            refValue:
              type: string
              description: Reference value (branch name, tag value, or commit id)
              maxLength: 256
            subPath:
              type: string
              description: Sub-path within the repository
              maxLength: 256
          required:
            - refType
            - refValue
        metadata:
          type: array
          items:
            $ref: "#/components/schemas/Metadata"
          description: Key-value pairs for additional source metadata
          nullable: true
      required:
        - url
      example:
        id: 6ba7b810-1dad-11d1-8080-00c04fd430c8
        name: GitHub Repo
        description: Technical design document for the Example application
        type: git
        url: https://github.com/ericfitz/tmi-ux.git
        parameters:
          refType: branch
          refValue: main
        metadata: []
    BaseDiagram:
      type: object
      description: Base diagram object with common properties
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the diagram (UUID)
          maxLength: 36
          readOnly: true
        name:
          type: string
          description: Name of the diagram
          maxLength: 256
        type:
          type: string
          description: Type of diagram with version
          enum:
            - DFD-1.0.0
          maxLength: 64
        created_at:
          type: string
          format: date-time
          description: Creation timestamp (ISO3339)
          maxLength: 36
        modified_at:
          type: string
          format: date-time
          description: Last modification timestamp (ISO3339)
          maxLength: 36
        metadata:
          type: array
          items:
            $ref: "#/components/schemas/Metadata"
          description: Key-value pairs for additional diagram metadata
          nullable: true
      required:
        - id
        - name
        - type
        - created_at
        - modified_at
      discriminator:
        propertyName: type
        mapping:
          DFD-1.0.0: "#/components/schemas/DfdDiagram"
    DfdDiagram:
      allOf:
        - $ref: "#/components/schemas/BaseDiagram"
        - type: object
          description: Data Flow Diagram (DFD) with cells
          properties:
            type:
              type: string
              enum:
                - DFD-1.0.0
              description: DFD diagram type with version
            cells:
              type: array
              items:
                oneOf:
                  - $ref: "#/components/schemas/Node"
                  - $ref: "#/components/schemas/Edge"
              description: List of diagram cells (nodes and edges) following X6 structure
          required:
            - cells
    CreateDiagramRequest:
      type: object
      description: >-
        Request body for creating a new diagram - only includes client-provided
        fields
      properties:
        name:
          type: string
          description: Name of the diagram
          maxLength: 256
        type:
          type: string
          description: Type of diagram with version
          enum:
            - DFD-1.0.0
          maxLength: 64
      required:
        - name
        - type
      additionalProperties: false
    Diagram:
      oneOf:
        - $ref: "#/components/schemas/DfdDiagram"
      discriminator:
        propertyName: type
        mapping:
          DFD-1.0.0: "#/components/schemas/DfdDiagram"
      example:
        id: 359314D9-B6A3-460B-805F-B82190D7290F
        type: DFD-1.0.0
        name: Workflow Diagram
        description: A process workflow
        created_at: "2025-04-06T12:00:00Z"
        modified_at: "2025-04-06T12:30:00Z"
        metadata: []
        cells:
          - id: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
            shape: process
            x: 100
            "y": 100
            width: 120
            height: 60
            zIndex: 10
            visible: true
            attrs:
              body:
                fill: "#ffffff"
                stroke: "#000000"
                strokeWidth: 2
              text:
                text: Process Data
                fontSize: 14
                fill: "#000000"
            ports:
              groups:
                in:
                  position: left
                out:
                  position: right
              items:
                - id: port_in_1
                  group: in
                - id: port_out_1
                  group: out
            data: []
          - id: 456789AB-CD12-34EF-56GH-789012345678
            shape: edge
            source:
              cell: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
              port: port_out_1
            target:
              cell: 789ABC12-3456-78DE-F012-3456789ABCDE
            zIndex: 1
            visible: true
            attrs:
              line:
                stroke: "#808080"
                strokeWidth: 1
                targetMarker:
                  name: classic
                  size: 8
            labels:
              - attrs:
                  text:
                    text: Data Flow
                    fontSize: 12
                    fill: "#333333"
                position: 0.5
            vertices: []
            data: []
    Cell:
      type: object
      description: >-
        Base schema for all diagram cells (nodes and edges) fully compatible
        with AntV X6 graph library. This schema includes all X6 native
        properties plus convenience properties for easier integration.
        X6-specific properties like markup, tools, router, and connector are
        supported for advanced customization.
      discriminator:
        propertyName: shape
      required:
        - id
        - shape
      properties:
        id:
          type: string
          description: Unique identifier of the cell (UUID)
          format: uuid
          example: 37EAEDFA-BF37-4996-8665-242FEC34BBFF
          maxLength: 36
        shape:
          type: string
          description: Shape type identifier that determines cell structure and behavior
          example: process
        zIndex:
          type: number
          description: Z-order layer for rendering (higher values render on top)
          default: 1
          minimum: 0
        visible:
          type: boolean
          description: Whether the cell is visible in the diagram
          default: true
        data:
          type: object
          description: >-
            Flexible data storage compatible with X6, with reserved metadata
            namespace
          properties:
            _metadata:
              type: array
              items:
                $ref: "#/components/schemas/Metadata"
              description: Reserved namespace for structured business metadata
          additionalProperties: true
          default:
            _metadata: []
        markup:
          type: array
          items:
            $ref: "#/components/schemas/MarkupElement"
          description: SVG/HTML markup definition for custom shape rendering in X6
        tools:
          type: array
          items:
            $ref: "#/components/schemas/CellTool"
          description: Interactive tools attached to the cell for user interaction
    Node:
      allOf:
        - $ref: "#/components/schemas/Cell"
        - type: object
          description: >-
            A diagram node representing an entity, process, store, or boundary.
            Fully compatible with X6 Node objects and supports both X6 native
            properties (markup, tools) and convenience properties (label,
            position, size, style) for easier integration.
          required:
            - x
            - "y"
            - width
            - height
          properties:
            shape:
              type: string
              enum:
                - actor
                - process
                - store
                - security-boundary
                - text-box
              description: Node type determining its visual representation and behavior
            x:
              type: number
              description: X coordinate of the node's position
            "y":
              type: number
              description: Y coordinate of the node's position
            width:
              type: number
              description: Width of the node in pixels
              minimum: 40
            height:
              type: number
              description: Height of the node in pixels
              minimum: 30
            angle:
              type: number
              description: Rotation angle in degrees
              default: 0
            attrs:
              allOf:
                - $ref: "#/components/schemas/NodeAttrs"
              description: Visual styling attributes for the node
            ports:
              allOf:
                - $ref: "#/components/schemas/PortConfiguration"
              description: Port configuration for connections
            parent:
              type: string
              format: uuid
              description: ID of the parent cell for nested/grouped nodes (UUID)
              nullable: true
              maxLength: 36
            label:
              type: string
              description: >-
                Convenience property: Simple text label that automatically
                creates appropriate attrs.text.text structure
              maxLength: 256
            position:
              type: object
              description: >-
                Convenience property: Position as a single object (alternative
                to separate x/y properties)
              properties:
                x:
                  type: number
                  description: X coordinate
                "y":
                  type: number
                  description: Y coordinate
              required:
                - x
                - "y"
            size:
              type: object
              description: >-
                Convenience property: Size as a single object (alternative to
                separate width/height properties)
              properties:
                width:
                  type: number
                  description: Width in pixels
                  minimum: 40
                height:
                  type: number
                  description: Height in pixels
                  minimum: 30
              required:
                - width
                - height
            style:
              type: object
              description: >-
                Convenience property: Simplified styling options that
                automatically create appropriate attrs structure
              properties:
                fill:
                  type: string
                  description: Background fill color
                  maxLength: 32
                stroke:
                  type: string
                  description: Border/outline color
                  maxLength: 32
                strokeWidth:
                  type: number
                  description: Border/outline width in pixels
                  minimum: 0
                fontSize:
                  type: number
                  description: Text font size in pixels
                  minimum: 1
                fontColor:
                  type: string
                  description: Text color
                  maxLength: 32
          example:
            id: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
            shape: process
            x: 100
            "y": 100
            width: 120
            height: 60
            zIndex: 10
            visible: true
            attrs:
              body:
                fill: "#ffffff"
                stroke: "#000000"
                strokeWidth: 2
              text:
                text: Process Data
                fontSize: 14
                fill: "#000000"
            ports:
              groups:
                in:
                  position: left
                out:
                  position: right
              items:
                - id: port_in_1
                  group: in
                - id: port_out_1
                  group: out
            data:
              _metadata:
                - key: category
                  value: business-process
                - key: owner
                  value: engineering-team
              customValidation:
                rules:
                  - required-input
                  - sanitize-output
                level: strict
            markup:
              - tagName: rect
                selector: body
                attrs:
                  rx: 5
                  ry: 5
              - tagName: text
                selector: label
            tools:
              - name: boundary
                args:
                  padding: 5
    Edge:
      allOf:
        - $ref: "#/components/schemas/Cell"
        - type: object
          description: >-
            A diagram edge representing a connection or data flow between nodes.
            Fully compatible with X6 Edge objects and supports X6 routing
            algorithms (manhattan, orth, oneSide, metro, er), connector styles
            (normal, rounded, smooth, jumpover), custom markup, tools, and
            convenience properties (label, style) for easier integration.
          required:
            - source
            - target
          properties:
            shape:
              type: string
              enum:
                - edge
              description: Edge type identifier
            source:
              allOf:
                - $ref: "#/components/schemas/EdgeTerminal"
              description: Source connection point
            target:
              allOf:
                - $ref: "#/components/schemas/EdgeTerminal"
              description: Target connection point
            attrs:
              allOf:
                - $ref: "#/components/schemas/EdgeAttrs"
              description: Visual styling attributes for the edge
            labels:
              type: array
              items:
                $ref: "#/components/schemas/EdgeLabel"
              description: Text labels positioned along the edge
            vertices:
              type: array
              items:
                $ref: "#/components/schemas/Point"
              description: Intermediate waypoints for edge routing
            router:
              allOf:
                - $ref: "#/components/schemas/EdgeRouter"
              description: Edge routing algorithm configuration for path calculation
            connector:
              allOf:
                - $ref: "#/components/schemas/EdgeConnector"
              description: Edge connector style configuration for visual appearance
            defaultLabel:
              allOf:
                - $ref: "#/components/schemas/EdgeLabel"
              description: >-
                Default label configuration applied to edges without explicit
                labels
            label:
              type: string
              description: >-
                Convenience property: Simple text label that automatically
                creates appropriate attrs.text.text structure
              maxLength: 256
            style:
              type: object
              description: >-
                Convenience property: Simplified styling options that
                automatically create appropriate attrs structure
              properties:
                stroke:
                  type: string
                  description: Line color
                  maxLength: 32
                strokeWidth:
                  type: number
                  description: Line width in pixels
                  minimum: 0
                strokeDasharray:
                  type: string
                  description: Line dash pattern (e.g., '5 5' for dashed)
                  maxLength: 64
                fontSize:
                  type: number
                  description: Label font size in pixels
                  minimum: 1
                fontColor:
                  type: string
                  description: Label text color
                  maxLength: 32
          example:
            id: 456789AB-CD12-34EF-56GH-789012345678
            shape: edge
            source:
              cell: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
              port: port_out_1
            target:
              cell: 789ABC12-3456-78DE-F012-3456789ABCDE
            zIndex: 1
            visible: true
            attrs:
              line:
                stroke: "#808080"
                strokeWidth: 1
                targetMarker:
                  name: classic
                  size: 8
            labels:
              - attrs:
                  text:
                    text: Data Flow
                    fontSize: 12
                    fill: "#333333"
                position: 0.5
            vertices: []
            data:
              _metadata:
                - key: flow-type
                  value: data
                - key: sensitivity
                  value: public
              routingHints:
                preferredPath: shortest
                avoidOverlap: true
            router:
              name: manhattan
              args:
                step: 10
                padding: 20
            connector:
              name: rounded
              args:
                radius: 5
    ThreatModel:
      allOf:
        - $ref: "#/components/schemas/ThreatModelBase"
        - type: object
          description: Complete ThreatModel with server-generated fields
          properties:
            id:
              type: string
              format: uuid
              description: Unique identifier for the threat model (UUID)
              maxLength: 36
              readOnly: true
            created_at:
              type: string
              format: date-time
              description: Creation timestamp (RFC3339)
              maxLength: 24
              readOnly: true
            modified_at:
              type: string
              format: date-time
              description: Last modification timestamp (RFC3339)
              maxLength: 24
              readOnly: true
            created_by:
              type: string
              description: Username or identifier of the creator of the threat model
              maxLength: 256
              pattern: ^[^<>"'&]*$
              readOnly: true
            documents:
              type: array
              items:
                $ref: "#/components/schemas/Document"
              description: List of documents related to the threat model
              readOnly: true
            sourceCode:
              type: array
              items:
                $ref: "#/components/schemas/Source"
              description: List of source code repositories related to the threat model
              readOnly: true
            diagrams:
              type: array
              items:
                $ref: "#/components/schemas/Diagram"
              description: List of diagram objects associated with this threat model
              readOnly: true
            threats:
              type: array
              items:
                $ref: "#/components/schemas/Threat"
              description: List of threats within the threat model
              readOnly: true
      example:
        id: F898D276-DE86-4837-9B5E-C46E1A08EAB6
        name: System Threat Model
        description: Threats for system X
        created_at: "2025-04-06T12:00:00Z"
        modified_at: "2025-04-06T12:00:00Z"
        owner: user@example.com
        created_by: user@example.com
        threat_model_framework: STRIDE
        issue_url: https://issues.example.com/browse/TM-123
        authorization:
          - subject: user@example.com
            role: owner
        metadata: []
        documents:
          - id: 3ba7b810-9dad-11d1-beef-00c04fd430c8
            name: System Architecture Document
            url: https://docs.example.com/system-architecture.pdf
            description: Technical architecture documentation for the system
            metadata:
              - key: document_type
                value: architecture
              - key: version
                value: "2.1"
        sourceCode:
          - id: 6ba7b810-1dad-11d1-8080-00c04fd430c8
            name: GitHub Repo
            description: Source code for the tmi-ux application
            type: git
            url: https://github.com/ericfitz/tmi-ux.git
            parameters:
              refType: branch
              refValue: main
            metadata:
              - key: environment
                value: production
              - key: team
                value: security
        diagrams:
          - id: 22DB9004-435D-4765-9E41-0291AA8FE15A
            type: DFD-1.0.0
            name: System Overview Diagram
            description: Main system data flow diagram
            created_at: "2025-04-06T12:00:00Z"
            modified_at: "2025-04-06T12:30:00Z"
            metadata: []
            cells: []
        threats:
          - id: EC464A19-D1CA-4B72-AD8D-055AD2073C2B
            threat_model_id: B7946A3A-5581-42C6-91BF-F41A1E1DD535
            name: Data Breach
            description: Unauthorized data access
            mitigation: "Recommendation: implement least privilege authorization policy"
            created_at: "2025-04-06T12:01:00Z"
            modified_at: "2025-04-06T12:01:00Z"
            diagram_id: ""
            cell_id: ""
            severity: High
            score: 7.5
            priority: High
            mitigated: false
            status: Open
            threat_type: Information Disclosure
            issue_url: https://issues.example.com/browse/SEC-456
            metadata: []
    Threat:
      allOf:
        - $ref: "#/components/schemas/ThreatBase"
        - type: object
          description: Complete Threat with server-generated fields
          properties:
            id:
              type: string
              format: uuid
              description: Unique identifier for the threat (UUID)
              maxLength: 36
              readOnly: true
            threat_model_id:
              type: string
              format: uuid
              description: Unique identifier of the parent threat model (UUID)
              maxLength: 36
              readOnly: true
            created_at:
              type: string
              format: date-time
              description: Creation timestamp (RFC3339)
              maxLength: 24
              readOnly: true
            modified_at:
              type: string
              format: date-time
              description: Last modification timestamp (RFC3339)
              maxLength: 24
              readOnly: true
    Authorization:
      type: object
      description: A user-role pair defining access permissions
      properties:
        subject:
          type: string
          description: >-
            Username or identifier of the user (may be email address or other
            format)
          minLength: 1
          maxLength: 256
          pattern: ^[^<>"'&]*$
          x-oapi-codegen-extra-tags:
            binding: required
        role:
          type: string
          enum:
            - reader
            - writer
            - owner
          description: "Role: reader (view), writer (edit), owner (full control)"
          maxLength: 6
          x-oapi-codegen-extra-tags:
            binding: required
      required:
        - subject
        - role
    Metadata:
      type: object
      description: A key-value pair for extensible metadata
      properties:
        key:
          type: string
          description: Metadata key
          minLength: 1
          maxLength: 256
          pattern: ^[a-zA-Z0-9_./:-]+$
          x-oapi-codegen-extra-tags:
            binding: required
        value:
          type: string
          description: Metadata value
          minLength: 1
          maxLength: 1024
          pattern: ^[^<>]*$
          x-oapi-codegen-extra-tags:
            binding: required
      required:
        - key
        - value
    Error:
      type: object
      description: Standard error response format
      properties:
        error:
          type: string
          description: Error code
        error_description:
          type: string
          description: Human-readable error description
        error_uri:
          type: string
          format: uri
          description: URI to documentation about the error
      required:
        - error
        - error_description
      example:
        error: invalid_request
        error_description: The request is missing a required parameter
        error_uri: https://docs.example.com/auth/errors/invalid_request
    AuthTokenResponse:
      type: object
      description: JWT token response for authentication endpoints
      properties:
        access_token:
          type: string
          description: JWT access token
        refresh_token:
          type: string
          description: Refresh token for obtaining new access tokens
        token_type:
          type: string
          enum:
            - Bearer
          description: Token type
        expires_in:
          type: integer
          description: Access token expiration time in seconds
      required:
        - access_token
        - refresh_token
        - token_type
        - expires_in
      example:
        access_token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        refresh_token: def456...
        token_type: Bearer
        expires_in: 3600
    CollaborationSession:
      type: object
      description: Details of an active collaboration session for a diagram
      properties:
        session_id:
          type: string
          format: uuid
          description: Unique identifier for the session (UUID)
          maxLength: 36
          readOnly: true
        session_manager:
          type: string
          description: >-
            Username or identifier of the session manager (may be email address
            or other format)
          maxLength: 256
          readOnly: true
        threat_model_id:
          type: string
          format: uuid
          description: Unique identifier of the associated threat model (UUID)
          maxLength: 36
        threat_model_name:
          type: string
          description: Name of the associated threat model
          maxLength: 256
        diagram_id:
          type: string
          format: uuid
          description: Unique identifier of the associated diagram (UUID)
          maxLength: 36
        diagram_name:
          type: string
          description: Name of the associated diagram
          maxLength: 256
        participants:
          type: array
          items:
            type: object
            description: A participant in the session
            properties:
              user_id:
                type: string
                description: >-
                  Username or identifier of the participant (may be email
                  address or other format)
                maxLength: 256
              joined_at:
                type: string
                format: date-time
                description: Join timestamp
                maxLength: 36
              permissions:
                type: string
                enum:
                  - reader
                  - writer
                description: >-
                  User's permissions for the current diagram in the current
                  session (reader|writer)
                maxLength: 6
          description: List of active participants
        websocket_url:
          type: string
          description: WebSocket URL for real-time updates
          maxLength: 1024
      required:
        - session_id
        - session_manager
        - threat_model_id
        - threat_model_name
        - diagram_id
        - diagram_name
        - participants
        - websocket_url
      example:
        session_id: D7744D3A-ED22-40AF-862B-29786CAD0007
        session_manager: admin@example.com
        threat_model_id: 5311D207-AFD5-4A1A-BA83-14C1445DC257
        threat_model_name: E-commerce Platform Security Analysis
        diagram_id: DFF7F4A9-CBCE-4001-9198-2706C86F7EF3
        diagram_name: User Authentication Flow
        participants:
          - user_id: user@example.com
            joined_at: "2025-04-06T12:02:00Z"
            permissions: writer
        websocket_url: >-
          wss://api.example.com/threat_models/5311D207-AFD5-4A1A-BA83-14C1445DC257/diagrams/DFF7F4A9-CBCE-4001-9198-2706C86F7EF3/ws
    DiagramListItem:
      type: object
      description: >-
        A simplified diagram item for list endpoints, containing id, name, and
        type
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier of the diagram (UUID)
          maxLength: 36
          readOnly: true
        name:
          type: string
          description: Name of the diagram
          maxLength: 256
        type:
          type: string
          enum:
            - DFD-1.0.0
          description: Type of the diagram
      required:
        - id
        - name
        - type
    TMListItem:
      type: object
      description: >-
        Enhanced item for threat model list endpoints with key metadata and
        counts
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier of the threat model (UUID)
          maxLength: 36
          readOnly: true
        name:
          type: string
          description: Name of the threat model
          maxLength: 256
        description:
          type: string
          description: Description of the threat model
          maxLength: 1024
        created_at:
          type: string
          format: date-time
          description: Creation timestamp (RFC3339)
          maxLength: 24
        modified_at:
          type: string
          format: date-time
          description: Last modification timestamp (RFC3339)
          maxLength: 24
        owner:
          type: string
          description: Username or identifier of the current owner
        created_by:
          type: string
          description: Username or identifier of the creator
          maxLength: 256
        threat_model_framework:
          type: string
          description: The framework used for this threat model
        issue_url:
          type: string
          format: uri
          description: URL to an issue in an issue tracking system
          maxLength: 1024
        document_count:
          type: integer
          minimum: 0
          description: Number of documents associated with this threat model
        source_count:
          type: integer
          minimum: 0
          description: Number of source code entries associated with this threat model
        diagram_count:
          type: integer
          minimum: 0
          description: Number of diagrams associated with this threat model
        threat_count:
          type: integer
          minimum: 0
          description: Number of threats defined in this threat model
      required:
        - id
        - name
        - created_at
        - modified_at
        - owner
        - created_by
        - threat_model_framework
        - document_count
        - source_count
        - diagram_count
        - threat_count
    Point:
      type: object
      description: A 2D point with x and y coordinates
      required:
        - x
        - "y"
      properties:
        x:
          type: number
          description: X coordinate
        "y":
          type: number
          description: Y coordinate
      example:
        x: 100
        "y": 200
    EdgeTerminal:
      type: object
      description: Connection point for an edge (source or target)
      required:
        - cell
      properties:
        cell:
          type: string
          format: uuid
          description: ID of the connected node (UUID)
          maxLength: 36
        port:
          type: string
          description: ID of the specific port on the node (optional)
          nullable: true
          maxLength: 64
      example:
        cell: 233598D2-8C6D-4A73-AFE1-647081C4F7AA
        port: port_out_1
    NodeAttrs:
      type: object
      description: Visual attributes for a node
      properties:
        body:
          type: object
          description: Body/shape styling attributes
          properties:
            fill:
              type: string
              description: Fill color
              maxLength: 32
            stroke:
              type: string
              description: Stroke color
              maxLength: 32
            strokeWidth:
              type: number
              description: Stroke width in pixels
              minimum: 0
            strokeDasharray:
              type: string
              description: Dash pattern for strokes
              nullable: true
              maxLength: 64
        text:
          type: object
          description: Text/label styling attributes
          properties:
            text:
              type: string
              description: Label text content
              maxLength: 256
            fontSize:
              type: number
              description: Font size in pixels
              minimum: 1
            fill:
              type: string
              description: Text color
              maxLength: 32
            fontFamily:
              type: string
              description: Font family
              maxLength: 64
    EdgeAttrs:
      type: object
      description: Visual attributes for an edge
      properties:
        line:
          type: object
          description: Line styling attributes
          properties:
            stroke:
              type: string
              description: Line color
              maxLength: 32
            strokeWidth:
              type: number
              description: Line width in pixels
              minimum: 0
            strokeDasharray:
              type: string
              description: Dash pattern for the line
              nullable: true
              maxLength: 64
            targetMarker:
              type: object
              description: Arrowhead marker configuration
              properties:
                name:
                  type: string
                  description: Marker type
                  enum:
                    - classic
                    - block
                    - diamond
                    - circle
                  maxLength: 32
                size:
                  type: number
                  description: Marker size in pixels
                  minimum: 1
            sourceMarker:
              type: object
              description: Source marker configuration
              properties:
                name:
                  type: string
                  description: Marker type
                  enum:
                    - classic
                    - block
                    - diamond
                    - circle
                  maxLength: 32
                size:
                  type: number
                  description: Marker size in pixels
                  minimum: 1
    EdgeLabel:
      type: object
      description: Label positioned along an edge
      properties:
        attrs:
          type: object
          description: Label styling attributes
          properties:
            text:
              type: object
              description: Text styling
              properties:
                text:
                  type: string
                  description: Label text content
                  maxLength: 256
                fontSize:
                  type: number
                  description: Font size in pixels
                  minimum: 1
                fill:
                  type: string
                  description: Text color
                  maxLength: 32
                fontFamily:
                  type: string
                  description: Font family
                  maxLength: 64
        position:
          type: number
          description: Position along the edge (0 = start, 1 = end)
          minimum: 0
          maximum: 1
      example:
        attrs:
          text:
            text: Data Flow
            fontSize: 12
            fill: "#333333"
        position: 0.5
    PortConfiguration:
      type: object
      description: Port configuration for node connections
      properties:
        groups:
          type: object
          description: Port group definitions
          additionalProperties:
            type: object
            properties:
              position:
                type: string
                enum:
                  - top
                  - right
                  - bottom
                  - left
                description: Port position on the node
        items:
          type: array
          description: Individual port instances
          items:
            type: object
            required:
              - id
              - group
            properties:
              id:
                type: string
                description: Unique port identifier
                maxLength: 64
              group:
                type: string
                description: Port group this port belongs to
                maxLength: 32
    PaginatedResponse:
      type: object
      description: Paginated response wrapper for list endpoints
      properties:
        data:
          type: array
          items:
            type: object
          description: Array of items for the current page
        pagination:
          type: object
          description: Pagination metadata
          properties:
            total:
              type: integer
              description: Total number of items across all pages
              minimum: 0
            limit:
              type: integer
              description: Maximum number of items per page
              minimum: 1
            offset:
              type: integer
              description: Number of items skipped from the beginning
              minimum: 0
            has_more:
              type: boolean
              description: Whether there are more items available beyond this page
          required:
            - total
            - limit
            - offset
            - has_more
      required:
        - data
        - pagination
    MarkupElement:
      type: object
      description: SVG/HTML markup element for custom shape definitions in X6
      required:
        - tagName
      properties:
        tagName:
          type: string
          description: SVG or HTML tag name (e.g., 'rect', 'circle', 'path', 'text')
          example: rect
        selector:
          type: string
          description: CSS selector for targeting this element in styling
          example: body
        attrs:
          type: object
          description: Element attributes and styling properties
          additionalProperties: true
          example:
            fill: "#ffffff"
            stroke: "#000000"
            stroke-width: 2
        children:
          type: array
          items:
            $ref: "#/components/schemas/MarkupElement"
          description: Nested child elements
    CellTool:
      type: object
      description: Interactive tool configuration for X6 cells
      required:
        - name
      properties:
        name:
          type: string
          description: Tool identifier (e.g., 'boundary', 'button', 'remove')
          example: button
        args:
          type: object
          description: Tool-specific configuration arguments
          additionalProperties: true
          example:
            x: 10
            "y": 10
            markup: <circle r='5' fill='red'/>
    EdgeRouter:
      oneOf:
        - type: string
          enum:
            - normal
            - orth
            - oneSide
            - manhattan
            - metro
            - er
          description: Built-in router name
        - type: object
          description: Router with custom configuration
          required:
            - name
          properties:
            name:
              type: string
              enum:
                - normal
                - orth
                - oneSide
                - manhattan
                - metro
                - er
              description: Router algorithm name
            args:
              type: object
              description: Router-specific arguments
              additionalProperties: true
              properties:
                padding:
                  type: number
                  description: Padding around obstacles for routing
                step:
                  type: number
                  description: Grid step size for orthogonal routing
                directions:
                  type: array
                  items:
                    type: string
                    enum:
                      - top
                      - right
                      - bottom
                      - left
                  description: Allowed routing directions
      description: Edge routing algorithm configuration for pathfinding
      example:
        name: manhattan
        args:
          step: 10
          padding: 20
    EdgeConnector:
      oneOf:
        - type: string
          enum:
            - normal
            - rounded
            - smooth
            - jumpover
          description: Built-in connector name
        - type: object
          description: Connector with custom configuration
          required:
            - name
          properties:
            name:
              type: string
              enum:
                - normal
                - rounded
                - smooth
                - jumpover
              description: Connector style name
            args:
              type: object
              description: Connector-specific arguments
              additionalProperties: true
              properties:
                radius:
                  type: number
                  description: Radius for rounded connectors
                precision:
                  type: number
                  description: Precision for smooth connectors
                size:
                  type: number
                  description: Jump size for jumpover connectors
                jump:
                  type: string
                  enum:
                    - arc
                    - gap
                    - cubic
                  description: Jump style for jumpover connectors
      description: Edge connector style configuration for visual appearance
      example:
        name: rounded
        args:
          radius: 10
    ThreatModelBase:
      type: object
      description: Base schema for ThreatModel with client-writable fields
      properties:
        name:
          type: string
          description: Name of the threat model
          minLength: 1
          maxLength: 256
          pattern: ^[^<>"'&]*$
          x-oapi-codegen-extra-tags:
            binding: required
        description:
          type: string
          description: Description of the threat model
          maxLength: 1024
          pattern: ^[^<>]*$
        owner:
          type: string
          description: >-
            Username or identifier of the current owner (may be email address or
            other format)
          maxLength: 256
          pattern: ^[^<>"'&]*$
        threat_model_framework:
          type: string
          description: The framework used for this threat model
        issue_url:
          type: string
          format: uri
          description: URL to an issue in an issue tracking system for this threat model
          maxLength: 1024
        authorization:
          type: array
          items:
            $ref: "#/components/schemas/Authorization"
          description: List of users and their roles for this threat model
        metadata:
          type: array
          items:
            $ref: "#/components/schemas/Metadata"
          description: Key-value pairs for additional threat model metadata
          nullable: true
      required:
        - name
        - owner
        - authorization
        - threat_model_framework
    ThreatModelInput:
      type: object
      description: Input schema for creating/updating ThreatModel
      properties:
        name:
          type: string
          description: Name of the threat model
          maxLength: 256
        description:
          type: string
          description: Description of the threat model and its purpose
          maxLength: 1024
          nullable: true
        threat_model_framework:
          type: string
          description: The framework used for this threat model
        issue_url:
          type: string
          format: uri
          description: URL to an issue in an issue tracking system for this threat model
          maxLength: 1024
          nullable: true
        authorization:
          type: array
          items:
            $ref: "#/components/schemas/Authorization"
          description: List of users and their roles for this threat model
        metadata:
          type: array
          items:
            $ref: "#/components/schemas/Metadata"
          description: Key-value pairs for additional threat model metadata
          nullable: true
      required:
        - name
    ThreatBase:
      type: object
      description: Base schema for Threat with client-writable fields
      properties:
        name:
          type: string
          description: Name of the threat
          maxLength: 256
        description:
          type: string
          description: Description of the threat and risk to the organization
          maxLength: 1024
        mitigation:
          type: string
          description: Recommended or planned mitigation(s) for the threat
          maxLength: 1024
        diagram_id:
          type: string
          format: uuid
          description: Unique identifier of the associated diagram (if applicable) (UUID)
          nullable: true
          maxLength: 36
        cell_id:
          type: string
          format: uuid
          description: Unique identifier of the associated cell (if applicable) (UUID)
          nullable: true
          maxLength: 36
        severity:
          type: string
          enum:
            - Unknown
            - None
            - Low
            - Medium
            - High
            - Critical
          description: Severity level of the threat
        score:
          type: number
          description: Numeric score representing the risk or impact of the threat
          minimum: 0
          maximum: 10
        priority:
          type: string
          description: Priority level for addressing the threat
          maxLength: 16
        mitigated:
          type: boolean
          description: Whether the threat has been mitigated
        status:
          type: string
          description: Current status of the threat
          maxLength: 256
        threat_type:
          type: string
          description: Type or category of the threat
          maxLength: 256
        issue_url:
          type: string
          format: uri
          description: URL to an issue in an issue tracking system for this threat
          maxLength: 1024
        metadata:
          type: array
          items:
            $ref: "#/components/schemas/Metadata"
          description: Key-value pairs for additional threat metadata
          nullable: true
      required:
        - name
        - severity
        - priority
        - mitigated
        - status
        - threat_type
    ThreatInput:
      allOf:
        - $ref: "#/components/schemas/ThreatBase"
      description: Input schema for creating/updating Threat
